
eongApplication=function(width,height,appletName,id,eongobj,debug){jQuery.noConflict();var devLoad=false;if(debug===undefined||!debug){relPath=getRelativePath();jQuery.ajax({url:relPath+"jquery/jquery-ui.min.js",async:false,dataType:"script"});jQuery.ajax({url:relPath+"jquery/ui.menu.js",async:false,dataType:"script"});jQuery.ajax({url:relPath+"jquery/jquery.layout.min.js",async:false,dataType:"script"});jQuery.ajax({url:relPath+"jquery/eong-plugins.js",async:false,dataType:"script"});if(devLoad){jQuery.ajax({url:relPath+"Helper.js",async:false,dataType:"script"});jQuery.ajax({url:relPath+"Action.js",async:false,dataType:"script"});jQuery.ajax({url:relPath+"Logger.js",async:false,dataType:"script"});jQuery.ajax({url:relPath+"Toolbar.js",async:false,dataType:"script"});jQuery.ajax({url:relPath+"DOMElements.js",async:false,dataType:"script"});jQuery.ajax({url:relPath+"CustomJSActions.js",async:false,dataType:"script"});jQuery.ajax({url:relPath+"ActionMap.js",async:false,dataType:"script"});jQuery.ajax({url:relPath+"DialogMap.js",async:false,dataType:"script"});}}
this.Helper=new eongApplication.Helper(width,height,appletName,id,eongobj,this);this.Helper.getOSInfo();this.Logger=new eongApplication.Logger(this.Helper);this.DOMElements=new eongApplication.DOMElements(this.Helper,this.Logger);this.CustomJSActions=new eongApplication.customJSActions(this.Helper,this.Logger);this.ActionMap=new eongApplication.actionMap();this.DialogMap=new eongApplication.dialogMap();this.methodQueue=[];this.Logger.log("eongApplication instance initialized","INFO",this);this.loadEditor=function(){this.Logger.log("[loadEditor]: Started","FINER",this);this.Logger.log("[loadEditor]: Getting OS info","FINEST",this);this.Helper.getOSInfo();if(this.isMSIE){this.Helper.setParam("REPLACEIMAGESIZE","30000");}else{this.Helper.setParam("REPLACEIMAGESIZE","500000");}
this.Logger.log("[loadEditor]: setting locale object in Helper","FINEST",this);this.Helper.setLocaleObject();this.Logger.log("[loadEditor]: setting locale object as PARAM","FINEST",this);json=jQuery.toJSON(this.Helper.LocaleObject);json=json.replace(/\r/g,'');json=json.replace(/\n/g,'');json=json.replace(/\t/g,'');json=this.Helper.escapeSingleQuotes(json);this.Helper.setParam("LOCALE",json);this.Logger.log("[loadEditor]: setting action map","FINEST",this);this.Helper.setActionMap();this.Helper.setDialogMap();this.Logger.log("[loadEditor]: setting archive","FINEST",this);this.Helper.setParam('archive',this.Helper.archive);this.Helper.setParam("progressbar","true");this.Helper.setParam("boxmessage","");this.Logger.log("[loadEditor]: assembling DOM","FINEST",this);var tmpWidth=String(this.Helper.editorWidth);if(tmpWidth.indexOf("%")!=-1){this.Helper.editorWidth=tmpWidth.replace(/%/g,"");var widthProportion=parseInt(this.Helper.editorWidth)/100;var parentWidth=jQuery("#"+this.Helper.containerId).parent().width();this.Helper.editorWidth=parseInt(parentWidth*widthProportion);this.Helper.containerWidth=parseInt(parentWidth*widthProportion);}
var tmpHeight=String(this.Helper.editorHeight);if(tmpHeight.indexOf("%")!=-1){this.Helper.editorHeight=tmpHeight.replace(/%/g,"");var heightProportion=parseInt(this.Helper.editorHeight)/100;var parentHeight=jQuery("#"+this.Helper.containerId).parent().height();this.Helper.editorHeight=parseInt(parentHeight*heightProportion);this.Helper.containerHeight=parseInt(parentHeight*heightProportion);}
this.DOMElements.assembleDOM();this.Logger.log("[loadEditor]: Finished","FINER",this);};this.preloadJVM=function(){this.Helper.code="com.realobjects.preloadJvm";this.Helper.archive="preload.jar";this.Helper.setParam('archive',this.Helper.archive);this.DOMElements.assembleDOMPreload();};this.addArchive=function(sArc,sVer){this.Logger.log("[addArchive]: Started","FINER",this);this.Logger.log("[addArchive]: Adding archive: "+sArc,"CONFIG",this);try{this.Helper.archive=this.Helper.archive+", "+sArc;}catch(err){this.Logger.log("[addArchive]: Failed to add archive","SEVERE",this);}
this.Logger.log("[addArchive]: Finished","FINER",this);};this.addEmbeddedStyles=function(styles){this.Logger.log("[addEmbeddedStyles]: Started","FINER",this);this.Logger.log("[addEmbeddedStyles]: Adding embedded styles: "+styles,"FINEST",this);try{if(this.Helper.initialized){this.getObj().addEmbeddedStyles(styles);}else{this.delayMethodCall("addEmbeddedStyles",arguments);}}catch(err){this.Logger.log("[addEmbeddedStyles]: Failed to add embedded styles: "+styles+" with error: "+err,"SEVERE",this);}
this.Logger.log("[addEmbeddedStyles]: Finished","FINER",this);};this.addUserAgentStyles=function(){this.Logger.log("[addUserAgentStyles]: Started","FINER",this);try{json={};json.content=arguments[0];if(arguments.length==3){json.media=arguments[1];json.title=arguments[2];}
this.Logger.log("[addUserAgentStyles]: Adding user agent styles: "+json,"FINE",this);json=jQuery.toJSON(json);if(this.Helper.initialized){this.getObj().addUserAgentStyles(json);}else{this.delayMethodCall("addUserAgentStyles",arguments);}}catch(err){this.Logger.log("[addUserAgentStyles]: Failed adding user agent styles: "+json+" with error: "+err,"SEVERE",this);}
this.Logger.log("[addUserAgentStyles]: Finished","FINER",this);};this.addUserAgentStylesFromURL=function(){this.Logger.log("[addUserAgentStylesFromURL]: Started","FINER",this);try{json={};json.href=arguments[0];if(arguments.length==3){json.media=arguments[1];json.title=arguments[2];}
this.Logger.log("[addUserAgentStylesFromURL]: Adding user agent styles: "+json,"FINE",this);json=jQuery.toJSON(json);if(this.Helper.initialized){this.getObj().addUserAgentStyles(json);}else{this.delayMethodCall("addUserAgentStylesFromURL",arguments);}}catch(err){this.Logger.log("[addUserAgentStylesFromURL]: Failed adding user agent styles: "+json+" with error: "+err,"SEVERE",this);}
this.Logger.log("[addUserAgentStylesFromURL]: Finished","FINER",this);};this.addUserStyles=function(){this.Logger.log("[addUserStyles]: Started","FINER",this);try{json={};json.content=arguments[0];if(arguments.length==3){json.media=arguments[1];json.title=arguments[2];}
this.Logger.log("[addUserStyles]: Adding user styles: "+json,"FINE",this);json=jQuery.toJSON(json);if(this.Helper.initialized){this.getObj().addUserStyles(json);}else{this.delayMethodCall("addUserStyles",arguments);}}catch(err){this.Logger.log("[addUserStyles]: Failed adding user styles: "+json+" with error: "+err,"SEVERE",this);}
this.Logger.log("[addUserStyles]: Finished","FINER",this);};this.addUserStylesFromURL=function(){this.Logger.log("[addUserStylesFromURL]: Started","FINER",this);try{json={};json.href=arguments[0];if(arguments.length==3){json.media=arguments[1];json.title=arguments[2];}
this.Logger.log("[addUserStylesFromURL]: Adding user styles: "+json,"FINE",this);json=jQuery.toJSON(json);if(this.Helper.initialized){this.getObj().addUserStyles(json);}else{this.delayMethodCall("addUserStylesFromURL",arguments);}}catch(err){this.Logger.log("[addUserStylesFromURL]: Failed adding user styles: "+json+" with error: "+err,"SEVERE",this);}
this.Logger.log("[addUserStylesFromURL]: Finished","FINER",this);};this.clear=function(){this.Logger.log("[clear]: Started","FINER",this);this.invokeAction("new-document",null);this.Logger.log("[clear]: Started","FINER",this);};this.clearUserPreferences=function(){this.Logger.log("[clearUserPreferences]: Started","FINER",this);try{if(this.Helper.initialized){this.Helper.clearUserPreferences();}else{this.delayMethodCall("clearUserPreferences",arguments);}}catch(err){this.Logger.log("[clearUserPreferences]: Failed to clear user preferences with "+err,"SEVERE",this);}
this.Logger.log("[clearUserPreferences]: Finished","FINER",this);};this.clearUserAgentStyles=function(){this.Logger.log("[clearUserAgentStyles]: Started","FINER",this);try{if(this.Helper.initialized){this.getObj().clearUserAgentStyles();}else{this.delayMethodCall("clearUserAgentStyles",arguments);}}catch(err){this.Logger.log("[clearUserAgentStyles]: Failed to clear user agent styles with "+err,"SEVERE",this);}
this.Logger.log("[clearUserAgentStyles]: Finished","FINER",this);};this.clearUserStyles=function(){this.Logger.log("[clearUserStyles]: Started","FINER",this);try{if(this.Helper.initialized){this.getObj().clearUserStyles();}else{this.delayMethodCall("clearUserStyles",arguments);}}catch(err){this.Logger.log("[clearUserStyles]: Failed to clear user styles with "+err,"SEVERE",this);}
this.Logger.log("[clearUserStyles]: Finished","FINER",this);};this.insertContent=function(content){this.Logger.log("[insertContent]: Started","FINER",this);this.Logger.log("[insertContent]: Inserting content: "+content,"FINE",this);try{if(this.Helper.initialized){this.getObj().insertContent(content);}else{this.delayMethodCall("insertContent",arguments);}}catch(err){this.Logger.log("[insertContent]: Failed to insert content: "+content+" with error: "+err,"SEVERE",this);}
this.Logger.log("[insertContent]: Finished","FINER",this);};this.insertImage=function(source,width,heigth,border,alt){this.Logger.log("[insertImage]: Started","FINER",this);this.Logger.log("[insertImage]: Inserting image: "+source+", "+width+", "+height+", "+border+", "+alt,"FINE",this);try{if(this.Helper.initialized){this.getObj().insertImage(source,width,heigth,border,alt);}else{this.delayMethodCall("insertImage",arguments);}}catch(err){this.Logger.log("[insertImage]: Failed to insert image: "+width+", "+height+", "+border+", "+alt+" with error: "+err,"SEVERE",this);}
this.Logger.log("[insertImage]: Finished","FINER",this);};this.insertContentFromURL=function(url){this.Logger.log("[insertContentFromURL]: Started","FINER",this);this.Logger.log("[insertContentFromURL]: Inserting URL: "+url,"FINE",this);try{if(this.Helper.initialized){this.getObj().insertContentFromURL(url);}else{this.delayMethodCall("insertContentFromURL",arguments);}}catch(err){this.Logger.log("[insertContentFromURL]: Failed to insert URL: "+url+" with error: "+err,"SEVERE",this);}
this.Logger.log("[insertContentFromURL]: Finished","FINER",this);};this.invokeAction=function(actionConst,actionCommand){this.Logger.log("[invokeAction]: Started","FINER",this);try{this.Logger.log("[invokeAction]: invokeAction ("+actionConst+", "+actionCommand+")","FINE",this);if(this.Helper.initialized){this.getObj().invokeAction(actionConst,actionCommand);}else{this.delayMethodCall("invokeAction",arguments);}}catch(err){this.Logger.log("[invokeAction]: Failed to execute invokeAction ("+actionConst+", "+actionCommand+") with error: "+err,"SEVERE",this);}
this.Logger.log("[invokeAction]: Finished","FINER",this);};this.loadDocument=function(content,sBaseURL){this.Logger.log("[loadDocument]: Started","FINER",this);this.Logger.log("[loadDocument]: Setting document to: "+content,"FINE",this);try{if(this.Helper.initialized){if(sBaseURL===undefined){this.getObj().loadDocument(content);}else{if(sBaseURL==="")sBaseURL=null;this.getObj().loadDocument(content,sBaseURL);}}else{this.delayMethodCall("loadDocument",arguments);}}catch(err){this.Logger.log("[loadDocument]: Failed to set document to: "+content+" with error: "+err,"SEVERE",this);}
this.Logger.log("[loadDocument]: Finished","FINER",this);};this.loadDocumentFromURL=function(sURL,sBaseURL){this.Logger.log("[loadDocumentFromURL]: Started","FINER",this);try{this.Logger.log("[loadDocumentFromURL]: Loading document from URL:"+sURL,"FINE",this);if(this.Helper.initialized){if(sBaseURL===undefined){this.getObj().loadDocumentFromURL(sURL);}else{if(sBaseURL==="")sBaseURL=null;this.getObj().loadDocumentFromURL(sURL,sBaseURL);}}else{this.Helper.setParam("LOADURL",sURL);if(sBaseURL!=undefined){this.Helper.setParam("LOADURLBASEURL",sBaseURL);}}}
catch(err){this.Logger.log("[loadDocumentFromURL]: Failed to load URL: "+sURL+" with error: "+err,"SEVERE",this);}
this.Logger.log("[loadDocumentFromURL]: Finished","FINER",this);};this.loadContextMenuStyleSheet=function(path){this.Logger.log("[loadContextMenuStyleSheet]: Started","FINER",this);this.Helper.setParam("CONTEXTMENUSTYLESHEET",path);this.Logger.log("[loadContextMenuStyleSheet]: Finished","FINER",this);};this.loadCrossReferencesStyleSheet=function(path){this.Logger.log("[loadCrossReferencesStyleSheet]: Started","FINER",this);this.Helper.setParam("CROSSREFERENCESSTYLESHEET",path);this.Logger.log("[loadCrossReferencesStyleSheet]: Finished","FINER",this);};this.loadInplaceToolbarStyleSheet=function(path){this.Logger.log("[loadInplaceToolbarStyleSheet]: Started","FINER",this);this.Helper.setParam("INPLACETOOLBARSTYLESHEET",path);this.Logger.log("[loadInplaceToolbarStyleSheet]: Finished","FINER",this);};this.loadInplaceToolbarIcons=function(path){this.Logger.log("[loadInplaceToolbarIcon]: Started","FINER",this);this.Helper.setParam("INPLACETOOLBARICON",path);this.Logger.log("[loadInplaceToolbarIcon]: Finished","FINER",this);};this.moveToBookmark=function(bookmarkName){this.Logger.log("[moveToBookmark]: Started","FINER",this);try{if(this.Helper.initialized){this.getObj().moveToBookmark(bookmarkName);}else{this.delayMethodCall("moveToBookmark",arguments);}}catch(err){this.Logger.log("[moveToBookmark]: Failed to select bookmark with error: "+err,"SEVERE",this);}
this.Logger.log("[moveToBookmark]: Finished","FINER",this);};this.moveToNextBookmark=function(){this.Logger.log("[moveToNextBookmark]: Started","FINER",this);try{if(this.Helper.initialized){this.getObj().moveToNextBookmark();}else{this.delayMethodCall("moveToNextBookmark",arguments);}}catch(err){this.Logger.log("[moveToNextBookmark]: Failed to select next bookmark with error: "+err,"SEVERE",this);}
this.Logger.log("[moveToNextBookmark]: Finished","FINER",this);};this.moveToPreviousBookmark=function(){this.Logger.log("[moveToPreviousBookmark]: Started","FINER",this);try{if(this.Helper.initialized){this.getObj().moveToPreviousBookmark();}else{this.delayMethodCall("moveToPreviousBookmark",arguments);}}catch(err){this.Logger.log("[moveToPreviousBookmark]: Failed to select previous bookmark with error: "+err,"SEVERE",this);}
this.Logger.log("[moveToPreviousBookmark]: Finished","FINER",this);};this.moveCaretToDocumentEnd=function(){this.Logger.log("[moveCaretToDocumentEnd]: Started","FINER",this);try{if(this.Helper.initialized){this.getObj().moveCaretToDocumentEnd();}else{this.delayMethodCall("moveCaretToDocumentEnd",arguments);}}catch(err){this.Logger.log("[moveCaretToDocumentEnd]: Failed to move caret to document end with error: "+err,"SEVERE",this);}
this.Logger.log("[moveCaretToDocumentEnd]: Finished","FINER",this);};this.moveCaretToDocumentStart=function(){this.Logger.log("[moveCaretToDocumentStart]: Started","FINER",this);try{if(this.Helper.initialized){this.getObj().moveCaretToDocumentStart();}else{this.delayMethodCall("moveCaretToDocumentStart",arguments);}}catch(err){this.Logger.log("[moveCaretToDocumentStart]: Failed to move caret to document start with error "+err,"SEVERE",this);}
this.Logger.log("[moveCaretToDocumentStart]: Finished","FINER",this);};this.moveCaretToNextBlock=function(){this.Logger.log("[moveCaretToNextBlock]: Started","FINER",this);try{if(this.Helper.initialized){this.getObj().moveCaretToNextBlock();}else{this.delayMethodCall("moveCaretToNextBlock",arguments);}}catch(err){this.Logger.log("[moveCaretToNextBlock]: Failed to move caret to next block with error: "+err,"SEVERE",this);}
this.Logger.log("[moveCaretToNextBlock]: Finished","FINER",this);};this.moveCaretToNextPage=function(){this.Logger.log("[moveCaretToNextPage]: Started","FINER",this);try{if(this.Helper.initialized){this.getObj().moveCaretToNextPage();}else{this.delayMethodCall("moveCaretToNextPage",arguments);}}catch(err){this.Logger.log("[moveCaretToNextPage]: Failed to move caret to next page with error "+err,"SEVERE",this);}
this.Logger.log("[moveCaretToNextPage]: Finished","FINER",this);};this.moveCaretToPreviousBlock=function(){this.Logger.log("[moveCaretToPreviousBlock]: Started","FINER",this);try{if(this.Helper.initialized){this.getObj().moveCaretToPreviousBlock();}else{this.delayMethodCall("moveCaretToPreviousBlock",arguments);}}catch(err){this.Logger.log("[moveCaretToPreviousBlock]: Failed to move caret to previous block with error "+err,"SEVERE",this);}
this.Logger.log("[moveCaretToPreviousBlock]: Finished","FINER",this);};this.moveCaretToPreviousPage=function(){this.Logger.log("[moveCaretToPreviousPage]: Started","FINER",this);try{if(this.Helper.initialized){this.getObj().moveCaretToPreviousPage();}else{this.delayMethodCall("moveCaretToPreviousPage",arguments);}}catch(err){this.Logger.log("[moveCaretToPreviousPage]: Failed to move caret to previous page with error "+err,"SEVERE",this);}
this.Logger.log("[moveCaretToPreviousPage]: Finished","FINER",this);};this.registerEventHandler=function(eventHandler,jsFunc){this.Logger.log("[registerEventHandler]: Started","FINER",this);this.Helper.setParam(eventHandler,jsFunc);this.Logger.log("[registerEventHandler]: Finished","FINER",this);}
this.removeCurrentTableColumnCellAttributes=function(){this.Logger.log("[removeCurrentTableColumnCellAttributes]: Started","FINER",this);try{if(this.Helper.initialized){this.getObj().removeCurrentTableColumnCellAttributes();}else{this.delayMethodCall("removeCurrentTableColumnCellAttributes",arguments);}}catch(err){this.Logger.log("[removeCurrentTableColumnCellAttributes]: Failed to remove cell attributes (table column) with error: "+err,"SEVERE",this);}
this.Logger.log("[removeCurrentTableColumnCellAttributes]: Finished","FINER",this);};this.removeCurrentTableRowCellAttributes=function(){this.Logger.log("[removeCurrentTableRowCellAttributes]: Started","FINER",this);try{if(this.Helper.initialized){this.getObj().removeCurrentTableRowCellAttributes();}else{this.delayMethodCall("removeCurrentTableRowCellAttributes",arguments);}}catch(err){this.Logger.log("[removeCurrentTableRowCellAttributes]: Failed to remove cell attributes (table row) with error: "+err,"SEVERE",this);}
this.Logger.log("[removeCurrentTableRowCellAttributes]: Finished","FINER",this);};this.removeParentElementByNameAttributes=function(ancestorName){this.Logger.log("[removeParentElementByNameAttributes]: Started","FINER",this);this.Logger.log("[removeParentElementByNameAttributes]: Remove attributes from: "+ancestorName,"FINE",this);try{if(this.Helper.initialized){this.getObj().removeParentElementByNameAttributes(ancestorName);}else{this.delayMethodCall("removeParentElementByNameAttributes",arguments);}}catch(err){this.Logger.log("[removeParentElementByNameAttributes]: Failed to remove attributes from: "+ancestorName+" with error: "+err,"SEVERE",this);}
this.Logger.log("[removeParentElementByNameAttributes]: Finished","FINER",this);};this.setArchive=function(archive){this.Helper.archive=archive;};this.setDefaultBaseURL=function(defaultBaseURL){this.Logger.log("[setDefaultBaseURL]: Started","FINER",this);if(!this.Helper.initialized){this.Logger.log("[setDefaultBaseURL]: Editor not initialized, setting defaultBaseURL as PARAM","CONFIG",this);this.Helper.setParam("DEFAULTBASEURL",defaultBaseURL);}else{try{this.Logger.log("[setDefaultBaseURL]: Setting defaultBaseURL: "+defaultBaseURL,"CONFIG",this);this.getObj().setDefaultBaseURL(defaultBaseURL);}
catch(err){this.Logger.log("[setDefaultBaseURL]: Failed to set defaultBaseURL URL: "+defaultBaseURL+" with error: "+err,"SEVERE",this);}
this.Logger.log("[setDefaultBaseURL]: Finished","FINER",this);}};this.setBlockElementAttributes=function(attributes){this.Logger.log("[setBlockElementAttributes]: Started","FINER",this);try{json=jQuery.toJSON(attributes);this.Logger.log("[setBlockElementAttributes]: Setting block element attributes: "+json,"FINE",this);if(this.Helper.initialized){this.getObj().setBlockElementAttributes(json);}else{this.delayMethodCall("setBlockElementAttributes",arguments);}}catch(err){this.Logger.log("[setBlockElementAttributes]: Failed setting block element attributes: "+json+" with error: "+err,"SEVERE",this);}
this.Logger.log("[setBlockElementAttributes]: Finished","FINER",this);};this.setBodyFragment=function(content,sBaseURL){this.Logger.log("[setBodyFragment]: Started","FINER",this);this.Logger.log("[setBodyFragment]: Setting body content to: "+content,"FINER",this);try{if(this.Helper.initialized){if(sBaseURL===undefined){this.getObj().setBodyFragment(content);}else{if(sBaseURL===""){sBaseURL=null;}
this.getObj().setBodyFragment(content,sBaseURL);}}else{this.delayMethodCall("setBodyFragment",arguments);}}catch(err){this.Logger.log("[setBodyFragment]: Failed to set body content to: "+content+" with error: "+err,"SEVERE",this);}
this.Logger.log("[setBodyFragment]: Finished","FINER",this);};this.setCodebase=function(sCodebase){this.Logger.log("[setCodeBase]: Started","FINER",this);try{codebase=this.Helper.resolveURLAgainstDocBase(sCodebase,true)
this.Logger.log("[setCodeBase]: Setting code base: "+codebase+"   ( "+sCodebase+" )","CONFIG",this);this.Helper.codebase=codebase;}catch(err){this.Logger.log("[setCodeBase]: Failed to set code base: "+sCodebase+" with error: "+err,"SEVERE",this);}
this.Logger.log("[setCodeBase]: Finished","FINER",this);};this.setConfig=function(jsonString){this.Logger.log("[setConfig]: Started","FINER",this);try{this.Logger.log("[setConfig]: Setting config from JSON string: "+jsonString,"CONFIG",this);if(this.Helper.initialized===true){this.getObj().setConfig(json);}else{json=jsonString.replace(/\r/g,'');json=json.replace(/\n/g,'');json=json.replace(/\t/g,'');this.Helper.setParam("CONFIG",json);}
this.Helper.config=jQuery.secureEvalJSON(jsonString);}catch(err){this.Logger.log("[setConfig]: Failed to set config from JSON string: "+jsonString+" with error: "+err,"SEVERE",this);}
this.Logger.log("[setConfig]: Finished","FINER",this);};this.setConfigURL=function(configURL){configURL=this.Helper.resolveURL(configURL);this.Logger.log("[setConfigURL]: Started","FINER",this);try{this.Logger.log("[setConfigURL]: Setting config URL "+configURL,"CONFIG",this);var jsObj=this;jQuery.ajax({dataType:"text",async:false,url:configURL,success:function(json){try{json=json.replace(/\r/g,'');json=json.replace(/\n/g,'');json=json.replace(/\t/g,'');jsObj.Helper.setParam("CONFIG",json);jsObj.Helper.config=jQuery.secureEvalJSON(json);}catch(err){jsObj.Logger.log("[setConfigURL]: Failed to set the config URL: "+configURL+" with error: "+err,"SEVERE",this);}},error:function(errormsg){jsObj.Logger.log("[setConfigURL]: Failed to load config from: "+configURL+" with error: "+errormsg,"SEVERE",this);}});}catch(err){this.Logger.log("[setConfigURL]: Failed to set the config URL: "+configURL+" with error: "+err,"SEVERE",this);}
this.Logger.log("[setConfigURL]: Finished","FINER",this);};this.setContentCaching=function(cacheStatus){this.Logger.log("[setContentCaching]: Started","FINER",this);if(cacheStatus){try{if(this.Helper.initialized){this.getObj().setContentCacheKey(this.Helper.generateKey("cache_contents_"));}else{this.delayMethodCall("setContentCaching",arguments);this.Helper.setParam("CONTENTCACHING",cacheStatus);}}
catch(err){this.Logger.log("[setContentCaching]: Failed to activate ContentCaching with error: "+err,"SEVERE",this);}}
this.Logger.log("[setContentCaching]: Finished","FINER",this);};this.setAnnotationUserAttributes=function(){this.Logger.log("[setAnnotationUserAttributes]: Started","FINER",this);try{if(this.Helper.initialized){this.Logger.log("[setAnnotationUserAttributes]: Set annotation attributes: "+json,"FINE",this);this.Helper.annotationUserAttributes.author=arguments[0];}else{this.delayMethodCall("setAnnotationUserAttributes",arguments);}}catch(err){this.Logger.log("[setAnnotationUserAttributes]: Failed setting annotation attributes with error: "+err,"SEVERE",this);}
this.Logger.log("[setAnnotationUserAttributes]: Finished","FINER",this);};this.setCurrentElementContent=function(content){this.Logger.log("[setCurrentElementContent]: Started","FINER",this);this.Logger.log("[setCurrentElementContent]: Setting current element content to: "+content,"FINE",this);try{if(this.Helper.initialized){this.getObj().setCurrentElementContent(content);}else{this.delayMethodCall("setCurrentElementContent",arguments);}}catch(err){this.Logger.log("[setCurrentElementContent]: Failed to set current element content to: "+content+" with error: "+err,"SEVERE",this);}
this.Logger.log("[setCurrentElementContent]: Finished","FINER",this);};this.setCurrentTableColumnCellAttributes=function(attributes){this.Logger.log("[setCurrentTableColumnCellAttributes]: Started","FINER",this);try{json=jQuery.toJSON(attributes);this.Logger.log("[setCurrentTableColumnCellAttributes]: Setting cell attributes (table column): "+json,"FINE",this);if(this.Helper.initialized){this.getObj().setCurrentTableColumnCellAttributes(json);}else{this.delayMethodCall("setCurrentTableColumnCellAttributes",arguments);}}catch(err){this.Logger.log("[setCurrentTableColumnCellAttributes]: Failed to set cell attributes (table column): "+json+" with error: "+err,"SEVERE",this);}
this.Logger.log("[setCurrentTableColumnCellAttributes]: Finished","FINER",this);};this.setCurrentTableRowCellAttributes=function(attributes){this.Logger.log("[setCurrentTableRowCellAttributes]: Started","FINER",this);try{json=jQuery.toJSON(attributes);this.Logger.log("[setCurrentTableRowCellAttributes]: Setting cell attributes (table row): "+json,"FINE",this);if(this.Helper.initialized){this.getObj().setCurrentTableRowCellAttributes(json);}else{this.delayMethodCall("setCurrentTableRowCellAttributes",arguments);}}catch(err){this.Logger.log("[setCurrentTableRowCellAttributes]: Failed to set cell attributes (table row): "+json+" with error: "+err,"SEVERE",this);}
this.Logger.log("[setCurrentTableRowCellAttributes]: Finished","FINER",this);};this.setElementAttributes=function(attributes){this.Logger.log("[setElementAttributes]: Started","FINER",this);try{json=jQuery.toJSON(attributes);this.Logger.log("[setElementAttributes]: Setting element attributes: "+json,"FINE",this);if(this.Helper.initialized){this.getObj().setElementAttributes(json);}else{this.delayMethodCall("setElementAttributes",arguments);}}catch(err){this.Logger.log("[setElementAttributes]: Failed to set element attributes: "+attributes+" with error: "+err,"SEVERE",this);}
this.Logger.log("[setElementAttributes]: Finished","FINER",this);};this.setEmbeddedStyles=function(styles){this.Logger.log("[setEmbeddedStyles]: Started","FINER",this);this.Logger.log("[setEmbeddedStyles]: Setting embedded styles: "+styles,"FINE",this);try{if(this.Helper.initialized){this.getObj().setEmbeddedStyles(styles);}else{this.delayMethodCall("setEmbeddedStyles",arguments);}}catch(err){this.Logger.log("[setEmbeddedStyles]: Failed to set embedded styles: "+styles+" with error: "+err,"SEVERE",this);}
this.Logger.log("[setEmbeddedStyles]: Finished","FINER",this);};this.setEnabled=function(enabled){this.Logger.log("[setEnabled]: Started","FINER",this);this.Logger.log("[setEnabled]: Setting enabled property: "+enabled,"FINE",this);try{if(this.Helper.initialized){this.getObj().setEnabled(enabled);}else{this.delayMethodCall("setEnabled",arguments);}}catch(err){this.Logger.log("[setEnabled]: Failed to set enabled property: "+enabled+" with error: "+err,"SEVERE",this);}
this.Logger.log("[setEnabled]: Finished","FINER",this);};this.setEventHandler=function(eventHandler,method){this.setParam(eventHandler,method);}
this.setExtensionDirectoryURL=function(directoryURL){this.Logger.log("[setExtensionDirectoryURL]: Started","FINER",this);this.Logger.log("[setExtensionDirectoryURL]: Setting extension directory URL: "+directoryURL,"CONFIG",this);try{this.Helper.extensionDirectoryURL=directoryURL;}catch(err){this.Logger.log("[setExtensionDirectoryURL]: Failed to set extension directory URL: "+directoryURL+" with error: "+err,"SEVERE",this);}
this.Logger.log("[setExtensionDirectoryURL]: Finished","FINER",this);};this.setHeadElementContent=function(content){this.Logger.log("[setHeadElementContent]: Started","FINER",this);this.Logger.log("[setHeadElementContent]: Set head element content: "+content,"FINE",this);try{if(this.Helper.initialized){this.getObj().setHeadElementContent(content);}else{this.delayMethodCall("setHeadElementContent",arguments);}}catch(err){this.Logger.log("[setHeadElementContent]: Failed to set head element content: "+content+" with error: "+err,"SEVERE",this);}
this.Logger.log("[setHeadElementContent]: Finished","FINER",this);};this.setIntrusiveJSLogging=function(debug){this.Helper.intrusiveJSLogging=debug;}
this.setIconRepository=function(repositoryURL){this.Logger.log("[setIconRepository]: Started","FINER",this);this.Logger.log("[setIconRepository]: Setting icon repository: "+repositoryURL,"CONFIG",this);try{this.Helper.iconrepositoryURL=repositoryURL;}catch(err){this.Logger.log("[setIconRepository]: Failed to set icon repository: "+repositoryURL+" with error: "+err,"SEVERE",this);}
this.Logger.log("[setIconRepository]: Finished","FINER",this);};this.setJSLogLevel=function(logLevel){this.Logger.log("[setJSLogLevel]: Started","FINER",this);this.Logger.log("[setJSLogLevel]: Setting JS log level: "+logLevel,"CONFIG",this);try{this.Logger.setJSLogLevel(logLevel);}catch(err){this.Logger.log("[setJSLogLevel]: Failed to set JS log level: "+logLevel+" with error: "+err,"SEVERE",this);}
this.Logger.log("[setJSLogLevel]: Finished","FINER",this);};this.setLicenseKeyURL=function(licenseKeyURL){this.Logger.log("[setLicenseKeyURL]: Started","FINER",this);this.Helper.setParam("LICENSEKEY",licenseKeyURL);this.Logger.log("[setLicenseKeyURL]: Finished","FINER",this);}
this.setLocaleCode=function(localeCode){this.Logger.log("[setLocaleCode]: Started","FINER",this);this.Logger.log("[setLocaleCode]: Setting locale code: "+localeCode,"CONFIG",this);try{this.Helper.localeCode=localeCode;}catch(err){this.Logger.log("[setLocaleCode]: Failed to set locale code: "+localeCode+" with error: "+err,"SEVERE",this);}
this.Logger.log("[setLocaleCode]: Finished","FINER",this);};this.setLocaleURL=function(localeURL){this.Logger.log("[setLocaleURL]: Started","FINER",this);this.Logger.log("[setLocaleURL]: Setting locale code URL: "+localeURL,"CONFIG",this);try{this.Helper.localeURL=localeURL;}catch(err){this.Logger.log("[setLocaleURL]: Failed to set locale URL: "+localeURL+" with error: "+err,"SEVERE",this);}
this.Logger.log("[setLocaleURL]: Finished","FINER",this);};this.setLogLevel=function(logLevel){this.Logger.log("[setLogLevel]: Started","FINER",this);this.Logger.log("[setLogLevel]: Setting Java log level: "+logLevel,"CONFIG",this);try{this.Helper.setParam("loglevel",logLevel);}catch(err){this.Logger.log("[setLogLevel]: Failed to set Java log level: "+logLevel+" with error: "+err,"SEVERE",this);}
this.Logger.log("[setLogLevel]: Finished","FINER",this);};this.setMaxMemory=function(maxMemory){this.Logger.log("[setMaxMemory]: Started","FINER",this);this.Logger.log("[setMaxMemory]: Setting max memory: "+maxMemory,"CONFIG",this);try{this.Helper.maxMemory="-Xmx"+maxMemory+"m";}catch(err){this.Logger.log("[setMaxMemory]: Failed to set max memory: "+maxMemory+" with error: "+err,"SEVERE",this);}
this.Logger.log("[setMaxMemory]: Finished","FINER",this);};this.setPack200=function(enablePack200){this.Logger.log("[setPack200]: Started","FINER",this);this.Logger.log("[setPack200]: Setting pack200: "+enablePack200,"CONFIG",this);try{this.Helper.enablePack200=enablePack200;}catch(err){this.Logger.log("[setPack200]: Failed to set pack200: "+enablePack200+" with error: "+err,"FINER",this);}
this.Logger.log("[setPack200]: Finished","FINER",this);};this.setParam=function(paramName,paramValue){this.Logger.log("[setParam]: Started","FINER",this);this.Logger.log("[setParam]: Setting param: "+paramName+": "+paramValue,"CONFIG",this);try{this.Helper.setParam(paramName,paramValue);}catch(err){this.Logger.log("[setParam]: Failed to set param: "+paramName+": "+paramValue+" with error: "+err,"FINER",this);}
this.Logger.log("[setParam]: Finished","FINER",this);};this.setParentElementByNameAttributes=function(ancestorName,attributes){this.Logger.log("[setParentElementByNameAttributes]: Started","FINER",this);try{json=jQuery.toJSON(attributes);this.Logger.log("[setParentElementByNameAttributes]: Setting parent element attributes: "+json+" of: "+ancestorName,"FINE",this);if(this.Helper.initialized){this.getObj().setParentElementByNameAttributes(ancestorName,json);}else{this.delayMethodCall("setParentElementByNameAttributes",arguments);}}catch(err){this.Logger.log("[setParentElementByNameAttributes]: Failed to set parent element attributes: "+json+" on: "+ancestorName+" with error: "+err,"SEVERE",this);}
this.Logger.log("[setParentElementByNameAttributes]: Finished","FINER",this);};this.setParentElementByNameContent=function(ancestorName,content){this.Logger.log("[setParentElementByNameContent]: Started","FINER",this);this.Logger.log("[setParentElementByNameContent]: Setting parent element content: "+content+" of: "+ancestorName,"FINE",this);try{if(this.Helper.initialized){this.getObj().setParentElementByNameContent(ancestorName,content);}else{this.delayMethodCall("setParentElementByNameContent",arguments);}}catch(err){this.Logger.log("[setParentElementByNameContent]: Failed to set parent element content: "+content+" on: "+ancestorName,"SEVERE",this);}
this.Logger.log("[setParentElementByNameContent]: Finished","FINER",this);};this.setTemplate=function(template){this.Logger.log("[setTemplate]: Started","FINER",this);if(!this.Helper.initialized){this.Logger.log("[setTemplate]: Editor not initialized, setting template: "+template+" as PARAM","CONFIG",this);}
this.Logger.log("[setTemplate]: Setting template: "+template,"FINE",this);this.Logger.log("[setTemplate]: Finished","FINER",this);};this.setTemplateURL=function(url,baseURL){this.Logger.log("[setTemplateURL]: Started","FINER",this);if(!this.Helper.initialized){this.Logger.log("[setTemplateURL]: Editor not initialized, setting template URL: "+url+" as PARAM","CONFIG",this);this.Helper.setParam("TEMPLATEURL",url);if(baseURL!=undefined){this.Helper.setParam("TEMPLATEURLBASEURL",baseURL);}}
this.Logger.log("[setTemplateURL]: Setting template URL: "+url,"FINE",this);this.Logger.log("[setTemplateURL]: Finished","FINER",this);};this.setUIConfig=function(jsonString,version){if(version===undefined){version=1;}
this.Helper.uiVersion=version;this.Logger.log("[setUIConfig]: Started","FINER",this);this.Logger.log("[setUIConfig]: Setting uiconfig: "+jsonString,"FINE",this);try{this.Helper.uiconfig=jQuery.secureEvalJSON(jsonString);}catch(err){this.Logger.log("[setUIConfig]: Failed to set uiconfig: "+jsonString+" with error: "+err,"FINER",this);}
this.Logger.log("[setUIConfig]: Finished","FINER",this);};this.setUIConfigURL=function(uiconfigURL,version){if(version===undefined){version=1;}
this.Helper.uiVersion=version;uiconfigURL=this.Helper.resolveURL(uiconfigURL);this.Logger.log("[setUIConfigURL]: Started","FINER",this);var obj=this;jQuery.ajax({dataType:"text",async:false,url:uiconfigURL,success:function(json){json=json.replace(/\r/g,'');json=json.replace(/\n/g,'');json=json.replace(/\t/g,'');obj.Logger.log("[setUIConfigURL]: Setting uiconfig from URL: "+uiconfigURL,"FINER",this);try{obj.Helper.setParam("UICONFIG","{"+obj.Helper.serializeJSON(jQuery.secureEvalJSON(json))+"}");obj.Helper.uiconfig=jQuery.secureEvalJSON(json);}catch(err){obj.Logger.log("[setUIConfigURL]: Failed to set uiconfig from URL: "+uiconfigURL+" with error: "+err,"SEVERE",this);}},error:function(request,err,exception){obj.Logger.log("[setUIConfigURL]: Failed to load uiconfig from URL: "+uiconfigURL+" with error: "+err,"SEVERE",this);}});this.Logger.log("[setUIConfigURL]: Finished","FINER",this);};this.setStructureTemplateConfigURL=function(structureTemplateConfigURL){structureTemplateConfigURL=this.Helper.resolveURL(structureTemplateConfigURL);this.Logger.log("[setUIConfisetStructureTemplateConfigURLgURL]: Started","FINER",this);var obj=this;jQuery.ajax({dataType:"text",async:false,url:structureTemplateConfigURL,success:function(json){json=json.replace(/\r/g,'');json=json.replace(/\n/g,'');json=json.replace(/\t/g,'');obj.Logger.log("[setStructureTemplateConfigURL]: Setting structureTemplateConfig from URL: "+structureTemplateConfigURL,"FINER",this);try{obj.Helper.structureTemplateConfig=jQuery.secureEvalJSON(json);}catch(err){obj.Logger.log("[setStructureTemplateConfigURL]: Failed to set structureTemplateConfig from URL: "+structureTemplateConfigURL+" with error: "+err,"SEVERE",this);}},error:function(request,err,exception){obj.Logger.log("[setStructureTemplateConfigURL]: Failed to load structureTemplateConfig from URL: "+structureTemplateConfig+" with error: "+err,"SEVERE",this);}});this.Logger.log("[setStructureTemplateConfigURL]: Finished","FINER",this);};this.getDocumentBaseURL=function(){this.Logger.log("[getDocumentBaseURL]: Started","FINER",this);this.Logger.log("[getDocumentBaseURL]: Getting base URL","FINE",this);try{baseURL=this.getObj().getDocumentBaseURL();}catch(err){baseURL=null;this.Logger.log("[getDocumentBaseURL]: Failed to get document base URL with error: "+err,"SEVERE",this);}
this.Logger.log("[getDocumentBaseURL]: Finished","FINER",this);return String(baseURL);};this.getDefaultBaseURL=function(){this.Logger.log("[getDefaultBaseURL]: Started","FINER",this);this.Logger.log("[getDefaultBaseURL]: Getting base URL","FINE",this);try{baseURL=this.getObj().getDefaultBaseURL();}catch(err){baseURL=null;this.Logger.log("[getDefaultBaseURL]: Failed to get default base URL with error: "+err,"SEVERE",this);}
this.Logger.log("[getDefaultBaseURL]: Finished","FINER",this);return String(baseURL);};this.getBlockElementAttributes=function(){this.Logger.log("[getBlockElementAttributes]: Started","FINER",this);this.Logger.log("[getBlockElementAttributes]: Getting block element attributes","FINE",this);try{json=this.getObj().getBlockElementAttributes();if(json!==""){eval("var json = "+json);for(i=0;i<json.length;i++){key=json[i][0];value=json[i][1];attributes[key]=value;}}else{attributes=null;}}catch(err){this.Logger.log("[getBlockElementAttributes]: Failed to get block element attributes with error: "+err,"SEVERE",this);attributes=null;}
this.Logger.log("[getBlockElementAttributes]: Finished","FINER",this);return attributes;};this.getBodyFragment=function(){this.Logger.log("[getBodyFragment]: Started","FINER",this);this.Logger.log("[getBodyFragment]: Getting document body fragment","FINE",this);try{content=this.getObj().getBodyFragment();}catch(err){this.Logger.log("[getBodyFragment]: Failed to document body fragment with error: "+err,"SEVERE",this);content=null;}
this.Logger.log("[getBodyFragment]: Finished","FINER",this);return String(content);};this.getBookmarkList=function(){this.Logger.log("[getBookmarkList]: Started","FINER",this);this.Logger.log("[getBookmarkList]: Getting list of bookmarks","FINE",this);try{bookmarkList=this.getObj().getBookmarkList();if(bookmarkList!==undefined&&bookmarkList!==""){bookmarkList=jQuery.evalJSON(bookmarkList);}else{bookmarkList=null;}}catch(err){this.Logger.log("[getBookmarkList]: Failed to getting list of bookmarks: "+err,"SEVERE",this);bookmarkList=null;}
this.Logger.log("[getBookmarkList]: Finished","FINER",this);return bookmarkList;};this.getCurrentElement=function(){this.Logger.log("[getCurrentElement]: Started","FINER",this);this.Logger.log("[getCurrentElement]: Getting current element","FINE",this);try{element=this.getObj().getCurrentElement();}catch(err){this.Logger.log("[getCurrentElement]: Failed to get current element with error: "+err,"SEVERE",this);element=null;}
this.Logger.log("[getCurrentElement]: Finished","FINER",this);return String(element);};this.getCurrentElementContent=function(){this.Logger.log("[getCurrentElementContent]: Started","FINER",this);this.Logger.log("[getCurrentElementContent]: Getting current element content","FINE",this);try{elementContent=this.getObj().getCurrentElementContent();}catch(err){this.Logger.log("[getCurrentElementContent]: Failed to get current element content with error: "+err,"SEVERE",this);elementContent=null;}
this.Logger.log("[getCurrentElementContent]: Finished","FINER",this);return String(elementContent);};this.getCurrentTableColumnCellAttributes=function(){this.Logger.log("[getCurrentTableColumnCellAttributes]: Started","FINER",this);this.Logger.log("[getCurrentTableColumnCellAttributes]: Getting cell attributes (table column)","FINE",this);try{json=this.getObj().getCurrentTableColumnCellAttributes();if(json!==""){eval("var json = "+json);jQuery.each(json,function(cellIndex,cellValue){cells[cellIndex]={};if(cellValue!==undefined&&cellValue!==null){jQuery.each(cellValue,function(attributeIndex,attributeArray){cells[cellIndex][attributeArray[0]]=attributeArray[1];});}});}else{cells=null;}}catch(err){this.Logger.log("[getCurrentTableColumnCellAttributes]: Failed to get cell attributes (table column) with error: "+err,"SEVERE",this);cells=null;}
this.Logger.log("[getCurrentTableColumnCellAttributes]: Finished","FINER",this);return cells;};this.getCurrentTableRowCellAttributes=function(){this.Logger.log("[getCurrentTableRowCellAttributes]: Started","FINER",this);this.Logger.log("[getCurrentTableRowCellAttributes]: Getting cell attributes (table row)","FINE",this);try{json=this.getObj().getCurrentTableRowCellAttributes();if(json!==""){eval("var json = "+json);jQuery.each(json,function(cellIndex,cellValue){cells[cellIndex]={};if(cellValue!==undefined&&cellValue!==null){jQuery.each(cellValue,function(attributeIndex,attributeArray){cells[cellIndex][attributeArray[0]]=attributeArray[1];});}});}else{cells=null;}}catch(err){this.Logger.log("[getCurrentTableRowCellAttributes]: Failed to get cell attributes (table row) with error: "+err,"SEVERE",this);cells=null;}
this.Logger.log("[getCurrentTableRowCellAttributes]: Finished","FINER",this);return cells;};this.getElementAttributes=function(){this.Logger.log("[getElementAttributes]: Started","FINER",this);this.Logger.log("[getElementAttributes]: Getting element attributes","FINE",this);try{json=this.getObj().getElementAttributes();if(json!==""){eval("var json = "+json);attributes={};for(i=0;i<json.length;i++){key=json[i][0];value=json[i][1];attributes[key]=value;}}else{attributes=null;}}catch(err){this.Logger.log("[getElementAttributes]: Failed to get element attributes","SEVERE",this);attributes=null;}
this.Logger.log("[getElementAttributes]: Finished","FINER",this);return attributes;};this.getEmbeddedStyles=function(){return String(this.getObj().getEmbeddedStyles());};this.getDocument=function(){this.Logger.log("[getDocument]: Started","FINER",this);this.Logger.log("[getDocument]: Getting document content","FINE",this);try{content=this.getObj().getDocument();}catch(err){this.Logger.log("[getDocument]: Failed to get document content with error: "+err,"SEVERE",this);content=null;}
this.Logger.log("[getDocument]: Finished","FINER",this);return String(content);};this.getHeadElementContent=function(){return String(this.getObj().getHeadElementContent());};this.getNumberOfCharacters=function(countSpaces){return this.getObj().getNumberOfCharacters(countSpaces);};this.getNumberOfImages=function(){return this.getObj().getNumberOfImages();};this.getNumberOfParagraphs=function(){return this.getObj().getNumberOfParagraphs();};this.getNumberOfWords=function(){return this.getObj().getNumberOfWords();};this.getDocumentLanguage=function(){return this.getObj().getDocumentLanguage();};this.getFragmentLanguage=function(){return this.getObj().getFragmentLanguage();};this.getHyperlinkTarget=function(){return this.getObj().getHyperlinkTarget();};this.getHyperlinkText=function(){return this.getObj().getHyperlinkText();};this.getHyperlinkTitle=function(){return this.getObj().getHyperlinkTitle();};this.getHyperlinkURL=function(){return this.getObj().getHyperlinkURL();};this.getParentElementByName=function(ancestorName){return String(this.getObj().getParentElementByName(ancestorName));};this.getParentElementByNameAttributes=function(ancestorName){json=this.getObj().getParentElementByNameAttributes(ancestorName);if(json!==""){eval("var json = "+json);attributes={};for(i=0;i<json.length;i++){key=json[i][0];value=json[i][1];attributes[key]=value;}
return attributes;}
return null;};this.getParentElementByNameContent=function(ancestorName){return String(this.getObj().getParentElementByNameContent(ancestorName));};this.getPlainText=function(){return String(this.getObj().getPlainText());};this.getSelectionContent=function(){return String(this.getObj().getSelectionContent());};this.hasContentChanged=function(){return this.getObj().hasContentChanged();};this.isActionEnabled=function(actionID){return this.getObj().isActionEnabled(actionID);};this.isEditable=function(){this.Logger.log("[isEditable]: Retrieving the value of the editable property","FINE",this);return this.getObj().isEditable();};this.isEnabled=function(){this.logger.log("[isEnabled]: Retrieving the value of the enabled property","FINE",this);return this.getObj().isEnabled();};this.applyStyleTemplate=function(templateName,groupName){this.getObj().applyStyleTemplate(templateName,groupName);};this.attachEventToElement=function(elem,obj){var actionName=elem.name;var Helper=this.Helper;if(!this.Helper.actions[actionName]){this.Helper.actions[actionName]=new eongApplication.Action(actionName,this.Logger);}
var action=this.Helper.actions[actionName];action.controllers.push(elem);if(elem.tagName.toLowerCase()!=="input"){jQuery(elem).bind('click',function(){tmpName=elem.name;obj.invokeAction(tmpName,null);});}
jQuery(elem).bind('mousedown',function(){jQuery(this).parent("div:not(.zoomSliderDecreaseButton div, .zoomSliderIncreaseButton div, .toolbarDropdown)").addClass("ui-state-active");if(Helper.isMSIE&&Helper.BrowserVersion>7){jQuery(this).parent("div:not(.zoomSliderDecreaseButton div, .zoomSliderIncreaseButton div, .toolbarDropdown)").children().first().css({"border-top":"1px solid transparent","border-left":"1px solid transparent"});}});jQuery(elem).bind('mouseup',function(){jQuery(this).parent("div:not(.zoomSliderDecreaseButton div, .zoomSliderIncreaseButton div, .toolbarDropdown)").removeClass("ui-state-active");if(Helper.isMSIE&&Helper.BrowserVersion>7){jQuery(this).parent("div:not(.zoomSliderDecreaseButton div, .zoomSliderIncreaseButton div, .toolbarDropdown)").children().first().css({"border":"0"});}});};this.createCustomJavaAction=function(actionId,customclass,element){element=jQuery.toJSON(element);this.getObj().createCustomJavaAction(actionId,customclass,element);};this.createJavaScriptAction=function(actionId,path,element,functionName){element=jQuery.toJSON(element);this.getObj().createJavaScriptAction(actionId,path,element,functionName);};this.delayMethodCall=function(){method={};method[0]=arguments[0];method[1]=arguments[1];if(arguments[2]!==null){method[2]=arguments[2];}
this.methodQueue.push(method);};this.getObj=function(){return this.Helper.jsWrapperObj;};this.initializeToolbar=function(userPreferences){var eongObj=this;var loggerObj=this.Logger;var Helper=this.Helper;this.Helper.initialUserPreferences=userPreferences;if(this.Helper.config.saveuistate!==undefined&&this.Helper.config.saveuistate=="true"){var uiversion=1;this.Helper.uiversionOrig=this.Helper.getInitialUserPreferences("uiversion");if(this.Helper.uiversionOrig!==null){uiversion=this.Helper.uiversionOrig[this.Helper.getLocation()];}else{this.Helper.uiversionOrig={};}
if(this.Helper.uiVersion<=uiversion){userUI=this.Helper.getUserDefinedToolbar();if(userUI!==undefined&&userUI!==null&&userUI!==""){this.Helper.uiconfig.toolbar.ribbons.elements=jQuery.evalJSON(userUI);}}else{this.Helper.uistate=this.Helper.getInitialUserPreferences("toolbarstate");if(this.Helper.uistate!==null){this.Helper.uistate[this.Helper.getLocation()]=null;}}
this.DOMElements.createToolbar(false);upSidebar=this.Helper.getInitialUserPreferences("sidebarstate");if(upSidebar!==null){if(upSidebar[this.Helper.getLocation()]!==undefined){if(upSidebar[this.Helper.getLocation()][this.Helper.containerId]!==undefined){initClosed=upSidebar[this.Helper.getLocation()][this.Helper.containerId]["initClosed"];size=upSidebar[this.Helper.getLocation()][this.Helper.containerId]["size"];if(initClosed==="false"){this.Helper.editorLayout.open("west");this.Helper.editorLayout.sizePane("west",size);this.Helper.resizeUI(true);}}}}
this.Helper.uiversionOrig[this.Helper.getLocation()]=this.Helper.uiVersion;}};this.initializeJavaScriptActions=function(){var eongObj=this;var loggerObj=this.Logger;var Helper=this.Helper;jQuery.each(this.Helper.ActionMap,function(index,value){loggerObj.log("[createJSAction]: Started","FINER",this);try{if(value.type=="js"){try{elementNames=value.elementNames;if(elementNames===undefined||elementNames===""){elementNames=["*"];}}catch(err6){elementNames=["*"];}
if(value.actionPath=="CustomJSActions"){loggerObj.log("[createJSAction]: calling with "+index+", "+Helper.jsObjName+"."+value.actionPath+", "+elementNames+", "+value.functionName,"FINEST",this);eongObj.createJavaScriptAction(index,Helper.jsObjName+"."+value.actionPath,elementNames,value.functionName);}else{loggerObj.log("[createJSAction]: calling with "+index+", "+value.actionPath+", "+elementNames+", "+value.functionName,"FINEST",this);eongObj.createJavaScriptAction(index,value.actionPath,elementNames,value.functionName);}}
if(value.type==="javaCustom"){try{elementNames=value.elementNames;if(elementNames===undefined||elementNames===""){elementNames=["*"];}}catch(err7){elementNames=["*"];}
loggerObj.log("[createCustomJavaAction]: calling with "+index+", "+value.javaClass+", "+elementNames,"INFO",this);eongObj.createCustomJavaAction(index,value.javaClass,elementNames);}}catch(err){loggerObj.log("[createJSAction]: creating "+index+", "+value.actionPath+", "+elementNames+" with error: "+err,"SEVERE",this);}
loggerObj.log("[createJSAction]: Finished","FINER",this);});};this.initializeJS=function(jsWrapperRef){this.setObj(jsWrapperRef);this.Helper.initialized=true;this.Helper.setUserPreferences({"uiversion":this.Helper.uiversionOrig});if(this.Helper.uistate!==undefined){this.Helper.setUserPreferences({"toolbarstate":this.Helper.uistate});}
this.initializeJavaScriptActions();this.getObj().createActionMap();this.performMethodCalls();this.DOMElements.enableToolbar();this.Helper.loadDialogHTML();this.Helper.assembleFontDropDownList();};this.callEventHandler=function(args){this.Logger.log("[callEventHandler]: Started","FINER",this);this.Logger.log("[callEventHandler]: Call integrator's event handler","FINE",this);try{handlerName=args[0];callMethod=handlerName+"(this";for(i=1;i<args.length;i++){callMethod+=", "+args[i];}
callMethod+=")";eval(callMethod);}catch(err){this.Logger.log("[callEventHandler]: Failed to call integrator's event handler","SEVERE",this);}}
this.performMethodCalls=function(){if(this.methodQueue!==null){args=[];for(prop in this.methodQueue){method=this.methodQueue[prop];methodName=method[0];if(method[1]!==null&&method[1]!==undefined)args=method[1];if(methodName!==undefined&&methodName!==null){this.Helper.jsObj[methodName](args[0],args[1],args[2],args[3],args[4]);}}}};this.resize=function(obj,width,height){if(this.Helper.detachableUI.enabled!==undefined&&(this.Helper.detachableUI.enabled==="true"||this.Helper.detachableUI.enabled===true)){applicationHeight=height;}else{toolbarHeight=jQuery("#"+this.Helper.containerId+"_toolbar").height();statusBarHeight=jQuery("#"+this.Helper.containerId+"_statusbar").height();applicationHeight=height+toolbarHeight+statusBarHeight;}
jQuery("#"+this.Helper.id).css({"width":width,"height":height});jQuery("#"+this.Helper.id).attr({"width":width,"height":height});jQuery("#"+this.Helper.containerId).css({"height":applicationHeight});jQuery("#"+this.Helper.containerId+"_div").css({"height":height});jQuery("#applicationContainer_"+this.Helper.containerId+" .ui-layout-resizer").height(height);jQuery("#"+this.Helper.containerId+"_sidebar").height(height-1);jQuery("#"+this.Helper.containerId+"_sidebar #"+this.Helper.containerId+"_sidebar_content").height(height-(37));jQuery("#applicationContainer_"+this.Helper.containerId).css({"height":height});jQuery("#replacementImage_"+this.Helper.containerId).css({width:width,height:height});}
this.selectDocumentPaletteIndex=function(){this.Logger.log("[selectDocumentPaletteIndex]: Started","FINER",this);if(arguments.length==1){try{this.Logger.log("[selectDocumentPaletteIndex]: Arguments[0]: "+arguments[0],"FINE",this);this.getObj().selectDocumentPaletteIndex(arguments[0]);}catch(err){this.Logger.log("[selectDocumentPalette]: "+arguments[0]+" with error: "+err,"SEVERE",this);}}else{this.Logger.log("[selectDocumentPaletteIndex]: Arguments[0]: "+arguments[0]+", Arguments[1]: "+arguments[1],"FINE",this);try{this.getObj().selectDocumentPaletteIndex(arguments[0],arguments[1]);}catch(err2){this.Logger.log("[selectDocumentPalette]: "+arguments[0]+", "+arguments[1]+" with error: "+err2,"SEVERE",this);}}
this.Logger.log("[selectDocumentPaletteIndex]: Finished","FINER",this);};this.setObj=function(jsWrapperObj){this.Helper.jsWrapperObj=jsWrapperObj;};this.setReplacementImage=function(obj,base64Img){if(this.Helper.isMSIE&&this.Helper.BrowserVersion!="8.0"){}else{jQuery("#replacementImage_"+this.Helper.containerId).attr("src",base64Img);}};this.updateAction=function(actionId,propertyName,propertyValue){this.Logger.log("[updateAction]: Started ("+actionId+", "+propertyName+","+propertyValue+")","FINEST");actionId=actionId+'';propertyName=propertyName+'';propertyValue=propertyValue+'';if(actionId==="zoom"&&propertyName==="StringState"&&(this.Helper.config.enablestatusbar===undefined||this.Helper.config.enablestatusbar=="true"||this.Helper.config.enablestatusbar===true)&&(this.Helper.config.enablezoomarea===undefined||this.Helper.config.enablezoomarea=="true")){newPropertyValue=parseInt(propertyValue);if(newPropertyValue<=100){newPropertyValue=newPropertyValue*5;}else{newPropertyValue=1.25*(newPropertyValue+300);}
jQuery("#"+this.Helper.containerId+"_statusbar .zoomSlider").slider('value',parseInt(newPropertyValue));}
if(this.Helper.actions[actionId]&&this.Helper.actions[actionId]['set'+propertyName]){try{this.Logger.log("[updateAction]: "+actionId+" invoking in Actions.js","FINEST");this.Helper.actions[actionId]['set'+propertyName](propertyValue);}catch(err){this.Logger.log("[updateAction]: Calling ("+actionId+", "+propertyName+","+propertyValue+") on action object failed with: "+err,"SEVERE");}}};this.updateDocumentPalette=function(obj,args){var obj=this;if(this.Helper.config.enabledocumentpalette===undefined||this.Helper.config.enabledocumentpalette=="true"){this.Helper.currentPaletteScrollValue=0;jQuery("#"+this.Helper.containerId+"_statusbar .documentPaletteContainer").scrollTo(0,0);jQuery("#"+this.Helper.containerId+"_statusbar .documentPaletteContainer").html("<table cellspacing=\"0\" class=\"documentPaletteList\"><tr></tr></table>");jQuery.each(args,function(i,val){if(i===0||(i%2)===0){var spacerContent=[];jQuery.each(val,function(k,valk){var itemValues=[];itemValues.push(i+"_"+k);itemValues.push(valk);spacerContent.push(itemValues);});jQuery("#"+obj.Helper.containerId+"_statusbar .documentPaletteContainer tr").append("<td class=\"documentPaletteListSpacer\" id=\"documentPaletteSpacerContainer_"+i+"_"+obj.Helper.containerId+"\"></td>");jQuery("#documentPaletteSpacerContainer_"+i+"_"+obj.Helper.containerId).menu({content:spacerContent,contentType:"json",showSpeed:200,height:100,dropdownWidth:100,directionV:"up",iconDirection:"right",onSelect:function(){var indexAttr=jQuery(this).attr("alt");indexAttr=indexAttr.split("_");obj.selectDocumentPaletteIndex(indexAttr[0],indexAttr[1]);},onShowDropDown:function(){obj.Helper.replaceEditor(true);},onCloseDropDown:function(){obj.Helper.replaceEditor(false);}});}else{jQuery("#"+obj.Helper.containerId+"_statusbar .documentPaletteContainer tr").append("<td class=\"documentPaletteListElement\">"+"<span class=\"ui-corner-all documentPaletteElement\" id=\"documentPaletteElement_"+
i+"_"+
obj.Helper.containerId+"\">"+"<span>"+
val+"</span>"+"</span>"+"</td>");jQuery(".documentPaletteElement").bind('mouseover',function(e){jQuery(this).addClass("ui-state-hover");});jQuery(".documentPaletteElement").bind('mouseout',function(e){jQuery(this).removeClass("ui-state-hover");});jQuery("#documentPaletteElement_"+i+"_"+obj.Helper.containerId).bind('click',function(e){obj.selectDocumentPaletteIndex(i);});}});this.toggleNav();jQuery("#"+obj.Helper.containerId+"_statusbar .documentPaletteNavRight").mouseover(function(event){if(obj.paletteNavInterval===undefined||obj.paletteNavInterval===null){obj.paletteNavInterval=window.setInterval(obj.Helper.jsObjName+".scrollRight()",10);}});jQuery("#"+obj.Helper.containerId+"_statusbar .documentPaletteNavRight").bind("mouseout",function(){window.clearInterval(obj.paletteNavInterval);obj.paletteNavInterval=null;});jQuery("#"+obj.Helper.containerId+"_statusbar .documentPaletteNavLeft").mouseover(function(event){if(obj.paletteNavInterval===undefined||obj.paletteNavInterval===null){obj.paletteNavInterval=window.setInterval(obj.Helper.jsObjName+".scrollLeft()",10);}});jQuery("#"+obj.Helper.containerId+"_statusbar .documentPaletteNavLeft").bind("mouseout",function(){window.clearInterval(obj.paletteNavInterval);obj.paletteNavInterval=null;});jQuery("#"+obj.Helper.containerId+"_statusbar .documentPaletteNavRight, #"+obj.Helper.containerId+"_statusbar .documentPaletteNavLeft").bind("mousedown",function(){obj.Helper.scrollSpeed=10;});jQuery("*").bind("mouseup",function(){obj.Helper.scrollSpeed=1;});}};this.updateDocumentCounter=function(obj,args){if(this.Helper.config.charactercounter!==undefined&&this.Helper.config.charactercounter.enabled!==undefined&&this.Helper.config.charactercounter.enabled==="true"){if(this.Helper.config.charactercounter!==undefined&&this.Helper.config.charactercounter.limit!==undefined&&parseInt(this.Helper.config.charactercounter.limit)<parseInt(args)){jQuery("#"+this.Helper.containerId+"_statusbar .documentCounterDisplay").css({"color":"red"});}else{jQuery("#"+this.Helper.containerId+"_statusbar .documentCounterDisplay").css({"color":"black"});}
var counterStr="";if(this.Helper.config.charactercounter!==undefined&&this.Helper.config.charactercounter.limit!==undefined){counterStr=args+" / "+this.Helper.config.charactercounter.limit;}else{counterStr=args+""}
jQuery("#"+this.Helper.containerId+"_statusbar .documentCounterDisplay").html(counterStr);var statusBarReduceWidth=jQuery("#"+this.Helper.containerId+"_statusbar .buttonContainer").outerWidth(true)+6;statusBarReduceWidth+=((jQuery("#"+this.Helper.containerId+"_statusbar .buttonContainer td").length+1)*2)+2;if(this.Helper.config.enablezoomarea===undefined||this.Helper.config.enablezoomarea=="true"){statusBarReduceWidth+=246;}
if(this.Helper.config.charactercounter!==undefined&&this.Helper.config.charactercounter.enabled!==undefined&&this.Helper.config.charactercounter.enabled==="true"){statusBarReduceWidth+=jQuery("#"+this.Helper.containerId+"_statusbar .documentCounterArea").outerWidth(true)+6;}
if(this.Helper.config.resizable!==undefined&&this.Helper.config.resizable=="true"){statusBarReduceWidth+=jQuery("#"+this.Helper.containerId+"_statusbar .resizerContainer").outerWidth(true)+6;}
statusBarReduceWidth+=40;jQuery("#"+this.Helper.containerId+"_statusbar .documentPaletteContainer").width(width-statusBarReduceWidth);}}
this.scrollRight=function(){if(this.Helper.currentPaletteScrollValue<this.Helper.maxScrollValue){this.Helper.currentPaletteScrollValue+=1*this.Helper.scrollSpeed;jQuery("#"+this.Helper.containerId+"_statusbar .documentPaletteContainer").scrollTo(this.Helper.currentPaletteScrollValue,0);this.toggleNav();}}
this.scrollLeft=function(){if(this.Helper.currentPaletteScrollValue>0){this.Helper.currentPaletteScrollValue-=1*this.Helper.scrollSpeed;if(this.Helper.currentPaletteScrollValue>0){jQuery("#"+this.Helper.containerId+"_statusbar .documentPaletteContainer").scrollTo(this.Helper.currentPaletteScrollValue,0);this.toggleNav();}else{this.Helper.currentPaletteScrollValue=0;jQuery("#"+this.Helper.containerId+"_statusbar .documentPaletteContainer").scrollTo(this.Helper.currentPaletteScrollValue,0);this.toggleNav();}}}
this.scrollToHelper=function(args){var amount=args[0];amount=Math.abs(amount);var dir=args[1];var prefix="+=";if(dir=="up"){prefix="-=";}
var expression=prefix+amount+"px";jQuery.scrollTo(expression,{axis:"y"});}
this.toggleNav=function(){var listWidth=jQuery("#"+this.Helper.containerId+"_statusbar .documentPaletteList").width();var containerWidth=jQuery("#"+this.Helper.containerId+"_statusbar .documentPaletteContainer").width();var maxScrollValue=listWidth-containerWidth;this.Helper.maxScrollValue=maxScrollValue;if(maxScrollValue<=0){jQuery("#"+this.Helper.containerId+"_statusbar .documentPaletteNavLeft").css({"visibility":"hidden"});jQuery("#"+this.Helper.containerId+"_statusbar .documentPaletteNavRight").css({"visibility":"hidden"});}else{jQuery("#"+this.Helper.containerId+"_statusbar .documentPaletteNavLeft").css({"visibility":"visible"});jQuery("#"+this.Helper.containerId+"_statusbar .documentPaletteNavRight").css({"visibility":"visible"});if(this.Helper.currentPaletteScrollValue<=0){jQuery("#"+this.Helper.containerId+"_statusbar .documentPaletteNavLeft span").addClass("ui-state-disabled");}else{jQuery("#"+this.Helper.containerId+"_statusbar .documentPaletteNavLeft span").removeClass("ui-state-disabled");}
if(this.Helper.currentPaletteScrollValue>=maxScrollValue){jQuery("#"+this.Helper.containerId+"_statusbar .documentPaletteNavRight span").addClass("ui-state-disabled");}else{jQuery("#"+this.Helper.containerId+"_statusbar .documentPaletteNavRight span").removeClass("ui-state-disabled");}}};this.updateFileChooserInput=function(element,value){jQuery(element).val(unescape(value));};this.addStyleTemplateGroup=function(obj,sideBarContent,groupName,displayGroupName){var containerId=obj.Helper.containerId;var groupContainer=jQuery("<div></div>").addClass("styleGroupOuterContainer").attr("id",groupName+"_"+containerId);var groupTitleContainer=jQuery("<div>"+displayGroupName+"</div>").addClass("ui-widget-header").addClass("styleGroup");groupContainer.append(groupTitleContainer);var groupTemplatesContainer=jQuery("<div></div>").addClass("ui-widget-content").attr("id",groupName+"_"+containerId+"_stylecontainer");groupContainer.append(groupTemplatesContainer);sideBarContent.append(groupContainer);}
this.removeStyleTemplateGroup=function(obj,sideBarContent,groupName){sideBarContent.find("div#"+groupName+"_"+obj.Helper.containerId).remove();}
this.removeStyleTemplate=function(obj,sideBarContent,groupName,actionId){var containerId=obj.Helper.containerId;var group=sideBarContent.find("div#"+groupName+"_"+containerId+"_stylecontainer");if(group!=null&&group.length>0){sideBarContent.find("div#"+actionId+"_"+containerId).remove();if(group.length<=0){obj.removeStyleTemplateGroup(obj,sideBarContent,groupName);}}}
this.addStyleTemplate=function(obj,sideBarContent,groupName,displayGroupName,actionId,actionIdOrig,styleName){var group=sideBarContent.find("div#"+groupName+"_"+obj.Helper.containerId+"_stylecontainer");if(group.length<=0){obj.addStyleTemplateGroup(obj,sideBarContent,groupName,displayGroupName);group=sideBarContent.find("div#"+groupName+"_"+obj.Helper.containerId+"_stylecontainer");}
var actionContainerId=actionId+"_"+obj.Helper.containerId;var actionEntry=group.find("div#"+actionContainerId);if(actionEntry!=null&&actionEntry.attr("id")==actionContainerId){obj.removeStyleTemplate(obj,sideBarContent,groupName,actionId);}
var actionContainer=jQuery("<div>"+styleName+"</div>").addClass("styleTemplateContainer").addClass("transparent-border").addClass("ui-corner-all").attr("id",actionContainerId).bind('click',function(){obj.invokeAction(actionIdOrig,null);}).bind('mouseover',function(){jQuery(this).addClass("ui-state-hover").removeClass("transparent-border");}).bind('mouseout',function(){jQuery(this).removeClass("ui-state-hover").addClass("transparent-border");});group.append(actionContainer);}
this.refreshStyleTemplateStates=function(obj,sideBarContent,groupName,container,selectedState,enabledState){if(container!=null){if(selectedState===true){container.addClass("ui-state-active");}else{container.removeClass("ui-state-active");}
if(enabledState===true){container.addClass("styleTemplateVisible").removeClass("styleTemplateHidden");}else{container.addClass("styleTemplateHidden").removeClass("styleTemplateVisible");}}
if(groupName!=null){if(sideBarContent.find("#"+groupName+"_"+obj.Helper.containerId+"_stylecontainer").children("div.styleTemplateVisible").length>1){sideBarContent.find("#"+groupName+"_"+obj.Helper.containerId).css({"display":"block"});}else{sideBarContent.find("#"+groupName+"_"+obj.Helper.containerId).css({"display":"none"});}}}
this.initializeStyleTemplates=function(obj,args){var obj=this;styletemplateenabled=this.Helper.config.enablestyletemplatepanel;if(styletemplateenabled===undefined||styletemplateenabled=="true"||styletemplateenabled===true){jQuery("#SafariFixToolbar").html("&nbsp;");var cId=obj.Helper.containerId;var sideBar=jQuery("#"+cId+"_sidebar");var sideBarContent=sideBar.find("#"+cId+"_sidebar_content");sideBarContent.detach();sideBarContent.empty();jQuery.each(args,function(i,val){var actionId=String(val[0]);var styleName=val[1];var groupName=String(val[2]);var enabledState=val[3];var selectedState=val[4];var changeType=val[5];var localizedName=obj.Helper.LocaleObject[styleName];if(localizedName!=undefined){styleName=localizedName;}
var displayGroupName=groupName;var localizedGroupName=obj.Helper.LocaleObject[displayGroupName];if(localizedGroupName!=undefined){displayGroupName=localizedGroupName;}
groupName=groupName.replace(/ /g,"_");var actionIdOrig=actionId;actionId=actionIdOrig.replace(/ /g,"_");obj.addStyleTemplate(obj,sideBarContent,groupName,displayGroupName,actionId,actionIdOrig,styleName);var container=sideBarContent.find("#"+actionId+"_"+obj.Helper.containerId);obj.refreshStyleTemplateStates(obj,sideBarContent,groupName,container,selectedState,enabledState);});sideBar.append(sideBarContent);jQuery("#SafariFixToolbar").html("");}}
this.updateStyleTemplates=function(obj,args){var obj=this;styletemplateenabled=this.Helper.config.enablestyletemplatepanel;if(styletemplateenabled===undefined||styletemplateenabled=="true"||styletemplateenabled===true){var cId=obj.Helper.containerId;var sideBar=jQuery("#"+cId+"_sidebar");var sideBarContent=sideBar.find("#"+cId+"_sidebar_content");sideBarContent.detach();jQuery.each(args,function(i,val){var actionId=String(val[0]);var styleName=val[1];var groupName=String(val[2]);var enabledState=val[3];var selectedState=val[4];var changeType=val[5];groupName=groupName.replace(/ /g,"_");var actionIdOrig=actionId;actionId=actionIdOrig.replace(/ /g,"_");var container=sideBarContent.find("#"+actionId+"_"+cId);if(changeType!=0){var localizedName=obj.Helper.LocaleObject[styleName];if(localizedName!=undefined){styleName=localizedName;}
var displayGroupName=groupName;var localizedGroupName=obj.Helper.LocaleObject[displayGroupName];if(localizedGroupName!=undefined){displayGroupName=localizedGroupName;}
if(changeType==-1&&container!=null){obj.removeStyleTemplate(obj,sideBarContent,groupName,actionId);}
else if(changeType==1){obj.addStyleTemplate(obj,sideBarContent,groupName,displayGroupName,actionId,actionIdOrig,styleName);}}
container=sideBarContent.find("#"+actionId+"_"+cId);obj.refreshStyleTemplateStates(obj,sideBarContent,groupName,container,selectedState,enabledState);});sideBar.append(sideBarContent);}}
this.updateStyleTemplateStates=function(obj,args){var obj=this;styletemplateenabled=this.Helper.config.enablestyletemplatepanel;if(styletemplateenabled===undefined||styletemplateenabled=="true"||styletemplateenabled===true){var cId=obj.Helper.containerId;var sideBar=jQuery("#"+cId+"_sidebar");var sideBarContent=sideBar.find("#"+cId+"_sidebar_content").detach();jQuery.each(args,function(i,val){var actionId=String(val[0]);var styleName=val[1];var groupName=String(val[2]);var enabledState=val[3];var selectedState=val[4];var changeType=val[5];groupName=groupName.replace(/ /g,"_");var actionIdOrig=actionId;actionId=actionIdOrig.replace(/ /g,"_");if(changeType==0){var container=sideBarContent.find("#"+actionId+"_"+cId);obj.refreshStyleTemplateStates(obj,sideBarContent,groupName,container,selectedState,enabledState);}});sideBar.append(sideBarContent);}}
this.updateVirtualCaret=function(posX,posY,caretWidth,caretHeight){if(!this.Helper.disableVirtualCaret){offset=jQuery("#"+this.Helper.containerId+"_eong").offset();offsetY=offset.top+parseInt(posY)-15;offsetX=offset.left+parseInt(posX);jQuery("#"+this.Helper.containerId+"_virtualCaret").css({top:offsetY,left:offsetX,width:caretWidth,height:caretHeight});try{this.Helper.scrollToViewPort("#"+this.Helper.containerId+"_virtualCaret");}catch(err){this.Logger.log("[updateVirtualCaret]: Scrolling to viewport failed: "+err,"SEVERE",this);}}};this.updateWebdavChooserInput=function(element,value){jQuery(element).val(unescape(value));};};function EONG_callMethod(jsonArray,jsWrapperRef){try{eval("var json = "+jsonArray.toString());}catch(err1){alert("[SEVERE][CallMethod]: Error in evaluating jsonArray: "+err1);}
var eongobj=json[0];this.Logger=eval(eongobj+".Logger");this.Logger.log("[CallMethod]: Started, eval'd jsonArray","FINEST",this);var func=json[1];var args=json[2];if(func==eongobj+".updateVirtualCaret"){this.Logger.log("[CallMethod][updateVirtualCaret]: Started","FINEST",this);loggerHelper=this.Logger;args=json[2];try{eval(eongobj+".updateVirtualCaret(args[0], args[1], args[2], args[3])");}catch(err10){}
this.Logger.log("[CallMethod][updateFileChooserInput]: Finished","FINEST",this);}else if(func==eongobj+".updateFileChooserInput"){this.Logger.log("[CallMethod][updateFileChooserInput]: Started","FINEST",this);loggerHelper=this.Logger;args=json[2];args[1]=escape(args[1]);try{eval(eongobj+".updateFileChooserInput(args[0], args[1])");}catch(err2){loggerHelper.log("[CallMethod][updateFileChooserInput]: calling failed with ("+val[0]+", "+val[1]+"), Error: "+err2,"SEVERE",this);}
this.Logger.log("[CallMethod][updateFileChooserInput]: Finished","FINEST",this);}else if(func==eongobj+".updateWebdavChooserInput"){this.Logger.log("[CallMethod][updateWebdavChooserInput]: Started","FINEST",this);loggerHelper=this.Logger;args=json[2];args[1]=escape(args[1]);try{eval(eongobj+".updateWebdavChooserInput(args[0], args[1])");}catch(err3){loggerHelper.log("[CallMethod][updateWebdavChooserInput]: calling failed with ("+val[0]+", "+val[1]+"), Error: "+err3,"SEVERE",this);}
this.Logger.log("[CallMethod][updateWebdavChooserInput]: Finished","FINEST",this);}
else if(func==eongobj+".updateAction"){this.Logger.log("[CallMethod][updateAction]: Started","FINEST",this);loggerHelper=this.Logger;jQuery.each(json[2],function(i,val){try{eval(eongobj+".updateAction(val[0], val[1], val[2])");}catch(err4){loggerHelper.log("[CallMethod][updateAction]: calling failed with ("+val[0]+", "+val[1]+","+val[2]+"), Error: "+err4,"SEVERE",this);}});this.Logger.log("[CallMethod][updateAction]: Finished","FINEST",this);}
else if(func==eongobj+".initializeStyleTemplates"){this.Logger.log("[CallMethod][initializeStyleTemplates]: Started","FINEST",this);try{eval(eongobj+".initializeStyleTemplates(eongobj,args)");}catch(err5){this.Logger.log("[CallMethod][initializeStyleTemplates]: calling failed with ("+args+"), Error: "+err5,"SEVERE",this);}
this.Logger.log("[CallMethod][initializeStyleTemplates]: Finished","FINEST",this);}
else if(func==eongobj+".updateStyleTemplates"){this.Logger.log("[CallMethod][updateStyleTemplates]: Started","FINEST",this);try{eval(eongobj+".updateStyleTemplates(eongobj,args)");}catch(err5){this.Logger.log("[CallMethod][updateStyleTemplates]: calling failed with ("+args+"), Error: "+err5,"SEVERE",this);}
this.Logger.log("[CallMethod][updateStyleTemplates]: Finished","FINEST",this);}
else if(func==eongobj+".updateStyleTemplateStates"){this.Logger.log("[CallMethod][updateStyleTemplateStates]: Started","FINEST",this);try{eval(eongobj+".updateStyleTemplateStates(eongobj,args)");}catch(err5){this.Logger.log("[CallMethod][updateStyleTemplateStates]: calling failed with ("+args+"), Error: "+err5,"SEVERE",this);}
this.Logger.log("[CallMethod][updateStyleTemplateStates]: Finished","FINEST",this);}
else if(func==eongobj+".updateDocumentPalette"){this.Logger.log("[CallMethod][updateDocumentPalette]: Started","FINEST",this);try{eval(eongobj+".updateDocumentPalette(eongobj,args)");}catch(err6){this.Logger.log("[CallMethod][updateDocumentPalette]: calling failed with ("+args+"), Error: "+err6,"SEVERE",this);}
this.Logger.log("[CallMethod][updateDocumentPalette]: Finished","FINEST",this);}else if(func==eongobj+".setReplacementImage"){this.Logger.log("[CallMethod][setReplacementImage]: Started","FINEST",this);try{eval(eongobj+".setReplacementImage(eongobj,args)");}catch(err7){this.Logger.log("[CallMethod][setReplacementImage]: calling failed with ("+args+"), Error: "+err7,"SEVERE",this);}
this.Logger.log("[CallMethod][setReplacementImage]: Finished","FINEST",this);}else if(func==eongobj+".initializeToolbar"){this.Logger.log("[CallMethod][initializeToolbar]: Started","FINEST",this);try{eval(eongobj+".initializeToolbar(args)");}catch(err9){this.Logger.log("[CallMethod][initializeToolbar]: calling failed with ("+args+"), Error: "+err9,"SEVERE",this);}
this.Logger.log("[CallMethod][initializeToolbar]: Finished","FINEST",this);}else if(func==eongobj+".initializeJS"){this.Logger.log("[CallMethod][initializeJS]: Started","FINEST",this);try{eval(eongobj+".initializeJS(jsWrapperRef)");}catch(err9){this.Logger.log("[CallMethod][initializeJS]: calling failed with ("+args+"), Error: "+err9,"SEVERE",this);}
this.Logger.log("[CallMethod][initializeJS]: Finished","FINEST",this);}else if(func==eongobj+".callEventHandler"){this.Logger.log("[CallMethod][callEventHandler]: Started","FINEST",this);try{eval(eongobj+".callEventHandler(args)");}catch(err9){this.Logger.log("[CallMethod][callEventHandler]: calling failed with ("+args+"), Error: "+err9,"SEVERE",this);}
this.Logger.log("[CallMethod][callEventHandler]: Finished","FINEST",this);}else if(func==eongobj+".updateDocumentCounter"){this.Logger.log("[CallMethod][updateDocumentCounter]: Started","FINEST",this);try{if(args!==null){var characters=args[0];var isUpdate=args[1];var eventHandler=args[2];if(eventHandler!==null){params=[];params[0]=eventHandler;params[1]=characters;eval(eongobj+".callEventHandler(params)");}
if(isUpdate){eval(eongobj+".updateDocumentCounter(eongobj,characters)");}}}catch(err6){this.Logger.log("[CallMethod][updateDocumentCounter]: calling failed with ("+args+"), Error: "+err6,"SEVERE",this);}
this.Logger.log("[CallMethod][updateDocumentCounter]: Finished","FINEST",this);}
else if(func==eongobj+".invokeAction"){this.Logger.log("[CallMethod][invokeAction]: Started","FINEST",this);try{eval(eongobj+".invokeAction(args)");}catch(err6){this.Logger.log("[CallMethod][invokeAction]: calling failed with ("+args+"), Error: "+err6,"SEVERE",this);}
this.Logger.log("[CallMethod][invokeAction]: Finished","FINEST",this);}
else if(func==eongobj+".scrollToHelper"){this.Logger.log("[CallMethod][scrollToHelper]: Started","FINEST",this);try{eval(eongobj+".scrollToHelper(args)");}catch(err6){this.Logger.log("[CallMethod][scrollToHelper]: calling failed with ("+args+"), Error: "+err6,"SEVERE",this);}
this.Logger.log("[CallMethod][scrollToHelper]: Finished","FINEST",this);}
else if(func!==null){var params="("+eongobj;if(args!==null){params+=", "+args;}
params+=")";sHandler=func+params;try{this.Logger.log("[CallMethod][Generic function]: calling  "+func+" with ("+params+")","FINEST",this);eval(sHandler);}catch(err8){this.Logger.log("[CallMethod][Generic function]: calling "+func+" failed with ("+args+"). Error: "+err8,"SEVERE",this);}}
this.Logger.log("[CallMethod]: Finished","FINEST",this);};function getRelativePath(){var myName=/(^|[\/\\])edit-on-ng.*\.js(\?|$)/;var scripts=document.getElementsByTagName("script");for(var i=0;i<scripts.length;i++){var src;src=scripts[i].getAttribute("src");if(src!==undefined&&src!==null){if(src.match(myName)){return src.replace(/edit-on-ng.*\.js/,"");}}}
return"";};eongApplication.Action=function(actionId,actionLogger){this.actionId=actionId;this.enabled=null;this.SelectedState=null;this.StringState=null;this.controllers=[];this.setenabled=function(paramValue){actionLogger.log("[Action][SetEnabled - "+this.actionId+"]: Started","FINEST",this);this.enabled=paramValue;var enabled=(paramValue.toString()==='true');actionLogger.log("[Action][SetEnabled]: Enabled: "+enabled,"ALL",this);jQuery.each(this.controllers,function(i,elem){elem.disabled=!enabled;actionLogger.log("[Action][SetEnabled - Controllers]: i: "+i+", Elem.disabled: "+elem.disabled,"ALL",this);if(enabled){jQuery(elem).addClass("enabled");jQuery(elem).parent().addClass("enabled");}else{jQuery(elem).removeClass("enabled");jQuery(elem).parent().removeClass("enabled");}
actionLogger.log("[Action][SetEnabled]: Enabled ? addClass(enabled) : removeClass(enabled)","ALL",this);if(!enabled){jQuery(elem).addClass("disabled");jQuery(elem).parent().addClass("disabled");}else{jQuery(elem).removeClass("disabled");jQuery(elem).parent().removeClass("disabled");}
actionLogger.log("[Action][SetEnabled]: Not Enabled ? addClass(disabled) : removeClass(disabled)","ALL",this);});actionLogger.log("[Action][SetEnabled - "+this.actionId+"]: Finished","FINEST",this);};this.setSelectedState=function(paramValue){actionLogger.log("[Action][SetSelectedState - "+this.actionId+"]: Started","FINEST",this);this.SelectedState=paramValue;var enabled=(paramValue.toString()==='true');actionLogger.log("[Action][SetSelectedState enabled: "+enabled,"ALL",this);jQuery.each(this.controllers,function(i,elem){actionLogger.log("[Action][SetSelectedState - Controllers]: i: "+i+", Enabled: "+enabled,"ALL",this);if(enabled){actionLogger.log("[Action][SetSelectedState]: Enabled: Setting highlight","ALL",this);jQuery(elem).parent().addClass("highlight, ui-state-active");jQuery(".SafariFixToolbar").html("");}else{actionLogger.log("[Action][SetSelectedState]: Not Enabled: Removing highlight","ALL",this);jQuery(elem).parent().removeClass("highlight, ui-state-active");jQuery(".SafariFixToolbar").html("&nbsp;");}});actionLogger.log("[Action][SetSelectedState - "+this.actionId+"]: Finished","FINEST",this);};this.setStringState=function(paramValue){actionLogger.log("[Action][SetStringState - "+this.actionId+"]: Started","FINEST",this);this.StringState=paramValue;var stringState=paramValue;if(stringState==="null"||stringState===null){stringState="";}
actionLogger.log("[Action][SetStringState["+this.actionId+"]: "+this.StringState,"FINEST",this);jQuery.each(this.controllers,function(i,elem){if(elem.tagName.toLowerCase()==="input"){jQuery(elem).attr("value",stringState);jQuery(elem).attr("alt","");}});actionLogger.log("[Action][SetStringState - "+this.actionId+"]: Finished","FINEST",this);};};eongApplication.actionMap=function(){this.actionMap={"insert-structure-template-dialog":{"type":"js","functionName":"insertStructureTemplateDialog","actionPath":"CustomJSActions","title":"L_INSERT_STRUCTURE_TEMPLATE_DIALOG"},"load-url-dialog":{"type":"js","functionName":"loadURLDialog","actionPath":"CustomJSActions","title":"L_LOAD_URL_DIALOG","smallIconURL":"../../lib/icons/load-url-dialog-small.png"},"load-document-dialog":{"type":"java","title":"L_LOAD_DOCUMENT_FILE_DIALOG","smallIconURL":"../../lib/icons/load-document-dialog-small.png"},"insert-image-dialog":{"type":"js","functionName":"insertImageDialog","actionPath":"CustomJSActions","title":"L_INSERT_IMAGE_DIALOG"},"image-properties-dialog":{"type":"js","functionName":"imagePropertiesDialog","actionPath":"CustomJSActions","title":"L_IMAGE_PROPERTIES_DIALOG"},"image-properties":{"type":"java","title":"L_IMAGE_PROPERTIES_DIALOG"},"abbr":{"type":"java","title":"L_ABBR"},"acronym":{"type":"java","title":"L_ACRONYM"},"cite":{"type":"java","title":"L_CITE"},"code":{"type":"java","title":"L_CODE"},"dfn":{"type":"java","title":"L_DFN"},"em":{"type":"java","title":"L_EM"},"kbd":{"type":"java","title":"L_KBD"},"samp":{"type":"java","title":"L_SAMP"},"strong":{"type":"java","title":"L_STRONG"},"var":{"type":"java","title":"L_VAR"},"q":{"type":"java","title":"L_Q"},"insert-image":{"type":"java","title":"L_INSERT_IMAGE"},"insert-object":{"type":"java","title":"L_INSERT_OBJECT"},"insert-bookmark":{"type":"java","title":"L_INSERT_BOOKMARK"},"change-bookmark":{"type":"java","title":"L_CHANGE_BOOKMARK"},"move-to-next-bookmark":{"type":"java","title":"L_MOVE_TO_NEXT_BOOKMARK"},"move-to-previous-bookmark":{"type":"java","title":"L_MOVE_TO_PREVIOUS_BOOKMARK"},"move-to-bookmark":{"type":"java","title":"L_MOVE_TO_BOOKMARK"},"remove-bookmark":{"type":"java","title":"L_REMOVE_BOOKMARK"},"remove-hyperlink":{"type":"java","title":"L_REMOVE_HYPERLINK"},"insert-bookmark-dialog":{"type":"js","functionName":"insertBookmarkDialog","actionPath":"CustomJSActions","title":"L_INSERT_BOOKMARK_DIALOG"},"bookmark-properties-dialog":{"type":"js","functionName":"bookmarkPropertiesDialog","actionPath":"CustomJSActions","title":"L_BOOKMARK_PROPERTIES_DIALOG"},"insert-hyperlink-dialog":{"type":"js","functionName":"insertHyperlinkDialog","actionPath":"CustomJSActions","title":"L_INSERT_HYPERLINK_DIALOG"},"hyperlink-properties-dialog":{"type":"js","functionName":"linkPropertiesDialog","actionPath":"CustomJSActions","title":"L_HYPERLINK_PROPERTIES_DIALOG"},"horizontal-line-properties":{"type":"java","title":"L_HORIZONTAL_LINE_PROPERTIES_DIALOG"},"horizontal-line-properties-dialog":{"type":"js","functionName":"horizontalLinePropertiesDialog","actionPath":"CustomJSActions","title":"L_HORIZONTAL_LINE_PROPERTIES_DIALOG","elementNames":["hr"]},"insert-object-dialog":{"type":"js","functionName":"insertObjectDialog","actionPath":"CustomJSActions","title":"L_INSERT_OBJECT_DIALOG"},"object-properties-dialog":{"type":"js","functionName":"objectPropertiesDialog","actionPath":"CustomJSActions","title":"L_OBJECT_PROPERTIES_DIALOG","elementNames":["object"]},"object-properties":{"type":"java","title":"L_OBJECT_PROPERTIES_DIALOG"},"insert-table":{"type":"java","title":"L_INSERT_TABLE"},"insert-table-dialog":{"type":"js","functionName":"insertTableDialog","actionPath":"CustomJSActions","title":"L_INSERT_TABLE_DIALOG"},"insert-special-character-dialog":{"type":"js","functionName":"insertSpecialCharacterDialog","actionPath":"CustomJSActions","title":"L_INSERT_SPECIAL_CHARACTER_DIALOG"},"cell-properties":{"type":"java","title":"L_COLUMN_PROPERTIES"},"table-properties":{"type":"java","title":"L_TABLE_PROPERTIES"},"cell-properties-dialog":{"type":"js","functionName":"cellPropertiesDialog","actionPath":"CustomJSActions","title":"L_CELL_PROPERTIES_DIALOG","elementNames":["table","td","th","tr"]},"row-properties-dialog":{"type":"js","functionName":"rowPropertiesDialog","actionPath":"CustomJSActions","title":"L_ROW_PROPERTIES_DIALOG","elementNames":["table","td","th","tr"]},"column-properties":{"type":"java","title":"L_COLUMN_PROPERTIES"},"column-properties-dialog":{"type":"js","functionName":"columnPropertiesDialog","actionPath":"CustomJSActions","title":"L_COLUMN_PROPERTIES_DIALOG","elementNames":["table","td","th","tr"]},"table-properties-dialog":{"type":"js","functionName":"tablePropertiesDialog","actionPath":"CustomJSActions","title":"L_TABLE_PROPERTIES_DIALOG","elementNames":["table","td","th","tr"]},"document-statistics-dialog":{"type":"js","functionName":"documentStatisticsDialog","actionPath":"CustomJSActions","title":"L_DOCUMENT_STATISTICS_DIALOG"},"change-case-dialog":{"type":"js","functionName":"changeCaseDialog","actionPath":"CustomJSActions","title":"L_CHANGE_CASE_DIALOG"},"insert-annotation-dialog":{"type":"js","functionName":"insertAnnotationDialog","actionPath":"CustomJSActions","title":"L_INSERT_ANNOTATION_DIALOG"},"edit-annotation-dialog":{"type":"js","functionName":"editAnnotationDialog","actionPath":"CustomJSActions","title":"L_EDIT_ANNOTATION_DIALOG","elementNames":["annotation"]},"color-dialog":{"type":"js","functionName":"textColorDialog","actionPath":"CustomJSActions","title":"L_COLOR_DIALOG"},"backgroundcolor-dialog":{"type":"js","functionName":"backgroundColorDialog","actionPath":"CustomJSActions","title":"L_BACKGROUNDCOLOR_DIALOG"},"split-cell-dialog":{"type":"js","functionName":"splitCellDialog","actionPath":"CustomJSActions","title":"L_SPLIT_CELL_DIALOG","elementNames":["table","td","th","tr"]},"change-language-dialog":{"type":"js","functionName":"changeLanguageDialog","actionPath":"CustomJSActions","title":"L_CHANGE_LANGUAGE_DIALOG"},"page-properties-dialog":{"type":"js","functionName":"pagePropertiesDialog","actionPath":"CustomJSActions","title":"L_PAGE_PROPERTIES_DIALOG"},"insert-crossreference-dialog":{"type":"js","functionName":"insertCrossreferenceDialog","actionPath":"CustomJSActions","title":"L_INSERT_CROSSREFERENCE_DIALOG"},"edit-crossreference-dialog":{"type":"js","functionName":"editCrossreferenceDialog","actionPath":"CustomJSActions","title":"L_EDIT_CROSSREFERENCE_DIALOG","elementNames":["crossreference"]},"information-dialog":{"type":"java","title":"L_INFORMATION_DIALOG","smallIconURL":"../../lib/icons/information-dialog-small.png"},"insert-special-character-dialog-java":{"type":"java","title":"L_INSERT_SPECIAL_CHARACTER_DIALOG"},"move-up":{"type":"java","title":"L_MOVE_UP","shortcut":"UP"},"move-down":{"type":"java","title":"L_MOVE_DOWN","shortcut":"DOWN"},"move-left":{"type":"java","title":"L_MOVE_LEFT","shortcut":"LEFT"},"move-right":{"type":"java","title":"L_MOVE_RIGHT","shortcut":"RIGHT"},"move-word-left":{"type":"java","title":"L_MOVE_WORD_LEFT","shortcut":"msck LEFT","macShortcut":"alt LEFT"},"move-word-right":{"type":"java","title":"L_MOVE_WORD_RIGHT","shortcut":"msck RIGHT","macShortcut":"alt RIGHT"},"move-next-word":{"type":"java","title":"L_MOVE_NEXT_WORD"},"move-previous-word":{"type":"java","title":"L_MOVE_PREVIOUS_WORD"},"move-next-block":{"type":"java","title":"L_MOVE_NEXT_BLOCK","shortcut":"msck DOWN"},"move-previous-block":{"type":"java","title":"L_MOVE_PREVIOUS_BLOCK","shortcut":"msck UP"},"move-next-page":{"type":"java","title":"L_MOVE_NEXT_PAGE","shortcut":"msck PAGE_DOWN"},"move-previous-page":{"type":"java","title":"L_MOVE_PREVIOUS_PAGE","shortcut":"msck PAGE_UP"},"move-page-start":{"type":"java","title":"L_MOVE_PAGE_START"},"move-page-end":{"type":"java","title":"L_MOVE_PAGE_END"},"move-page-up":{"type":"java","title":"L_MOVE_PAGE_UP","shortcut":"PAGE_UP"},"move-page-down":{"type":"java","title":"L_MOVE_PAGE_DOWN","shortcut":"PAGE_DOWN"},"move-line-start":{"type":"java","title":"L_MOVE_LINE_START","shortcut":"HOME","macShortcut":"meta LEFT"},"move-line-end":{"type":"java","title":"L_MOVE_LINE_END","shortcut":"END","macShortcut":"meta RIGHT"},"move-document-start":{"type":"java","title":"L_MOVE_DOCUMENT_START","shortcut":"msck HOME"},"move-document-end":{"type":"java","title":"L_MOVE_DOCUMENT_END","shortcut":"msck END"},"move-next-table-cell":{"type":"java","title":"L_MOVE_NEXT_TABLE_CELL"},"move-previous-table-cell":{"type":"java","title":"L_MOVE_PREVIOUS_TABLE_CELL"},"row-properties":{"type":"java","title":"L_ROW_PROPERTIES"},"select-up":{"type":"java","title":"L_SELECT_UP","shortcut":"shift UP"},"select-down":{"type":"java","title":"L_SELECT_DOWN","shortcut":"shift DOWN"},"select-left":{"type":"java","title":"L_SELECT_LEFT","shortcut":"shift LEFT"},"select-right":{"type":"java","title":"L_SELECT_RIGHT","shortcut":"shift RIGHT"},"select-line":{"type":"java","title":"L_SELECT_LINE"},"select-line-start":{"type":"java","title":"L_SELECT_LINE_START","shortcut":"shift HOME","macShortcut":"shift meta LEFT"},"select-line-end":{"type":"java","title":"L_SELECT_LINE_END","shortcut":"shift END","macShortcut":"shift meta RIGHT"},"select-page":{"type":"java","title":"L_SELECT_PAGE"},"select-page-start":{"type":"java","title":"L_SELECT_PAGE_START"},"select-page-end":{"type":"java","title":"L_SELECT_PAGE_END"},"select-next-page":{"type":"java","title":"L_SELECT_NEXT_PAGE","shortcut":"msck shift PAGE_DOWN"},"select-previous-page":{"type":"java","title":"L_SELECT_PREVIOUS_PAGE","shortcut":"msck shift PAGE_UP"},"select-page-up":{"type":"java","title":"L_SELECT_PAGE_UP","shortcut":"shift PAGE_UP"},"select-page-down":{"type":"java","title":"L_SELECT_PAGE_DOWN","shortcut":"shift PAGE_DOWN"},"select-document-start":{"type":"java","title":"L_SELECT_DOCUMENT_START","shortcut":"msck shift HOME","macShortcut":"shift HOME"},"select-document-end":{"type":"java","title":"L_SELECT_DOCUMENT_END","shortcut":"msck shift END","macShortcut":"shift END"},"select-word":{"type":"java","title":"L_SELECT_WORD"},"select-word-left":{"type":"java","title":"L_SELECT_WORD_LEFT","shortcut":"msck shift LEFT","macShortcut":"shift alt LEFT"},"select-word-right":{"type":"java","title":"L_SELECT_WORD_RIGHT","shortcut":"msck shift RIGHT","macShortcut":"shift alt RIGHT"},"select-next-word":{"type":"java","title":"L_SELECT_NEXT_WORD"},"select-previous-word":{"type":"java","title":"L_SELECT_PREVIOUS_WORD"},"select-sentence":{"type":"java","title":"L_SELECT_SENTENCE"},"select-block":{"type":"java","title":"L_SELECT_BLOCK"},"select-next-block":{"type":"java","title":"L_SELECT_NEXT_BLOCK","shortcut":"msck shift DOWN","macShortcut":"shift alt DOWN"},"select-previous-block":{"type":"java","title":"L_SELECT_PREVIOUS_BLOCK","shortcut":"msck shift UP","macShortcut":"shift alt UP"},"select-list":{"type":"java","title":"L_SELECT_LIST"},"select-list-item":{"type":"java","title":"L_SELECT_LIST_ITEM"},"select-table":{"type":"java","title":"L_SELECT_TABLE"},"select-table-caption":{"type":"java","title":"L_SELECT_TABLE_CAPTION"},"select-table-row":{"type":"java","title":"L_SELECT_TABLE_ROW"},"select-table-column":{"type":"java","title":"L_SELECT_TABLE_COLUMN"},"select-table-cell":{"type":"java","title":"L_SELECT_TABLE_CELL"},"select-all":{"type":"java","title":"L_SELECT_ALL","shortcut":"msck A"},"scroll-up":{"type":"java","title":"L_SCROLL_UP","shortcut":"msck alt UP"},"scroll-down":{"type":"java","title":"L_SCROLL_DOWN","shortcut":"msck alt DOWN"},"scroll-left":{"type":"java","title":"L_SCROLL_LEFT"},"scroll-right":{"type":"java","title":"L_SCROLL_RIGHT"},"return-key":{"type":"java","title":"L_RETURN_KEY","shortcut":"ENTER"},"delete-backward":{"type":"java","title":"L_BACKSPACE_KEY","shortcut":"BACK_SPACE"},"delete-forward":{"type":"java","title":"L_DELETE_KEY","shortcut":"DELETE"},"tab-key":{"type":"java","title":"L_TAB_KEY","shortcut":"TAB"},"shift-tab-key":{"type":"java","title":"L_SHIFT_TAB_KEY","shortcut":"shift TAB"},"delete-selection":{"type":"java","title":"L_DELETE_SELECTION"},"delete-selection-special":{"type":"java","title":"L_DELETE_SELECTION_SPECIAL"},"delete-tab":{"type":"java","title":"L_DELETE_TABULATOR"},"delete-next-character":{"type":"java","title":"L_DELETE_NEXT_CHARACTER"},"delete-previous-character":{"type":"java","title":"L_DELETE_PREVIOUS_CHARACTER"},"delete-next-paragraph-break":{"type":"java","title":"L_DELETE_NEXT_PARAGRAPH_BREAK"},"delete-previous-paragraph-break":{"type":"java","title":"L_DELETE_PREVIOUS_PARAGRAPH_BREAK"},"delete-block":{"type":"java","title":"L_DELETE_BLOCK"},"insert-tab":{"type":"java","title":"L_INSERT_TABULATOR"},"insert-paragraph-break":{"type":"java","title":"L_INSERT_PARAGRAPH_BREAK"},"insert-list-item-break":{"type":"java","title":"L_INSERT_LIST_ITEM_BREAK"},"insert-next-element-template":{"type":"java","title":"L_INSERT_NEXT_ELEMENT_TEMPLATE"},"insert-paragraph-before-block":{"type":"java","title":"L_INSERT_PARAGRAPH_BEFORE_BLOCK"},"insert-paragraph-after-block":{"type":"java","title":"L_INSERT_PARAGRAPH_AFTER_BLOCK"},"insert-paragraph-before-container":{"type":"java","title":"L_INSERT_PARAGRAPH_BEFORE_CONTAINER"},"insert-paragraph-after-container":{"type":"java","title":"L_INSERT_PARAGRAPH_AFTER_CONTAINER"},"insert-paragraph-before-list":{"type":"java","title":"L_INSERT_PARAGRAPH_BEFORE_LIST"},"insert-paragraph-after-list":{"type":"java","title":"L_INSERT_PARAGRAPH_AFTER_LIST"},"insert-paragraph-before-table":{"type":"java","title":"L_INSERT_PARAGRAPH_BEFORE_TABLE"},"insert-paragraph-after-table":{"type":"java","title":"L_INSERT_PARAGRAPH_AFTER_TABLE"},"cut":{"type":"java","title":"L_CUT","shortcut":"msck X"},"copy":{"type":"java","title":"L_COPY","shortcut":"msck C"},"paste":{"type":"java","title":"L_PASTE","shortcut":"msck V"},"canvas-background":{"type":"java","title":"L_CANVAS_BACKGROUND"},"toggle-show-semantic-elements":{"type":"java","title":"L_TOGGLE_SHOW_SEMANTIC_ELEMENTS"},"toggle-show-marks":{"type":"java","title":"L_TOGGLE_SHOW_MARKS"},"toggle-show-table-grid":{"type":"java","title":"L_TOGGLE_SHOW_TABLE_GRID"},"toggle-show-container-grid":{"type":"java","title":"L_TOGGLE_SHOW_CONTAINER_GRID"},"zoom":{"type":"java","title":"L_ZOOM"},"zoom-10":{"type":"java","title":"L_ZOOM_10"},"zoom-25":{"type":"java","title":"L_ZOOM_25"},"zoom-50":{"type":"java","title":"L_ZOOM_50"},"zoom-75":{"type":"java","title":"L_ZOOM_75"},"zoom-100":{"type":"java","title":"L_ZOOM_100","shortcut":"msck NUMPAD0"},"zoom-125":{"type":"java","title":"L_ZOOM_125"},"zoom-150":{"type":"java","title":"L_ZOOM_150"},"zoom-175":{"type":"java","title":"L_ZOOM_175"},"zoom-200":{"type":"java","title":"L_ZOOM_200"},"zoom-300":{"type":"java","title":"L_ZOOM_300"},"zoom-400":{"type":"java","title":"L_ZOOM_400"},"zoom-500":{"type":"java","title":"L_ZOOM_500"},"increase-zoom":{"type":"java","title":"L_INCREASE_ZOOM","shortcut":"msck ADD","macShortcut":"meta QUOTE"},"decrease-zoom":{"type":"java","title":"L_DECREASE_ZOOM","shortcut":"msck SUBTRACT","macShortcut":"meta SEMICOLON"},"zoom-mode":{"type":"java","title":"L_ZOOM_MODE"},"zoom-mode-user-defined":{"type":"java","title":"L_ZOOM_MODE_USER_DEFINED"},"zoom-mode-window-width":{"type":"java","title":"L_ZOOM_MODE_WINDOW_WIDTH"},"zoom-mode-window-height":{"type":"java","title":"L_ZOOM_MODE_WINDOW_HEIGHT"},"text-size":{"type":"java","title":"L_TEXT_SIZE"},"text-size-large":{"type":"java","title":"L_TEXT_SIZE_LARGE"},"text-size-normal":{"type":"java","title":"L_TEXT_SIZE_NORMAL"},"text-size-small":{"type":"java","title":"L_TEXT_SIZE_SMALL"},"increase-text-size":{"type":"java","title":"L_INCREASE_TEXT_SIZE"},"decrease-text-size":{"type":"java","title":"L_DECREASE_TEXT_SIZE"},"page-mode":{"type":"java","title":"L_PAGE_MODE"},"page-mode-continuous":{"type":"java","title":"L_PAGE_MODE_CONTINUOUS"},"page-mode-single-sided":{"type":"java","title":"L_PAGE_MODE_SINGLE_SIDED"},"page-mode-double-sided":{"type":"java","title":"L_PAGE_MODE_DOUBLE_SIDED"},"increase-page-index":{"type":"java","title":"L_INCREASE_PAGE_INDEX"},"decrease-page-index":{"type":"java","title":"L_DECREASE_PAGE_INDEX"},"refresh-all":{"type":"java","title":"L_REFRESH_ALL","shortcut":"msck R","macShortcut":"F5"},"refresh-boxes":{"type":"java","title":"L_REFRESH_BOXES"},"refresh-style":{"type":"java","title":"L_REFRESH_STYLE"},"refresh-layout":{"type":"java","title":"L_REFRESH_LAYOUT"},"refresh-position":{"type":"java","title":"L_REFRESH_POSITION"},"toggle-auto-spellcheck":{"type":"java","title":"L_TOGGLE_AUTO_SPELLCHECK"},"remove-annotation":{"type":"java","title":"L_REMOVE_ANNOTATION"},"show-annotations-disabled":{"type":"java","title":"L_SHOW_ANNOTATIONS_DISABLED"},"show-annotations-inline":{"type":"java","title":"L_SHOW_ANNOTATIONS_INLINE"},"show-annotations-bubbles":{"type":"java","title":"L_SHOW_ANNOTATIONS_BUBBLES"},"bold":{"type":"java","title":"L_BOLD","shortcut":"msck B"},"italic":{"type":"java","title":"L_ITALIC","shortcut":"msck I"},"underline":{"type":"java","title":"L_UNDERLINE","shortcut":"msck U"},"strikethrough":{"type":"java","title":"L_STRIKETHROUGH"},"script-super":{"type":"java","title":"L_SCRIPT_SUPER"},"script-sub":{"type":"java","title":"L_SCRIPT_SUB"},"font-family":{"type":"java","title":"L_FONT_FAMILY"},"font-family-default":{"type":"java","title":"L_FONT_FAMILY_DEFAULT"},"font-family-serif":{"type":"java","title":"L_FONT_FAMILY_SERIF"},"font-family-sans-serif":{"type":"java","title":"L_FONT_FAMILY_SANS_SERIF"},"font-family-cursive":{"type":"java","title":"L_FONT_FAMILY_CURSIVE"},"font-family-fantasy":{"type":"java","title":"L_FONT_FAMILY_FANTASY"},"font-family-monospace":{"type":"java","title":"L_FONT_FAMILY_MONOSPACE"},"font-size":{"type":"java","title":"L_FONT_SIZE"},"font-size-default":{"type":"java","title":"L_FONT_SIZE_DEFAULT"},"font-size-8":{"type":"java","title":"L_FONT_SIZE_8"},"font-size-9":{"type":"java","title":"L_FONT_SIZE_9"},"font-size-10":{"type":"java","title":"L_FONT_SIZE_10"},"font-size-11":{"type":"java","title":"L_FONT_SIZE_11"},"font-size-12":{"type":"java","title":"L_FONT_SIZE_12"},"font-size-14":{"type":"java","title":"L_FONT_SIZE_14"},"font-size-16":{"type":"java","title":"L_FONT_SIZE_16"},"font-size-18":{"type":"java","title":"L_FONT_SIZE_18"},"font-size-20":{"type":"java","title":"L_FONT_SIZE_20"},"font-size-22":{"type":"java","title":"L_FONT_SIZE_22"},"font-size-24":{"type":"java","title":"L_FONT_SIZE_24"},"font-size-26":{"type":"java","title":"L_FONT_SIZE_26"},"font-size-28":{"type":"java","title":"L_FONT_SIZE_28"},"font-size-36":{"type":"java","title":"L_FONT_SIZE_36"},"font-size-48":{"type":"java","title":"L_FONT_SIZE_48"},"font-size-72":{"type":"java","title":"L_FONT_SIZE_72"},"increase-font-size":{"type":"java","title":"L_INCREASE_FONT_SIZE"},"decrease-font-size":{"type":"java","title":"L_DECREASE_FONT_SIZE"},"color":{"type":"java","title":"L_COLOR"},"color-default":{"type":"java","title":"L_COLOR_DEFAULT"},"color-white":{"type":"java","title":"L_COLOR_WHITE"},"color-silver":{"type":"java","title":"L_COLOR_SILVER"},"color-gray":{"type":"java","title":"L_COLOR_GRAY"},"color-black":{"type":"java","title":"L_COLOR_BLACK"},"color-navy":{"type":"java","title":"L_COLOR_NAVY"},"color-blue":{"type":"java","title":"L_COLOR_BLUE"},"color-aqua":{"type":"java","title":"L_COLOR_AQUA"},"color-teal":{"type":"java","title":"L_COLOR_TEAL"},"color-purple":{"type":"java","title":"L_COLOR_PURPLE"},"color-fuchsia":{"type":"java","title":"L_COLOR_FUCHSIA"},"color-lime":{"type":"java","title":"L_COLOR_LIME"},"color-green":{"type":"java","title":"L_COLOR_GREEN"},"color-maroon":{"type":"java","title":"L_COLOR_MAROON"},"color-red":{"type":"java","title":"L_COLOR_RED"},"color-orange":{"type":"java","title":"L_COLOR_ORANGE"},"color-yellow":{"type":"java","title":"L_COLOR_YELLOW"},"color-olive":{"type":"java","title":"L_COLOR_OLIVE"},"background-color":{"type":"java","title":"L_BACKGROUND_COLOR"},"background-color-default":{"type":"java","title":"L_BACKGROUND_COLOR_DEFAULT"},"background-color-white":{"type":"java","title":"L_BACKGROUND_COLOR_WHITE"},"background-color-silver":{"type":"java","title":"L_BACKGROUND_COLOR_SILVER"},"background-color-gray":{"type":"java","title":"L_BACKGROUND_COLOR_GRAY"},"background-color-black":{"type":"java","title":"L_BACKGROUND_COLOR_BLACK"},"background-color-navy":{"type":"java","title":"L_BACKGROUND_COLOR_NAVY"},"background-color-blue":{"type":"java","title":"L_BACKGROUND_COLOR_BLUE"},"background-color-aqua":{"type":"java","title":"L_BACKGROUND_COLOR_AQUA"},"background-color-teal":{"type":"java","title":"L_BACKGROUND_COLOR_TEAL"},"background-color-purple":{"type":"java","title":"L_BACKGROUND_COLOR_PURPLE"},"background-color-fuchsia":{"type":"java","title":"L_BACKGROUND_COLOR_FUCHSIA"},"background-color-lime":{"type":"java","title":"L_BACKGROUND_COLOR_LIME"},"background-color-green":{"type":"java","title":"L_BACKGROUND_COLOR_GREEN"},"background-color-maroon":{"type":"java","title":"L_BACKGROUND_COLOR_MAROON"},"background-color-red":{"type":"java","title":"L_BACKGROUND_COLOR_RED"},"background-color-orange":{"type":"java","title":"L_BACKGROUND_COLOR_ORANGE"},"background-color-yellow":{"type":"java","title":"L_BACKGROUND_COLOR_YELLOW"},"background-color-olive":{"type":"java","title":"L_BACKGROUND_COLOR_OLIVE"},"block-indent":{"type":"java","title":"L_BLOCK_INDENT"},"increase-block-indent":{"type":"java","title":"L_INCREASE_BLOCK_INDENT"},"decrease-block-indent":{"type":"java","title":"L_DECREASE_BLOCK_INDENT"},"paragraph":{"type":"java","title":"L_STYLE_TEMPLATE_PARAGRAPH"},"heading-1":{"type":"java","title":"L_STYLE_TEMPLATE_HEADING1","shortcut":"msck 1","macShortcut":"alt F1"},"heading-2":{"type":"java","title":"L_STYLE_TEMPLATE_HEADING2","shortcut":"msck 2","macShortcut":"alt F2"},"heading-3":{"type":"java","title":"L_STYLE_TEMPLATE_HEADING3","shortcut":"msck 3","macShortcut":"alt F3"},"heading-4":{"type":"java","title":"L_STYLE_TEMPLATE_HEADING4","shortcut":"msck 4","macShortcut":"alt F4"},"heading-5":{"type":"java","title":"L_STYLE_TEMPLATE_HEADING5","shortcut":"msck 5","macShortcut":"alt F5"},"heading-6":{"type":"java","title":"L_STYLE_TEMPLATE_HEADING6","shortcut":"msck 6","macShortcut":"alt F6"},"style-template-formatted":{"type":"java","title":"L_STYLE_TEMPLATE_FORMATTED"},"align":{"type":"java","title":"L_ALIGN"},"align-default":{"type":"java","title":"L_ALIGN_DEFAULT"},"align-left":{"type":"java","title":"L_ALIGN_LEFT"},"align-center":{"type":"java","title":"L_ALIGN_CENTER"},"align-right":{"type":"java","title":"L_ALIGN_RIGHT"},"align-justify":{"type":"java","title":"L_ALIGN_JUSTIFY"},"insert-container":{"type":"java","title":"L_INSERT_CONTAINER"},"delete-container":{"type":"java","title":"L_DELETE_CONTAINER"},"split-container":{"type":"java","title":"L_SPLIT_CONTAINER"},"merge-container":{"type":"java","title":"L_MERGE_CONTAINER"},"select-container":{"type":"java","title":"L_SELECT_CONTAINER"},"list":{"type":"java","title":"L_LIST"},"list-default":{"type":"java","title":"L_LIST_DEFAULT"},"list-ordered":{"type":"java","title":"L_LIST_ORDERED"},"list-unordered":{"type":"java","title":"L_LIST_UNORDERED"},"increase-list-indent":{"type":"java","title":"L_INCREASE_LIST_INDENT"},"decrease-list-indent":{"type":"java","title":"L_DECREASE_LIST_INDENT"},"increase-list-level":{"type":"java","title":"L_INCREASE_LIST_LEVEL"},"decrease-list-level":{"type":"java","title":"L_DECREASE_LIST_LEVEL"},"disable-list-level":{"type":"java","title":"L_DISABLE_LIST"},"insert-row-before":{"type":"java","title":"L_INSERT_ROW_BEFORE"},"insert-row-after":{"type":"java","title":"L_INSERT_ROW_AFTER"},"insert-column-before":{"type":"java","title":"L_INSERT_COLUMN_BEFORE"},"insert-column-after":{"type":"java","title":"L_INSERT_COLUMN_AFTER"},"delete-table":{"type":"java","title":"L_DELETE_TABLE"},"delete-row":{"type":"java","title":"L_DELETE_ROW"},"delete-column":{"type":"java","title":"L_DELETE_COLUMN"},"split-table":{"type":"java","title":"L_SPLIT_TABLE"},"merge-table":{"type":"java","title":"L_MERGE_TABLE"},"table-cell-valign":{"type":"java","title":"L_TABLE_CELL_VALIGN"},"table-cell-valign-default":{"type":"java","title":"L_TABLE_CELL_VALIGN_DEFAULT"},"table-cell-valign-top":{"type":"java","title":"L_TABLE_CELL_VALIGN_TOP"},"table-cell-valign-middle":{"type":"java","title":"L_TABLE_CELL_VALIGN_MIDDLE"},"table-cell-valign-bottom":{"type":"java","title":"L_TABLE_CELL_VALIGN_BOTTOM"},"table-cell-valign-baseline":{"type":"java","title":"L_TABLE_CELL_VALIGN_BASELINE"},"increase-indent":{"type":"java","title":"L_INCREASE_INDENT"},"decrease-indent":{"type":"java","title":"L_DECREASE_INDENT"},"convert-table":{"type":"java","title":"L_CONVERT_TABLE"},"auto-fit-table-content":{"type":"java","title":"L_AUTO_FIT_TABLE_CONTENT"},"find-next":{"type":"java","title":"L_FIND_NEXT","shortcut":"msck G"},"find-previous":{"type":"java","title":"L_FIND_PREVIOUS","shortcut":"msck shift G"},"insert-horizontal-line":{"type":"java","title":"L_INSERT_HORIZONTAL_LINE"},"insert-line-break":{"type":"java","title":"L_INSERT_LINE_BREAK"},"insert-page-break":{"type":"java","title":"L_INSERT_PAGE_BREAK","shortcut":"msck ENTER"},"insert-nbsp":{"type":"java","title":"L_INSERT_NBSP","shortcut":"msck shift SPACE","macShortcut":"alt SPACE"},"insert-soft-hyphen":{"type":"java","title":"L_INSERT_SOFT_HYPHEN"},"insert-non-breaking-hyphen":{"type":"java","title":"L_INSERT_NON_BREAKING_HYPHEN","shortcut":"msck shift MINUS"},"insert-date":{"type":"java","title":"L_INSERT_DATE","shortcut":"msck shift D"},"insert-table-caption":{"type":"java","title":"L_INSERT_TABLE_CAPTION"},"delete-table-caption":{"type":"java","title":"L_DELETE_TABLE_CAPTION"},"goto-page":{"type":"java","title":"L_GOTO_PAGE"},"merge-cells":{"type":"java","title":"L_MERGE_CELLS"},"language":{"type":"java","title":"L_LANGUAGE"},"language-default":{"type":"java","title":"L_LANGUAGE_DEFAULT"},"language-none":{"type":"java","title":"L_LANGUAGE_NONE"},"language-american-english":{"type":"java","title":"L_LANGUAGE_AMERICAN_ENGLISH"},"language-american-legal":{"type":"java","title":"L_LANGUAGE_AMERICAN_LEGAL"},"language-american-medical":{"type":"java","title":"L_LANGUAGE_AMERICAN_MEDICAL"},"language-brazilian-portuguese":{"type":"java","title":"L_LANGUAGE_BRAZILIAN_PORTUGUESE"},"language-british-english":{"type":"java","title":"L_LANGUAGE_BRITISH_ENGLISH"},"language-british-legal":{"type":"java","title":"L_LANGUAGE_BRITISH_LEGAL"},"language-british-medical":{"type":"java","title":"L_LANGUAGE_BRITISH_MEDICAL"},"language-canadian-english":{"type":"java","title":"L_LANGUAGE_CANADIAN_ENGLISH"},"language-danish":{"type":"java","title":"L_LANGUAGE_DANISH"},"language-dutch":{"type":"java","title":"L_LANGUAGE_DUTCH"},"language-finnish":{"type":"java","title":"L_LANGUAGE_FINNISH"},"language-french":{"type":"java","title":"L_LANGUAGE_FRENCH"},"language-german":{"type":"java","title":"L_LANGUAGE_GERMAN"},"language-italian":{"type":"java","title":"L_LANGUAGE_ITALIAN"},"language-norwegian":{"type":"java","title":"L_LANGUAGE_NORWEGIAN"},"language-portuguese":{"type":"java","title":"L_LANGUAGE_PORTUGUESE"},"language-spanish":{"type":"java","title":"L_LANGUAGE_SPANISH"},"language-swedish":{"type":"java","title":"L_LANGUAGE_SWEDISH"},"get-webdav-image":{"type":"java","title":"L_GET_WEBDAV_IMAGE"},"get-webdav-object":{"type":"java","title":"L_GET_WEBDAV_OBJECT"},"get-webdav-document":{"type":"java","title":"L_GET_WEBDAV_DOCUMENT"},"get-webdav-hyperlink":{"type":"java","title":"L_GET_WEBDAV_HYPERLINK"},"insert-webdav-hyperlink":{"type":"java","title":"L_INSERT_HYPERLINK_DIALOG"},"insert-webdav-image":{"type":"java","title":"L_INSERT_IMAGE_DIALOG"},"upload-image":{"type":"java","title":"L_UPLOAD_IMAGE"},"upload-document-all":{"type":"java","title":"L_UPLOAD_DOCUMENT_ALL"},"upload-document":{"type":"java","title":"L_UPLOAD_DOCUMENT"},"upload-object":{"type":"java","title":"L_UPLOAD_OBJECT"},"undo":{"type":"java","title":"L_UNDO","smallIconURL":"../../lib/icons/undo-small.png"},"redo":{"type":"java","title":"L_REDO","smallIconURL":"../../lib/icons/redo-small.png"},"spellcheck-dialog":{"type":"java","title":"L_SPELLCHECKDIALOG_TITLE"},"thesaurus-dialog":{"type":"java","title":"L_THESAURUSDIALOG_TITLE"},"save-document":{"type":"java","title":"L_SAVE_DOCUMENT","smallIconURL":"../../lib/icons/save-document-small.png"},"save-document-as-dialog":{"type":"java","title":"L_SAVE_DOCUMENT_AS_DIALOG","smallIconURL":"../../lib/icons/save-document-as-dialog-small.png"},"find-replace-dialog":{"type":"java","title":"L_FIND_REPLACE_DIALOG"},"list-properties-dialog":{"type":"java","title":"L_LIST_PROPERTIES_DIALOG"},"auto-correct-dialog":{"type":"java","title":"L_AUTO_CORRECT_DIALOG"},"open-file-dialog":{"type":"java","title":"L_OPEN_FILE_DIALOG"},"insert-hyperlink":{"type":"java","title":"L_INSERT_HYPERLINK_DIALOG"},"split-cell":{"type":"java","title":"L_SPLIT_CELL_DIALOG"},"paste-special-dialog":{"type":"java","title":"L_PASTE_SPECIAL_DIALOG"},"insert-annotation":{"type":"java","title":"L_INSERT_ANNOTATION_DIALOG"},"edit-annotation":{"type":"java","title":"L_EDIT_ANNOTATION_DIALOG"},"change-case":{"type":"java","title":"L_CHANGE_CASE_DIALOG"},"new-document":{"type":"java","title":"L_NEW_DOCUMENT","smallIconURL":"../../lib/icons/new-document-small.png"},"toggle-source-view":{"type":"java","title":"L_SOURCE_VIEW"},"print":{"type":"java","title":"L_PRINT"},"show-in-browser":{"type":"java","title":"L_SHOW_IN_BROWSER"},"clear-formatting":{"type":"java","title":"L_CLEAR_FORMATTING","shortcut":"msck SPACE"},"live-fragment-language":{"type":"java","title":"L_LIVE_FRAGMENT_LANGUAGE"},"live-document-language":{"type":"java","title":"L_LIVE_DOCUMENT_LANGUAGE"}};this.getActionMap=function(){return this.actionMap;}}
eongApplication.customJSActions=function(){this.insertStructureTemplateDialog=function(dialogJSObj){var html=dialogJSObj.Helper.DialogHTMLMap["insertStructureTemplate"];cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,dialogJSObj.Helper.LocaleObject.L_INSERT_STRUCTURE_TEMPLATE_DIALOG);var tree=dialogJSObj.Helper.parseStructureTemplates();jQuery("#templateTree_"+cId).append(tree);jQuery("#templateTree_"+cId+" > ul").treeview({collapsed:true,unique:false});jQuery("ul.fileList:empty").parent("ul").parent("li").remove();jQuery("li.templateFile").bind("dblclick",function(){var url=jQuery(this).attr("name");dialogJSObj.insertContentFromURL(url);dialogJSObj.Helper.hideDialog();});jQuery("li.templateFile").bind("click",function(){jQuery("li.templateFile span").css({"background-color":"transparent","color":"black"});jQuery(this).children("span").css({"background-color":"blue","color":"white"});jQuery("li.templateFile").removeClass("selectedTemplateItem")
jQuery(this).addClass("selectedTemplateItem");});jQuery("div.ui-tooltip").remove();jQuery("li.templateFile span").each(function(){jQuery(this).tooltip({content:function(){return jQuery(this).next().html();}});});jQuery("li.templateFile").first().addClass("selectedTemplateItem").children("span").css({"background-color":"blue","color":"white"});var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CLOSE_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
buttons[dialogJSObj.Helper.LocaleObject.L_INSERT_BUTTON]=function(){var url=jQuery("li.selectedTemplateItem").attr("name")
dialogJSObj.insertContentFromURL(url);dialogJSObj.Helper.hideDialog();}
jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);dialogJSObj.Helper.showDialog();dialogJSObj.Helper.dialogCreateTabs();}
this.insertBookmarkDialog=function(dialogJSObj){var bookmarkProperties=dialogJSObj.Helper.jsWrapperObj.getBookmarkProperties();var existingBookmark="";if(bookmarkProperties!==""){bookmarkProperties=jQuery.evalJSON(bookmarkProperties);existingBookmark=bookmarkProperties["name"];}
if(existingBookmark!=undefined&&existingBookmark!=""){this.bookmarkPropertiesDialog(dialogJSObj);return;}
var html=dialogJSObj.Helper.DialogHTMLMap["insertBookmark"];cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,dialogJSObj.Helper.LocaleObject.L_INSERT_BOOKMARK_DIALOG);bookmarkList=dialogJSObj.getBookmarkList();if(bookmarkList!==null){for(i=0;i<bookmarkList.length;i++){var option="";var classContent="";var value=bookmarkList[i];if(i===0){classContent=" class='ui-selected' ";}
if(value!==undefined){option="<li "+classContent+" name=\""+value+"\">"+value+"</li>";}
jQuery("#bookmark_blockelements_"+cId).append(option);jQuery("#bookmark_blockelements_"+cId+" li").bind("click",function(){jQuery(this).siblings().removeClass("ui-selected");jQuery(this).addClass("ui-selected");jQuery("#bookmark_text_field_"+cId).val(jQuery(this).attr("name"));});}}
jQuery("#go_to_bookmark_button_"+cId).bind("click",function(){var bookmarkName=jQuery("#bookmark_text_field_"+cId).val();if(bookmarkName!==undefined){dialogJSObj.setEnabled(true);dialogJSObj.invokeAction("move-to-bookmark",bookmarkName);}else{}});var addButton=jQuery("#add_bookmark_button_"+cId);addButton.bind("click",function(){var bookmarkName=jQuery("#bookmark_text_field_"+cId).val();if(bookmarkName!==undefined){boomarkName=jQuery.trim(bookmarkName);dialogJSObj.setEnabled(true);dialogJSObj.invokeAction("insert-bookmark",bookmarkName);dialogJSObj.Helper.hideDialog();}else{}});var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CLOSE_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);verifyBookmark=function(){var text=jQuery.trim(jQuery("#bookmark_text_field_"+cId).val());var validBookmark=dialogJSObj.Helper.jsWrapperObj.isIdValidAndAvailable(text);if(text!==jQuery(this).attr("name")&&validBookmark){addButton.removeAttr("disabled");addButton.removeClass("ui-state-disabled");}
else{addButton.attr("disabled","disabled");addButton.addClass("ui-state-disabled");}
if(validBookmark){jQuery("#bookmark_invalid_id_"+cId).css("display","none");}else if(text!==""){jQuery("#bookmark_invalid_id_"+cId).css("display","inline");}}
jQuery("#bookmark_text_field_"+cId).bind("keyup",function(){if(jQuery("#bookmark_blockelements_"+cId+" li").length>0){jQuery("#bookmark_blockelements_"+cId+" li").filter(verifyBookmark);}else{verifyBookmark();}});dialogJSObj.Helper.showDialog();addButton.attr("disabled","disabled");addButton.addClass("ui-state-disabled");dialogJSObj.Helper.dialogCreateTabs();}
this.bookmarkPropertiesDialog=function(dialogJSObj){var bookmarkProperties=dialogJSObj.Helper.jsWrapperObj.getBookmarkProperties();var existingBookmark="";if(bookmarkProperties!==""){bookmarkProperties=jQuery.evalJSON(bookmarkProperties);existingBookmark=bookmarkProperties["name"];}
var html=dialogJSObj.Helper.DialogHTMLMap["insertBookmark"];cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,dialogJSObj.Helper.LocaleObject.L_BOOKMARK_PROPERTIES_DIALOG);if(existingBookmark!=undefined&&existingBookmark!=""){jQuery("#bookmark_text_field_"+cId).val(existingBookmark);}
bookmarkList=dialogJSObj.getBookmarkList();if(bookmarkList!==null){for(i=0;i<bookmarkList.length;i++){var option="";var classContent="";var value=bookmarkList[i];if(i===0){classContent=" class='ui-selected' ";}
if(value!==undefined){option="<li "+classContent+" name=\""+value+"\">"+value+"</li>";}
jQuery("#bookmark_blockelements_"+cId).append(option);jQuery("#bookmark_blockelements_"+cId+" li").bind("click",function(){jQuery(this).siblings().removeClass("ui-selected");jQuery(this).addClass("ui-selected");jQuery("#bookmark_text_field_"+cId).val(jQuery(this).attr("name"));});}}
jQuery("#go_to_bookmark_button_"+cId).bind("click",function(){var bookmarkName=jQuery("#bookmark_text_field_"+cId).val();if(bookmarkName!==undefined){dialogJSObj.setEnabled(true);dialogJSObj.invokeAction("move-to-bookmark",bookmarkName);}else{}});var addButton=jQuery("#add_bookmark_button_"+cId);addButton.bind("click",function(){var bookmarkName=jQuery("#bookmark_text_field_"+cId).val();if(bookmarkName!==undefined){boomarkName=jQuery.trim(bookmarkName);dialogJSObj.setEnabled(true);dialogJSObj.invokeAction("insert-bookmark",bookmarkName);dialogJSObj.Helper.hideDialog();}else{}});var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CLOSE_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);verifyBookmark=function(){var text=jQuery.trim(jQuery("#bookmark_text_field_"+cId).val());var validBookmark=dialogJSObj.Helper.jsWrapperObj.isIdValidAndAvailable(text);if(text!==jQuery(this).attr("name")&&validBookmark){addButton.removeAttr("disabled");addButton.removeClass("ui-state-disabled");}
else{addButton.attr("disabled","disabled");addButton.addClass("ui-state-disabled");}
if(validBookmark){jQuery("#bookmark_invalid_id_"+cId).css("display","none");}else if(text!==""){jQuery("#bookmark_invalid_id_"+cId).css("display","inline");}}
jQuery("#bookmark_text_field_"+cId).bind("keyup",function(){if(jQuery("#bookmark_blockelements_"+cId+" li").length>0){jQuery("#bookmark_blockelements_"+cId+" li").filter(verifyBookmark);}else{verifyBookmark();}});dialogJSObj.Helper.showDialog();addButton.attr("disabled","disabled");addButton.addClass("ui-state-disabled");dialogJSObj.Helper.dialogCreateTabs();}
this.insertHyperlinkDialog=function(dialogJSObj){var bookmarkProperties=dialogJSObj.Helper.jsWrapperObj.getBookmarkProperties();var existingBookmark="";if(bookmarkProperties!==""){bookmarkProperties=jQuery.evalJSON(bookmarkProperties);existingBookmark=bookmarkProperties["name"];}
var currentElement=dialogJSObj.getCurrentElement();var hyperlinkText="";var hyperlinkProperties=dialogJSObj.Helper.jsWrapperObj.getHyperlinkProperties();if(hyperlinkProperties!==""){hyperlinkProperties=jQuery.evalJSON(hyperlinkProperties);hyperlinkText=hyperlinkProperties["text"];if(hyperlinkProperties["href"]!==undefined){this.linkPropertiesDialog(dialogJSObj);return;}}
var html=dialogJSObj.Helper.DialogHTMLMap["insertHyperlink"];cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,dialogJSObj.Helper.LocaleObject.L_INSERT_HYPERLINK_DIALOG);if(existingBookmark!=undefined&&existingBookmark!==""){jQuery("#bookmark_text_field_"+cId).val(existingBookmark);}
if(hyperlinkText!==undefined&&hyperlinkText!==""){jQuery("#hyperlink_text_field_"+cId).val(hyperlinkText);}
bookmarkList=dialogJSObj.getBookmarkList();if(bookmarkList!==null){for(i=0;i<bookmarkList.length;i++){var option="";var classContent="";var value=bookmarkList[i];if(i===0){classContent=" class='ui-selected' ";}
if(value!==undefined){option="<li "+classContent+" name=\""+value+"\">"+value+"</li>";}
jQuery("#bookmark_blockelements_"+cId).append(option);jQuery("#bookmark_blockelements_"+cId+" li").bind("click",function(){jQuery(this).siblings().removeClass("ui-selected");jQuery(this).addClass("ui-selected");jQuery("#bookmark_text_field_"+cId).val("#"+jQuery(this).attr("name"));});}}
dialogJSObj.Helper.bindOpenFileDialog("#hyperlink_open_file_button_"+cId,"#hyperlink_url_field_"+cId,null);dialogJSObj.Helper.bindOpenWebdavDialog("#link_open_webdav_button_"+cId,"#hyperlink_url_field_"+cId,"get-webdav-hyperlink");if(!dialogJSObj.isActionEnabled("get-webdav-hyperlink")){jQuery("#link_open_webdav_button_"+cId).hide();}
values=dialogJSObj.Helper.getUserPreferences("inserthyperlinkdialog");if(values!==null){jQuery("#hyperlink_url_field_"+cId).attr({value:values.href});if(values.target!=""){jQuery("#targetChooser_"+cId).val(values.target);}
jQuery("#hyperlink_title_field_"+cId).attr({value:values.title});}
var tabs;var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CANCEL_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
buttons[dialogJSObj.Helper.LocaleObject.L_INSERT_BUTTON]=function(){currTab=tabs.tabs('option','selected');var externalURL=jQuery("#hyperlink_url_field_"+cId).val();var target=jQuery("#targetChooser_"+cId).val();var title=jQuery("#hyperlink_title_field_"+cId).val();var text=jQuery.trim(jQuery("#hyperlink_text_field_"+cId).val());var bookmarkURL=jQuery("#bookmark_text_field_"+cId).val();var insertURL="";if(currTab==0){insertURL=externalURL;}else if(currTab==1){insertURL=bookmarkURL;}
if(insertURL!==undefined&&insertURL!==""){json={};if(title!==""){json.title=title;}
if(target!==""){json.target=target;}
if(text!==""){json.text=text;}else{json.text=insertURL;}
json.href=insertURL;dialogJSObj.Helper.setUserPreferences({"inserthyperlinkdialog":json});json=jQuery.toJSON(json);dialogJSObj.setEnabled(true);dialogJSObj.invokeAction("insert-hyperlink",json);dialogJSObj.Helper.hideDialog();}else{jQuery("#no_hyperlink_"+cId).show();}}
jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);dialogJSObj.Helper.showDialog();tabs=jQuery("#insertHyperlinkTabContainer_"+cId).tabs()
dialogJSObj.Helper.dialogCreateTabs();};this.fillReferenceElementsList=function(elements){var referenceElementList=jQuery("#reference_blockelements_"+cId);var parent=referenceElementList.parent();parent.detach(referenceElementList);referenceElementList.html("");jQuery.each(elements,function(i,element){var elementOption=jQuery("<li name=\""+i+"\">"+element+"</li>");elementOption.bind("click",function(){jQuery(this).siblings().removeClass("ui-selected");jQuery(this).addClass("ui-selected");});if(i===0){elementOption.addClass("ui-selected");}
referenceElementList.append(elementOption);});parent.append(referenceElementList);}
this.insertCrossreferenceDialog=function(dialogJSObj){var isEdit=(dialogJSObj.getObj().isCrossReferenceSelected()==="true");var dialogHTMLMapString;var localizedDialogTitle;if(isEdit){dialogHTMLMapString="insertCrossreference";localizedDialogTitle=dialogJSObj.Helper.LocaleObject.L_EDIT_CROSSREFERENCE_DIALOG;}
else{dialogHTMLMapString="insertCrossreference";localizedDialogTitle=dialogJSObj.Helper.LocaleObject.L_INSERT_CROSSREFERENCE_DIALOG;}
var html=dialogJSObj.Helper.DialogHTMLMap[dialogHTMLMapString];cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,localizedDialogTitle);var uiData=null;var json=dialogJSObj.getObj().getCrossReferenceBlockList();if(json!==""){uiData=jQuery.evalJSON(json);}
var i=0;var obj=this;var elementTypesList=jQuery("#reference_element_types_"+cId);jQuery.each(uiData,function(elementType,elements){var elementTypeOption=jQuery("<li name=\""+i+"\">"+elementType+"</li>");elementTypeOption.bind("click",{msg:elements},function(event){var elements=event.data.msg;jQuery(this).siblings().removeClass("ui-selected");jQuery(this).addClass("ui-selected");obj.fillReferenceElementsList(elements);});if(i===0){elementTypeOption.addClass("ui-selected");obj.fillReferenceElementsList(elements);}
elementTypesList.append(elementTypeOption);i++;});if(isEdit){var referenceProperties=jQuery.evalJSON(dialogJSObj.getObj().getCurrentCrossReferenceProperties());if(referenceProperties!=="null"&&referenceProperties!==undefined&&referenceProperties!==""){var elementTypeIndex=referenceProperties.elementTypeIndex;var referenceElementIndex=referenceProperties.referenceElementIndex;var insertedContentType=referenceProperties.insertedContentType;var insertAsHyperlink=referenceProperties.insertAsHyperlink;var elementTypesList=jQuery("#reference_element_types_"+cId);var elementTypeOption=elementTypesList.children("[name=\""+elementTypeIndex+"\"]");elementTypeOption.click();var referenceElementList=jQuery("#reference_blockelements_"+cId);var referenceElementOption=referenceElementList.children("[name=\""+referenceElementIndex+"\"]");referenceElementOption.click();jQuery("input[name='source_radio_"+cId+"'][value='"+insertedContentType+"']").attr("checked","true");if(insertAsHyperlink===true){jQuery("#reference_options_hyperlink_"+cId).attr("checked",true);}else{jQuery("#reference_options_hyperlink_"+cId).attr("checked",false);}}}
var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CANCEL_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
buttons[dialogJSObj.Helper.LocaleObject.L_INSERT_BUTTON]=function(){var returnData=obj.createCrossreferencesJSON();dialogJSObj.setEnabled(true);if(returnData!==null){if(isEdit){dialogJSObj.getObj().editCrossReference(returnData);}
else{dialogJSObj.getObj().insertCrossReference(returnData);}}
dialogJSObj.Helper.hideDialog();}
jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);dialogJSObj.Helper.showDialog();dialogJSObj.Helper.dialogCreateTabs();};this.createCrossreferencesJSON=function(){var elementTypeIndex=jQuery("#reference_element_types_"+cId+" .ui-selected").attr("name");var referenceElementIndex=jQuery("#reference_blockelements_"+cId+" .ui-selected").attr("name");if(elementTypeIndex===null||referenceElementIndex===null){return null;}
var type=jQuery("input[name='source_radio_"+cId+"']:checked").val();var hyperLinkChecked=jQuery("#reference_options_hyperlink_"+cId+":checked").val();var crossReferenceInsertionData={};crossReferenceInsertionData.elementTypeIndex=elementTypeIndex;crossReferenceInsertionData.referenceElementIndex=referenceElementIndex;crossReferenceInsertionData.insertedContentType=type;crossReferenceInsertionData.insertAsHyperlink=(hyperLinkChecked==="on");var jsonedReturnData=jQuery.toJSON(crossReferenceInsertionData);return jsonedReturnData;}
this.linkPropertiesDialog=function(dialogJSObj){currentElement=dialogJSObj.getCurrentElement();if(/^<a.*/.test(currentElement)){var html=dialogJSObj.Helper.DialogHTMLMap["linkProperties"];cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,dialogJSObj.Helper.LocaleObject.L_HYPERLINK_PROPERTIES_DIALOG);dialogJSObj.Helper.bindOpenFileDialog("#hyperlink_open_file_button_"+cId,"#hyperlink_url_field_"+cId,null);dialogJSObj.Helper.bindOpenWebdavDialog("#link_open_webdav_button_"+cId,"#hyperlink_url_field_"+cId,"get-webdav-hyperlink");if(!dialogJSObj.isActionEnabled("get-webdav-hyperlink")){jQuery("#link_open_webdav_button_"+cId).hide();}
var linkProperties=dialogJSObj.Helper.jsWrapperObj.getHyperlinkProperties();if(linkProperties!=null){linkProperties=jQuery.evalJSON(linkProperties);jQuery("#hyperlink_url_field_"+cId).val(linkProperties["href"]);jQuery("#targetChooser_"+cId+" option[value='"+linkProperties["target"]+"']").attr("selected","selected");jQuery("#hyperlink_title_field_"+cId).val(linkProperties["title"]);jQuery("#hyperlink_text_field_"+cId).val(linkProperties["text"]);}
var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CANCEL_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
buttons[dialogJSObj.Helper.LocaleObject.L_APPLY_BUTTON]=function(){var url=jQuery("#hyperlink_url_field_"+cId).val();var text=jQuery("#hyperlink_text_field_"+cId).val();var target=jQuery("#targetChooser_"+cId).val();var title=jQuery("#hyperlink_title_field_"+cId).val();if(url!==undefined&&url!==""){json={};if(title!==""){json.title=title;}
if(target!==""){json.target=target;}
if(text!==""){json.text=text;}else{json.text=url;}
json.href=url;dialogJSObj.setEnabled(true);dialogJSObj.setElementAttributes(json);dialogJSObj.Helper.hideDialog();}else{}}
jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);dialogJSObj.Helper.showDialog();dialogJSObj.Helper.dialogCreateTabs();}};this.insertImageDialog=function(dialogJSObj){currentElement=dialogJSObj.getCurrentElement();if(/^<img.*/.test(currentElement)){this.imagePropertiesDialog(dialogJSObj);}else{var html=dialogJSObj.Helper.DialogHTMLMap["insertImage"];cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,dialogJSObj.Helper.LocaleObject.L_INSERT_IMAGE_DIALOG);dialogJSObj.Helper.createSpinner("#image_border_width_"+cId,0,100);dialogJSObj.Helper.bindOpenFileDialog("#image_open_file_button_"+cId,"#image_url_field_"+cId,"image");dialogJSObj.Helper.bindOpenWebdavDialog("#image_open_webdav_button_"+cId,"#image_url_field_"+cId,"get-webdav-image");if(!dialogJSObj.isActionEnabled("get-webdav-image")){jQuery("#image_open_webdav_button_"+cId).hide();}
values=dialogJSObj.Helper.getUserPreferences("insertimagedialog");if(values!==null){jQuery("#image_url_field_"+cId).attr({value:values.url});jQuery("#image_alt_field_"+cId).attr({value:values.alt});jQuery("#image_border_width_"+cId).attr({value:values.borderwidth});jQuery("#image_size_width_field_"+cId).attr({value:values.width});jQuery("#image_size_height_field_"+cId).attr({value:values.height});}
var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CANCEL_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
buttons[dialogJSObj.Helper.LocaleObject.L_INSERT_BUTTON]=function(){var url="";var alt="";var borderWidth="";var width="";var height="";url=jQuery("#image_url_field_"+cId).val();alt=jQuery("#image_alt_field_"+cId).val();borderWidth=jQuery("#image_border_width_"+cId).val();width=jQuery("#image_size_width_field_"+cId).val();height=jQuery("#image_size_height_field_"+cId).val();if(url!==""){var imgAttr={};imgAttr.imageSource=url;if(alt!==""){imgAttr.imageAlt=alt;}else{imgAttr.imageAlt=null;}
if(borderWidth!==""){imgAttr.imageBorderWidth=borderWidth;imgAttr.imageBorderWidthUnit="px";}else{imgAttr.imageBorderWidth=null;}
if(width!==""){imgAttr.imageWidth=width;imgAttr.imageWidthUnit="px";}else{imgAttr.imageWidth=null;}
if(height!==""){imgAttr.imageHeight=height;imgAttr.imageHeightUnit="px";}else{imgAttr.imageHeight=null;}
dialogJSObj.setEnabled(true);dialogJSObj.invokeAction("insert-image",jQuery.toJSON(imgAttr));dialogJSObj.Helper.hideDialog();dialogJSObj.Helper.setUserPreferences({"insertimagedialog":imgAttr});}else{}};jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);dialogJSObj.Helper.showDialog();dialogJSObj.Helper.dialogCreateTabs();}};this.imagePropertiesDialog=function(dialogJSObj){var properties=dialogJSObj.Helper.jsWrapperObj.getImageProperties();if(properties==null||properties==undefined||properties==""){return;}
properties=jQuery.evalJSON(properties);var html=dialogJSObj.Helper.DialogHTMLMap["imageProperties"];cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,dialogJSObj.Helper.LocaleObject.L_IMAGE_PROPERTIES_DIALOG);dialogJSObj.Helper.createSpinner("#image_border_width_"+cId,0,100);dialogJSObj.Helper.bindOpenFileDialog("#image_open_file_button_"+cId,"#image_url_field_"+cId,"image");dialogJSObj.Helper.bindOpenWebdavDialog("#image_open_webdav_button_"+cId,"#image_url_field_"+cId,"get-webdav-image");if(!dialogJSObj.isActionEnabled("get-webdav-image")){jQuery("#image_open_webdav_button_"+cId).hide();}
var url=properties["imageSource"];var alt=properties["imageAlt"];var borderwidth=properties["imageBorderWidth"];var width=properties["imageWidth"];var height=properties["imageHeight"];jQuery("#image_url_field_"+cId).val(url);jQuery("#image_alt_field_"+cId).val(alt);jQuery("#image_border_width_"+cId).val(borderwidth);jQuery("#image_size_width_field_"+cId).val(width);jQuery("#image_size_height_field_"+cId).val(height);var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CANCEL_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
buttons[dialogJSObj.Helper.LocaleObject.L_APPLY_BUTTON]=function(){var url="";var alt="";var borderWidth="";var width="";var height="";url=jQuery("#image_url_field_"+cId).val();alt=jQuery("#image_alt_field_"+cId).val();borderWidth=jQuery("#image_border_width_"+cId).val();width=jQuery("#image_size_width_field_"+cId).val();height=jQuery("#image_size_height_field_"+cId).val();if(url!==""){attributes={};attributes.imageSource=url;if(alt!==""){attributes.imageAlt=alt;}else{attributes.imageAlt=null;}
if(borderWidth!==""){attributes.imageBorderWidth=borderWidth;attributes.imageBorderWidthUnit="px";}else{attributes.imageBorderWidth=null;}
if(width!==""){attributes.imageWidth=width;attributes.imageWidthUnit="px";}
if(height!==""){attributes.imageHeight=height;attributes.imageHeightUnit="px";}
dialogJSObj.setEnabled(true);dialogJSObj.invokeAction("image-properties",jQuery.toJSON(attributes));dialogJSObj.Helper.hideDialog();}else{}}
jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);dialogJSObj.Helper.showDialog();dialogJSObj.Helper.dialogCreateTabs();};this.loadURLDialog=function(dialogJSObj){var html=dialogJSObj.Helper.DialogHTMLMap["loadURL"];cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,dialogJSObj.Helper.LocaleObject.L_LOAD_URL_DIALOG);value=dialogJSObj.Helper.getUserPreferences("loadurldialog");if(value!==null){jQuery("#url_field_"+cId).attr({value:value});}
var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CANCEL_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
if(dialogJSObj.isActionEnabled("get-webdav-document")){buttons[dialogJSObj.Helper.LocaleObject.L_WEBDAV_OPEN]=function(){dialogJSObj.Helper.openWebdavDialog("#url_field_"+cId,"get-webdav-document");}}
buttons[dialogJSObj.Helper.LocaleObject.L_LOAD_BUTTON]=function(){var url=jQuery("#url_field_"+cId).val();dialogJSObj.setEnabled(true);dialogJSObj.loadDocumentFromURL(url);dialogJSObj.Helper.hideDialog();dialogJSObj.Helper.setUserPreferences({"loadurldialog":url});}
jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);dialogJSObj.Helper.showDialog();dialogJSObj.Helper.dialogCreateTabs();};this.insertTableDialog=function(dialogJSObj){var html=dialogJSObj.Helper.DialogHTMLMap["insertTable"];cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,dialogJSObj.Helper.LocaleObject.L_INSERT_TABLE_DIALOG);dialogJSObj.Helper.createSpinner("#table_cell_padding_"+cId,0,100);dialogJSObj.Helper.createSpinner("#table_cell_spacing_"+cId,0,100);dialogJSObj.Helper.createSpinner("#table_border_width_"+cId,0,100);dialogJSObj.Helper.createDrawTableElement("tableDialog_table_"+cId,"table_rows_"+cId,"table_columns_"+cId,7,8);jQuery("#tableColorPicker_"+cId).bind("click",function(){dialogJSObj.CustomJSActions.generalColorDialog(dialogJSObj,"#tableColorPicker_"+cId,dialogJSObj.Helper.LocaleObject.L_TABLE_BACKGROUND_COLOR);});jQuery("#tableBorderColorPicker_"+cId).bind("click",function(){dialogJSObj.CustomJSActions.generalColorDialog(dialogJSObj,"#tableBorderColorPicker_"+cId,dialogJSObj.Helper.LocaleObject.L_TABLE_BORDER_COLOR);});values=dialogJSObj.Helper.getUserPreferences("inserttabledialog");if(values!==null){if(values.tableRows!=""&&values.tableRows!=undefined){jQuery("#table_rows_"+cId).attr({value:values.tableRows});}
if(values.tableColumns!=""&&values.tableColumns!=undefined){jQuery("#table_columns_"+cId).attr({value:values.tableColumns});}
if(values.cellPadding!=""&&values.cellPadding!=undefined){jQuery("#table_cell_padding_"+cId).attr({value:values.cellPadding});}
if(values.cellSpacing!=""&&values.cellSpacing!=undefined){jQuery("#table_cell_spacing_"+cId).attr({value:values.cellSpacing});}}
var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CANCEL_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
buttons[dialogJSObj.Helper.LocaleObject.L_INSERT_BUTTON]=function(){var tableRows=jQuery("#table_rows_"+cId).val();var tableColumns=jQuery("#table_columns_"+cId).val();var tableWidth=jQuery("#table_width_"+cId).val();var tableWidthUnit=jQuery("#table_width_unit_"+cId).val();var tableBorderWidth=jQuery("#table_border_width_"+cId).val();var tableAlignment=jQuery("#table_alignment_"+cId).val();var cellPadding=jQuery("#table_cell_padding_"+cId).val();var cellSpacing=jQuery("#table_cell_spacing_"+cId).val();var tableBGColor=jQuery("#tableColorPicker_"+cId).attr("name");var tableBorderColor=jQuery("#tableBorderColorPicker_"+cId).attr("name");var tableAttr={};if(tableRows===""||tableRows===undefined){tableAttr.tableRows=2;}else{tableAttr.tableRows=tableRows;}
if(tableColumns===""||tableColumns===undefined){tableAttr.tableColumns=2;}else{tableAttr.tableColumns=tableColumns;}
if(tableWidthUnit==="percent"){tableAttr.tableWidthUnit="%";}else{tableAttr.tableWidthUnit=tableWidthUnit;}
if(tableWidth!==""&&tableWidth!==undefined){tableAttr.tableWidth=tableWidth;}else{tableAttr.tableWidth=null;}
if(tableBorderWidth!==""&&tableBorderWidth!==undefined){tableAttr.borderWidth=tableBorderWidth;tableAttr.borderWidthUnit="px";}else{tableAttr.borderWidth=null;}
if(tableAlignment!=="default"){tableAttr.tableAlignment=tableAlignment;}else{tableAttr.tableAlignment=null;}
if(tableBGColor!==""&&tableBGColor!==undefined&&tableBGColor!=="none"){tableAttr.tableBGColor=tableBGColor;}else{tableAttr.tableBGColor=null;}
if(tableBorderColor!==""&&tableBorderColor!==undefined&&tableBorderColor!=="none"){tableAttr.tableBorderColor=tableBorderColor;}else{tableAttr.tableBorderColor=null;}
if(cellPadding!==""&&cellPadding!==undefined){tableAttr.cellPadding=cellPadding;tableAttr.cellPaddingUnit="px";}else{tableAttr.cellPadding=null;}
if(cellSpacing!==""&&cellSpacing!==undefined){tableAttr.cellSpacing=cellSpacing;tableAttr.cellSpacingUnit="px";}else{tableAttr.cellSpacing=null;}
dialogJSObj.setEnabled(true);dialogJSObj.invokeAction("insert-table",jQuery.toJSON(tableAttr));dialogJSObj.Helper.hideDialog();dialogJSObj.Helper.setUserPreferences({"inserttabledialog":tableAttr});}
jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);dialogJSObj.Helper.showDialog();dialogJSObj.Helper.dialogCreateTabs();};this.textColorDialog=function(dialogJSObj){var html=dialogJSObj.Helper.DialogHTMLMap["textColor"];cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,dialogJSObj.Helper.LocaleObject.L_COLOR_DIALOG);dialogJSObj.Helper.createColorSelectTable(dialogJSObj.Helper.defaultColors,"textColor_default_color_table_"+cId);combinedColors=[];addedColors=[];if(dialogJSObj.Helper.config.presetcolors!==undefined){for(i=0;i<dialogJSObj.Helper.config.presetcolors.color.length;i++){combinedColors.push(dialogJSObj.Helper.config.presetcolors.color[i]);}}
upcolors=dialogJSObj.Helper.getUserPreferences("colordialog");if(upcolors!==null){for(i=0;i<upcolors.length;i++){combinedColors.push(upcolors[i]);}}
dialogJSObj.Helper.createColorSelectTable(combinedColors,"textColor_custom_color_table_"+cId);jQuery("#colorPicker_"+cId).ColorPicker({color:'#0000ff',onShow:function(colpkr){jQuery(colpkr).fadeIn(100);return false;},onHide:function(colpkr){jQuery(colpkr).fadeOut(100);return false;},onChange:function(hsb,hex,rgb){jQuery("#colorPicker_"+cId).css('backgroundColor','#'+hex);jQuery("#colorPicker_"+cId).attr('name','#'+hex);jQuery("#hexvalue_"+cId).val("#"+hex);}});jQuery("#textColor_default_color_table_"+cId+" button").each(function(index,value){jQuery(this).bind('click',this,function(e){dialogJSObj.setEnabled(true);dialogJSObj.invokeAction('color',e.data.name);dialogJSObj.Helper.hideDialog();if(addedColors.length>0){dialogJSObj.Helper.setUserPreferences({"colordialog":addedColors});}});});jQuery("#textColor_custom_color_table_"+cId+" button").each(function(index,value){jQuery(this).bind("click",this,function(e){dialogJSObj.setEnabled(true);dialogJSObj.invokeAction('color',e.data.name);dialogJSObj.Helper.hideDialog();if(addedColors.length>0){dialogJSObj.Helper.setUserPreferences({"colordialog":addedColors});}
addedColors=[];});});jQuery("#colorSelectorSubmit_"+cId).bind("click",function(){color=jQuery("#colorPicker_"+cId).attr('name');dialogJSObj.setEnabled(true);dialogJSObj.invokeAction('color',color);dialogJSObj.Helper.hideDialog();if(addedColors.length>0){dialogJSObj.Helper.setUserPreferences({"colordialog":addedColors});}
addedColors=[];});jQuery("#colorSelectorAdd_"+cId).bind("click",function(){color=jQuery("#colorPicker_"+cId).attr('name');colorObject={"rgb":color,"desc":color};addedColors.push(colorObject);combinedColors.push(colorObject);jQuery("#textColor_custom_color_table_"+cId).html("");dialogJSObj.Helper.createColorSelectTable(combinedColors,"textColor_custom_color_table_"+cId);if(addedColors.length>0){dialogJSObj.Helper.setUserPreferences({"colordialog":addedColors});}
addedColors=[];jQuery("#textColor_custom_color_table_"+cId+" button").each(function(index,value){jQuery(this).bind("click",this,function(e){dialogJSObj.setEnabled(true);dialogJSObj.invokeAction('color',e.data.name);dialogJSObj.Helper.hideDialog();});});});var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CANCEL_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
buttons[dialogJSObj.Helper.LocaleObject.L_REMOVE_COLOR]=function(){dialogJSObj.Helper.hideDialog();dialogJSObj.invokeAction('color',null);}
jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);dialogJSObj.Helper.showDialog();dialogJSObj.Helper.dialogCreateTabs();index=0;if(dialogJSObj.Helper.config.allowdefaultcolors!==undefined&&dialogJSObj.Helper.config.allowdefaultcolors!="false"){}else{jQuery("#textColor_default_color_table_"+cId).parents("td.ribbonPanel").remove();}
if(dialogJSObj.Helper.config.allowpresetcolors!==undefined&&dialogJSObj.Helper.config.allowpresetcolors!="false"&&dialogJSObj.Helper.config.presetcolors!==undefined){}else{jQuery("#textColor_custom_color_table_"+cId).parents("td.ribbonPanel").remove();}
if(dialogJSObj.Helper.config.allowfreecolors!==undefined&&dialogJSObj.Helper.config.allowfreecolors!="false"){}else{jQuery("#colorPicker_"+cId).parents("td.ribbonPanel").remove();}};this.backgroundColorDialog=function(dialogJSObj){var html=dialogJSObj.Helper.DialogHTMLMap["backgroundColor"];cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,dialogJSObj.Helper.LocaleObject.L_BACKGROUNDCOLOR_DIALOG);dialogJSObj.Helper.createColorSelectTable(dialogJSObj.Helper.defaultColors,"backgroundColor_default_color_table_"+cId);combinedColors=[];addedColors=[];if(dialogJSObj.Helper.config.presetcolors!==undefined){for(i=0;i<dialogJSObj.Helper.config.presetcolors.color.length;i++){combinedColors.push(dialogJSObj.Helper.config.presetcolors.color[i]);}}
upcolors=dialogJSObj.Helper.getUserPreferences("colordialog");if(upcolors!==null){for(i=0;i<upcolors.length;i++){combinedColors.push(upcolors[i]);}}
dialogJSObj.Helper.createColorSelectTable(combinedColors,"backgroundColor_custom_color_table_"+cId);jQuery("#colorPicker_"+cId).ColorPicker({color:'#0000ff',onShow:function(colpkr){jQuery(colpkr).fadeIn(100);return false;},onHide:function(colpkr){jQuery(colpkr).fadeOut(100);return false;},onChange:function(hsb,hex,rgb){jQuery("#colorPicker_"+cId).css('backgroundColor','#'+hex);jQuery("#colorPicker_"+cId).attr('name','#'+hex);jQuery("#hexvalue_"+cId).val("#"+hex);}});jQuery("#backgroundColor_default_color_table_"+cId+" button").each(function(index,value){jQuery(this).bind('click',this,function(e){dialogJSObj.setEnabled(true);dialogJSObj.invokeAction('background-color',e.data.name);dialogJSObj.Helper.hideDialog();if(addedColors.length>0){dialogJSObj.Helper.setUserPreferences({"colordialog":addedColors});}});});jQuery("#backgroundColor_custom_color_table_"+cId+" button").each(function(index,value){jQuery(this).bind("click",this,function(e){dialogJSObj.setEnabled(true);dialogJSObj.invokeAction('background-color',e.data.name);dialogJSObj.Helper.hideDialog();if(addedColors.length>0){dialogJSObj.Helper.setUserPreferences({"colordialog":addedColors});}
addedColors=[];});});jQuery("#colorSelectorSubmit_"+cId).bind("click",function(){color=jQuery("#colorPicker_"+cId).attr('name');dialogJSObj.setEnabled(true);dialogJSObj.invokeAction('background-color',color);dialogJSObj.Helper.hideDialog();if(addedColors.length>0){dialogJSObj.Helper.setUserPreferences({"colordialog":addedColors});}
addedColors=[];});jQuery("#colorSelectorAdd_"+cId).bind("click",function(){color=jQuery("#colorPicker_"+cId).attr('name');colorObject={"rgb":color,"desc":color};addedColors.push(colorObject);combinedColors.push(colorObject);jQuery("#backgroundColor_custom_color_table_"+cId).html("");dialogJSObj.Helper.createColorSelectTable(combinedColors,"backgroundColor_custom_color_table_"+cId);if(addedColors.length>0){dialogJSObj.Helper.setUserPreferences({"colordialog":addedColors});}
addedColors=[];jQuery("#backgroundColor_custom_color_table_"+cId+" button").each(function(index,value){jQuery(this).bind("click",this,function(e){dialogJSObj.setEnabled(true);dialogJSObj.invokeAction('background-color',e.data.name);dialogJSObj.Helper.hideDialog();});});});var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CANCEL_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
buttons[dialogJSObj.Helper.LocaleObject.L_REMOVE_COLOR]=function(){dialogJSObj.Helper.hideDialog();dialogJSObj.invokeAction('background-color',null);}
jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);dialogJSObj.Helper.showDialog();dialogJSObj.Helper.dialogCreateTabs();index=0;if(dialogJSObj.Helper.config.allowdefaultcolors!==undefined&&dialogJSObj.Helper.config.allowdefaultcolors!="false"){}else{jQuery("#backgroundColor_default_color_table_"+cId).parents("td.ribbonPanel").remove();}
if(dialogJSObj.Helper.config.allowpresetcolors!==undefined&&dialogJSObj.Helper.config.allowpresetcolors!="false"&&dialogJSObj.Helper.config.presetcolors!==undefined){}else{jQuery("#backgroundColor_custom_color_table_"+cId).parents("td.ribbonPanel").remove();}
if(dialogJSObj.Helper.config.allowfreecolors!==undefined&&dialogJSObj.Helper.config.allowfreecolors!="false"){}else{jQuery("#colorPicker_"+cId).parents("td.ribbonPanel").remove();}};this.documentStatisticsDialog=function(dialogJSObj){var html=dialogJSObj.Helper.DialogHTMLMap["documentStatistics"];html=dialogJSObj.Helper.processTemplate(html);cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,dialogJSObj.Helper.LocaleObject.L_DOCUMENT_STATISTICS_DIALOG);jQuery("#no_characters_"+cId).html(dialogJSObj.getNumberOfCharacters(false));jQuery("#no_characters_w_"+cId).html(dialogJSObj.getNumberOfCharacters(true));jQuery("#no_words_"+cId).html(dialogJSObj.getNumberOfWords());jQuery("#no_paragraphs_"+cId).html(dialogJSObj.getNumberOfParagraphs());jQuery("#no_images_"+cId).html(dialogJSObj.getNumberOfImages());var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CLOSE_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);dialogJSObj.Helper.showDialog();dialogJSObj.Helper.dialogCreateTabs();};this.splitCellDialog=function(dialogJSObj){var html=dialogJSObj.Helper.DialogHTMLMap["splitCell"];cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,dialogJSObj.Helper.LocaleObject.L_SPLIT_CELL_DIALOG);values=dialogJSObj.Helper.getUserPreferences("splitcelldialog");if(values!==null){jQuery("#split_cell_rows_"+cId).attr({value:values.rows});jQuery("#split_cell_columns_"+cId).attr({value:values.cols});}
var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CLOSE_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
buttons[dialogJSObj.Helper.LocaleObject.L_OK_BUTTON]=function(){var rows=jQuery("#split_cell_rows_"+cId).val();var columns=jQuery("#split_cell_columns_"+cId).val();dialogJSObj.setEnabled(true);dialogJSObj.invokeAction("split-cell","['"+rows+"', '"+columns+"']");dialogJSObj.Helper.hideDialog();splitAttr={};splitAttr.rows=rows;splitAttr.cols=columns;dialogJSObj.Helper.setUserPreferences({"splitcelldialog":splitAttr});};jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);dialogJSObj.Helper.showDialog();dialogJSObj.Helper.dialogCreateTabs();};this.changeCaseDialog=function(dialogJSObj){var html=dialogJSObj.Helper.DialogHTMLMap["changeCase"];cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,dialogJSObj.Helper.LocaleObject.L_CHANGE_CASE_DIALOG);value=dialogJSObj.Helper.getUserPreferences("changecasedialog");if(value!==null){jQuery("input:radio[name=changeCaseRadio_"+cId+"][value="+value+"]").attr("checked",true);}
var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CLOSE_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
buttons[dialogJSObj.Helper.LocaleObject.L_OK_BUTTON]=function(){var caseString=jQuery("input:radio[name=changeCaseRadio_"+cId+"]:checked").val();dialogJSObj.setEnabled(true);dialogJSObj.invokeAction("change-case","['"+caseString+"']");dialogJSObj.Helper.hideDialog();dialogJSObj.Helper.setUserPreferences({"changecasedialog":caseString});}
jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);dialogJSObj.Helper.showDialog();dialogJSObj.Helper.dialogCreateTabs();};this.tablePropertiesDialog=function(dialogJSObj){var html=dialogJSObj.Helper.DialogHTMLMap["tableProperties"];var tableWidth="";var tableWidthUnit="";var tableAlignment="";var tableVerticalAlignment="";var cellPadding="";var cellSpacing="";var borderWidth="";var tableBorderColor="";var tableBGColor="";var tableProperties=dialogJSObj.Helper.jsWrapperObj.getTableProperties();if(tableProperties!==""){tableProperties=jQuery.evalJSON(tableProperties);tableWidth=tableProperties["tableWidth"];tableWidthUnit=tableProperties["tableWidthUnit"];tableAlignment=tableProperties["tableAlignment"];tableVerticalAlignment=tableProperties["tableVerticalAlignment"];cellPadding=tableProperties["cellPadding"];cellSpacing=tableProperties["cellSpacing"];borderWidth=tableProperties["borderWidth"];tableBorderColor=tableProperties["tableBorderColor"];tableBGColor=tableProperties["tableBGColor"];}
cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,dialogJSObj.Helper.LocaleObject.L_TABLE_PROPERTIES_DIALOG);jQuery("#table_border_width_"+cId).val(borderWidth);jQuery("#table_width_unit_"+cId+" option[value='"+tableWidthUnit+"']").attr("selected","selected");jQuery("#table_alignment_"+cId+" option[value='"+tableAlignment+"']").attr("selected","selected");jQuery("#table_vertical_alignment_"+cId+" option[value='"+tableVerticalAlignment+"']").attr("selected","selected");jQuery("#table_width_"+cId).val(tableWidth);jQuery("#table_cell_padding_"+cId).val(cellPadding);jQuery("#table_cell_spacing_"+cId).val(cellSpacing);jQuery("#tableColorPicker_"+cId).attr("name",tableBGColor);jQuery("#tableColorPicker_"+cId).css({"background-color":tableBGColor});jQuery("#tableBorderColorPicker_"+cId).attr("name",tableBorderColor);jQuery("#tableBorderColorPicker_"+cId).css({"background-color":tableBorderColor});dialogJSObj.Helper.createSpinner("#table_cell_padding_"+cId,0,100);dialogJSObj.Helper.createSpinner("#table_cell_spacing_"+cId,0,100);dialogJSObj.Helper.createSpinner("#table_border_width_"+cId,0,100);jQuery("#tableColorPicker_"+cId).bind("click",function(){dialogJSObj.CustomJSActions.generalColorDialog(dialogJSObj,"#tableColorPicker_"+cId,dialogJSObj.Helper.LocaleObject.L_TABLE_BACKGROUND_COLOR);});jQuery("#tableBorderColorPicker_"+cId).bind("click",function(){dialogJSObj.CustomJSActions.generalColorDialog(dialogJSObj,"#tableBorderColorPicker_"+cId,dialogJSObj.Helper.LocaleObject.L_TABLE_BORDERCOLOR);});var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CLOSE_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
buttons[dialogJSObj.Helper.LocaleObject.L_APPLY_BUTTON]=function(){var attributesNew={};var tableWidth=jQuery("#table_width_"+cId).val();var tableWidthUnit=jQuery("#table_width_unit_"+cId).val();var tableBorderWidth=jQuery("#table_border_width_"+cId).val();var tableAlignment=jQuery("#table_alignment_"+cId).val();var tableVerticalAlignment=jQuery("#table_vertical_alignment_"+cId).val();var cellPadding=jQuery("#table_cell_padding_"+cId).val();var cellSpacing=jQuery("#table_cell_spacing_"+cId).val();var tableBGColor=jQuery("#tableColorPicker_"+cId).attr("name");var tableBorderColor=jQuery("#tableBorderColorPicker_"+cId).attr("name");if(tableWidthUnit==="percent"){tableWidthUnit="%";}
else{tableWidthUnit="px";}
if(tableWidth!==""||tableWidth!==undefined){attributesNew.tableWidth=tableWidth;attributesNew.tableWidthUnit=tableWidthUnit;}else{attributesNew.tableWidth=null;attributesNew.tableWidthUnit=tableWidthUnit;}
if(tableBorderWidth!==""||tableBorderWidth!==undefined){attributesNew.borderWidth=tableBorderWidth;attributesNew.borderWidthUnit="px";}else{attributesNew.borderWidth=null;attributesNew.borderWidthUnit="px";}
if(tableAlignment!=="default"){attributesNew.tableAlignment=tableAlignment;}else{attributesNew.tableAlignment=null;}
if(tableVerticalAlignment!=="default"){attributesNew.tableVerticalAlignment=tableVerticalAlignment;}else{attributesNew.tableVerticalAlignment=null;}
if(cellPadding!==""){attributesNew.cellPadding=cellPadding;attributesNew.cellPaddingUnit="px";}else{cellPadding=null;}
if(cellSpacing!==""){attributesNew.cellSpacing=cellSpacing;attributesNew.cellSpacingUnit="px";}else{attributesNew.cellSpacing=null;}
if(tableBGColor!==""&&tableBGColor!=="none"){attributesNew.tableBGColor=tableBGColor;}else{attributesNew.tableBGColor=null;}
if(tableBorderColor!==""&&tableBorderColor!=="none"){attributesNew.tableBorderColor=tableBorderColor;}else{attributesNew.tableBorderColor=null;}
dialogJSObj.setEnabled(true);dialogJSObj.invokeAction("table-properties",jQuery.toJSON(attributesNew));dialogJSObj.Helper.hideDialog();}
jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);dialogJSObj.Helper.showDialog();dialogJSObj.Helper.dialogCreateTabs();};this.rowPropertiesDialog=function(dialogJSObj){var html=dialogJSObj.Helper.DialogHTMLMap["rowProperties"];var rowProperties=dialogJSObj.Helper.jsWrapperObj.getRowProperties();if(rowProperties!==""){rowProperties=jQuery.evalJSON(rowProperties);cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,dialogJSObj.Helper.LocaleObject.L_ROW_PROPERTIES_DIALOG);rowHeight=rowProperties["height"];rowHeightUnit=rowProperties["heightUnit"];rowValign=rowProperties["valign"];rowAlign=rowProperties["align"];rowBGColor=rowProperties["bgcolor"];jQuery("#rowproperties_row_height_"+cId).val(rowHeight);jQuery("#rowproperties_row_height_unit_"+cId+" option[value='"+rowHeightUnit+"']").attr("selected","selected");jQuery("#rowproperties_vertical_alignment_"+cId+" option[value='"+rowValign+"']").attr("selected","selected");jQuery("#rowproperties_alignment_"+cId+" option[value='"+rowAlign+"']").attr("selected","selected");jQuery("#rowColorPicker_"+cId).attr("name",rowBGColor);jQuery("#rowColorPicker_"+cId).css({"background-color":rowBGColor});jQuery("#rowColorPicker_"+cId).bind("click",function(){dialogJSObj.CustomJSActions.generalColorDialog(dialogJSObj,"#rowColorPicker_"+cId,dialogJSObj.Helper.LocaleObject.L_ROW_BACKGROUND_COLOR);});var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CLOSE_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
buttons[dialogJSObj.Helper.LocaleObject.L_APPLY_BUTTON]=function(){var attributesNew={};rowHeight=jQuery("#rowproperties_row_height_"+cId).val();rowHeightUnit=jQuery("#rowproperties_row_height_unit_"+cId).val();rowValign=jQuery("#rowproperties_vertical_alignment_"+cId).val();rowAlign=jQuery("#rowproperties_alignment_"+cId).val();rowBGColor=jQuery("#rowColorPicker_"+cId).attr("name");if(rowHeightUnit=="percent"){rowHeightUnit="%";}
if(rowHeight!==undefined&&rowHeight!==""){attributesNew.height=rowHeight;attributesNew.heightUnit=rowHeightUnit;}else{attributesNew.height=null;attributesNew.heightUnit=rowHeightUnit;}
if(rowBGColor!==undefined&&rowBGColor!==""&&rowBGColor!=="none"){attributesNew.bgcolor=rowBGColor;}else{attributesNew.bgcolor=null;}
if(rowValign!==undefined&&rowValign!==""&&rowValign!=="default"){attributesNew.valign=rowValign;}else{attributesNew.valign=null;}
if(rowAlign!==undefined&&rowAlign!==""&&rowAlign!=="default"){attributesNew.align=rowAlign;}else{attributesNew.align=null;}
dialogJSObj.setEnabled(true);dialogJSObj.invokeAction("row-properties",jQuery.toJSON(attributesNew));dialogJSObj.Helper.hideDialog();}
jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);dialogJSObj.Helper.showDialog();dialogJSObj.Helper.dialogCreateTabs();}};this.columnPropertiesDialog=function(dialogJSObj){var html=dialogJSObj.Helper.DialogHTMLMap["columnProperties"];var columnProperties=dialogJSObj.Helper.jsWrapperObj.getColumnProperties();if(columnProperties!==""){columnProperties=jQuery.evalJSON(columnProperties);cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,dialogJSObj.Helper.LocaleObject.L_COLUMN_PROPERTIES_DIALOG);columnWidth=columnProperties["width"];columnWidthUnit=columnProperties["widthUnit"];columnValign=columnProperties["valign"];columnAlign=columnProperties["align"];columnBGColor=columnProperties["bgcolor"];jQuery("#columnproperties_column_width_"+cId).val(columnWidth);jQuery("#columnproperties_column_width_unit_"+cId+" option[value='"+columnWidthUnit+"']").attr("selected","selected");jQuery("#columnproperties_vertical_alignment_"+cId+" option[value='"+columnValign+"']").attr("selected","selected");jQuery("#columnproperties_alignment_"+cId+" option[value='"+columnAlign+"']").attr("selected","selected");jQuery("#columnColorPicker_"+cId).attr("name",columnBGColor);jQuery("#columnColorPicker_"+cId).css({"background-color":columnBGColor});jQuery("#columnColorPicker_"+cId).bind("click",function(){dialogJSObj.CustomJSActions.generalColorDialog(dialogJSObj,"#columnColorPicker_"+cId,dialogJSObj.Helper.LocaleObject.L_COLUMN_BACKGROUND_COLOR);});var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CLOSE_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
buttons[dialogJSObj.Helper.LocaleObject.L_APPLY_BUTTON]=function(){var attributesNew={};columnWidth=jQuery("#columnproperties_column_width_"+cId).val();columnWidthUnit=jQuery("#columnproperties_column_width_unit_"+cId).val();columnAlign=jQuery("#columnproperties_alignment_"+cId).val();columnValign=jQuery("#columnproperties_vertical_alignment_"+cId).val();columnBGColor=jQuery("#columnColorPicker_"+cId).attr("name");if(columnWidthUnit==="percent"){columnWidthUnit="%";}
if(columnWidth!==undefined&&columnWidth!==""){attributesNew.width=columnWidth;attributesNew.widthUnit=columnWidthUnit;}else{attributesNew.width=null;attributesNew.widthUnit=columnWidthUnit;}
if(columnAlign!==undefined&&columnAlign!==""&&columnAlign!=="default"){attributesNew.align=columnAlign;}else{attributesNew.align=null;}
if(columnValign!==undefined&&columnValign!==""&&columnValign!=="default"){attributesNew.valign=columnValign;}else{attributesNew.valign=null;}
if(columnBGColor!==undefined&&columnBGColor!==""&&columnBGColor!=="none"){attributesNew.bgcolor=columnBGColor;}else{attributesNew.bgcolor=null;}
dialogJSObj.setEnabled(true);dialogJSObj.invokeAction("column-properties",jQuery.toJSON(attributesNew));dialogJSObj.Helper.hideDialog();}
jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);dialogJSObj.Helper.showDialog();dialogJSObj.Helper.dialogCreateTabs();}};this.cellPropertiesDialog=function(dialogJSObj){var html=dialogJSObj.Helper.DialogHTMLMap["cellProperties"];var cellWidth="";var cellHeight="";var cellValign="";var cellAlign="";var cellBGColor="";var cellWidthUnit="";var cellHeightUnit="";var cellProperties=dialogJSObj.Helper.jsWrapperObj.getCellProperties();if(cellProperties!==""){cellProperties=jQuery.evalJSON(cellProperties);cellWidth=cellProperties["width"];cellHeight=cellProperties["height"];cellValign=cellProperties["valign"];cellAlign=cellProperties["align"];cellBGColor=cellProperties["bgcolor"];cellWidthUnit=cellProperties["widthUnit"];cellHeightUnit=cellProperties["heightUnit"];}
cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,dialogJSObj.Helper.LocaleObject.L_CELL_PROPERTIES_DIALOG);jQuery("#cellproperties_width_"+cId).val(cellWidth);jQuery("#cellproperties_width_unit_"+cId+" option[value='"+cellWidthUnit+"']").attr("selected","selected");jQuery("#cellproperties_height_"+cId).val(cellHeight);jQuery("#cellproperties_height_unit_"+cId+" option[value='"+cellHeightUnit+"']").attr("selected","selected");jQuery("#cellproperties_vertical_alignment_"+cId+" option[value='"+cellValign+"']").attr("selected","selected");jQuery("#cellproperties_alignment_"+cId+" option[value='"+cellAlign+"']").attr("selected","selected");jQuery("#cellColorPicker_"+cId).css({"background-color":cellBGColor});jQuery("#cellColorPicker_"+cId).bind("click",function(){dialogJSObj.CustomJSActions.generalColorDialog(dialogJSObj,"#cellColorPicker_"+cId,dialogJSObj.Helper.LocaleObject.L_CELL_BACKGROUND_COLOR);});var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CLOSE_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
buttons[dialogJSObj.Helper.LocaleObject.L_APPLY_BUTTON]=function(){attributesNew={};cellWidth=jQuery("#cellproperties_width_"+cId).val();cellWidthUnit=jQuery("#cellproperties_width_unit_"+cId).val();cellHeight=jQuery("#cellproperties_height_"+cId).val();cellHeightUnit=jQuery("#cellproperties_height_unit_"+cId).val();cellValign=jQuery("#cellproperties_vertical_alignment_"+cId).val();cellAlign=jQuery("#cellproperties_alignment_"+cId).val();cellBGColor=jQuery("#cellColorPicker_"+cId).attr("name");if(cellHeightUnit==="percent"){cellHeightUnit="%";}
if(cellWidthUnit==="percent"){cellWidthUnit="%";}
if(cellWidth!==undefined&&cellWidth!==""){attributesNew.width=cellWidth;attributesNew.widthUnit=cellWidthUnit;}else{attributesNew.width=null;attributesNew.widthUnit=cellWidthUnit;}
if(cellHeight!==undefined&&cellHeight!==""){attributesNew.height=cellHeight;attributesNew.heightUnit=cellHeightUnit;}else{attributesNew.height=null;attributesNew.heightUnit=cellHeightUnit;}
if(cellValign!==undefined&&cellValign!==""&&cellValign!=="default"){attributesNew.valign=cellValign;}else{attributesNew.valign=null;}
if(cellAlign!==undefined&&cellAlign!==""&&cellAlign!=="default"){attributesNew.align=cellAlign;}else{attributesNew.align=null;}
if(cellBGColor!==undefined&&cellBGColor!==""&&cellBGColor!=="none"){attributesNew.bgcolor=cellBGColor;}else{attributesNew.bgcolor=null;}
dialogJSObj.setEnabled(true);dialogJSObj.invokeAction("cell-properties",jQuery.toJSON(attributesNew));dialogJSObj.Helper.hideDialog();}
jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);dialogJSObj.Helper.showDialog();dialogJSObj.Helper.dialogCreateTabs();};this.insertAnnotationDialog=function(dialogJSObj){var html=dialogJSObj.Helper.DialogHTMLMap["insertAnnotation"];cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,dialogJSObj.Helper.LocaleObject.L_INSERT_ANNOTATION_DIALOG);dialogJSObj.Helper.jsWrapperObj.initializeInsertAnnotationHelper();customAttr=dialogJSObj.Helper.annotationUserAttributes;var annotationProperties=dialogJSObj.Helper.jsWrapperObj.getInsertAnnotationProperties();var strAuthor="";var strUid="";var strDate="";if(annotationProperties!==""){annotationProperties=jQuery.evalJSON(annotationProperties);strAuthor=annotationProperties["author"];strUid=annotationProperties["uid"];strDate=annotationProperties["date"];}
values=dialogJSObj.Helper.getUserPreferences("insertannotationdialog");if(values!==null){if(customAttr.author!=""&&customAttr.author!=undefined){strAuthor=customAttr.author;}else if(values.author!=""&&values.author!=undefined){strAuthor=values.author;}}else{if(customAttr.author!=""&&customAttr.author!=undefined){strAuthor=customAttr.author;}}
jQuery("#annotation_time_"+cId).html(strDate);jQuery("#annotation_author_"+cId).val(strAuthor);jQuery("#annotation_uid_"+cId).html(strUid);if(dialogJSObj.Helper.config.allowannotationuserattributes=="false"){jQuery("#annotation_author_"+cId).attr("disabled",true);}
var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CLOSE_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
buttons[dialogJSObj.Helper.LocaleObject.L_INSERT_BUTTON]=function(){dialogJSObj.setEnabled(true);annotationText=jQuery("#annotation_text_"+cId).val();if(annotationText!==""&&annotationText!==undefined){strUid=jQuery("#annotation_uid_"+cId).html();strAuthor=jQuery("#annotation_author_"+cId).val();json={};json.uid=strUid;json.author=strAuthor;json.text=annotationText;dialogJSObj.invokeAction("insert-annotation",jQuery.toJSON(json));dialogJSObj.Helper.hideDialog();dialogJSObj.Helper.setUserPreferences({"insertannotationdialog":{"author":strAuthor}});}else{}}
jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);dialogJSObj.Helper.showDialog();dialogJSObj.Helper.dialogCreateTabs();};this.editAnnotationDialog=function(dialogJSObj){var html=dialogJSObj.Helper.DialogHTMLMap["editAnnotation"];cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,dialogJSObj.Helper.LocaleObject.L_EDIT_ANNOTATION_DIALOG);dialogJSObj.Helper.jsWrapperObj.initializeEditAnnotationHelper();var uid="";var author="";var date="";var text="";var annotationProperties=dialogJSObj.Helper.jsWrapperObj.getEditAnnotationProperties();if(annotationProperties!==""){annotationProperties=jQuery.evalJSON(annotationProperties);uid=annotationProperties["uid"];author=annotationProperties["author"];date=annotationProperties["date"];text=annotationProperties["text"];}
jQuery("#annotation_time_"+cId).html(date);jQuery("#annotation_author_"+cId).html(author);jQuery("#annotation_uid_"+cId).html(uid);jQuery("#annotation_text_"+cId).html(text);var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CLOSE_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
buttons[dialogJSObj.Helper.LocaleObject.L_APPLY_BUTTON]=function(){dialogJSObj.setEnabled(true);annotationText=jQuery("#annotation_text_"+cId).val();if(annotationText!==""&&annotationText!==undefined){dialogJSObj.invokeAction("edit-annotation",annotationText);dialogJSObj.Helper.hideDialog();}else{}}
jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);dialogJSObj.Helper.showDialog();dialogJSObj.Helper.dialogCreateTabs();};this.insertSpecialCharacterDialog=function(dialogJSObj){var html=dialogJSObj.Helper.DialogHTMLMap["insertSpecialChar"];cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,dialogJSObj.Helper.LocaleObject.L_INSERT_SPECIAL_CHARACTER_DIALOG);var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CLOSE_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
buttons[dialogJSObj.Helper.LocaleObject.L_INSERT_BUTTON]=function(){char=jQuery(".view_char_field_"+cId+" td:visible").html();font=jQuery("#fontDropDownContainer_"+cId+"_comboBox").val();dialogJSObj.insertContent("<span style=\"font-family: "+font+"\">"+char+"</span>");dialogJSObj.Helper.setUserPreferences({"insertspecialchardialog":font});}
jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);dialogJSObj.Helper.createFontFamilyDropdown();value=dialogJSObj.Helper.getUserPreferences("insertspecialchardialog");if(value!=""){jQuery(".font_family_selector_"+cId).val(value);}
dialogJSObj.Helper.createDefaultCharTable("defaultCharacterContainer_"+cId,".ui-dialog-buttonpane .font_family_selector_"+cId);dialogJSObj.Helper.createCustomCharTable("customCharacterContainer_"+cId,".ui-dialog-buttonpane .font_family_selector_"+cId);jQuery(".font_family_selector_"+cId).bind("change",dialogJSObj,function(e){jQuery(".view_char_field_"+cId+" td").css({"font-family":jQuery(this).val()});jQuery(".specialCharDiv div td").css({"font-family":jQuery(this).val()});});jQuery(".specialCharDiv").bind("click",dialogJSObj,function(e){var val=jQuery(this).find(".charInnerTD").html();jQuery(".view_char_field_"+cId+" td").html(val);});jQuery(".specialCharDiv").bind("dblclick",dialogJSObj,function(e){var val=jQuery(this).find(".charInnerTD").html();jQuery(".view_char_field_"+cId+" td").html(val);char=jQuery(".view_char_field_"+cId+" td:visible").html();font=jQuery("#fontDropDownContainer_"+cId+"_comboBox").val();dialogJSObj.insertContent("<span style=\"font-family: "+font+"\">"+char+"</span>");dialogJSObj.Helper.setUserPreferences({"insertspecialchardialog":font});});dialogJSObj.Helper.showDialog();dialogJSObj.Helper.dialogCreateTabs();};this.horizontalLinePropertiesDialog=function(dialogJSObj){var html=dialogJSObj.Helper.DialogHTMLMap["hrProperties"];if(/^<hr.*/.test(dialogJSObj.getCurrentElement())){var attributes=dialogJSObj.getElementAttributes();cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,dialogJSObj.Helper.LocaleObject.L_HORIZONTAL_LINE_PROPERTIES_DIALOG);size="";width="";var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CLOSE_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
buttons[dialogJSObj.Helper.LocaleObject.L_APPLY_BUTTON]=function(){var attributesNew={};width=jQuery("#hrproperties_width_"+cId).val();widthUnit=jQuery("#hrproperties_width_unit_"+cId).val();size=jQuery("#hrproperties_size_"+cId).val();if(widthUnit==="percent"){widthUnit="%";}
if(width!==undefined&&width!==""){attributesNew.hrWidth=width;attributesNew.hrWidthUnit=widthUnit;}
if(size!==undefined&&size!==""){attributesNew.hrHeight=size;attributesNew.hrHeightUnit="px";}
dialogJSObj.setEnabled(true);dialogJSObj.invokeAction("horizontal-line-properties",jQuery.toJSON(attributesNew));dialogJSObj.Helper.hideDialog();}
jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);dialogJSObj.Helper.showDialog();dialogJSObj.Helper.dialogCreateTabs();}};this.insertObjectDialog=function(dialogJSObj){currentElement=dialogJSObj.getCurrentElement();if(/^<object.*/.test(currentElement)){this.objectPropertiesDialog(dialogJSObj);}else{var html=dialogJSObj.Helper.DialogHTMLMap["insertObject"];cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,dialogJSObj.Helper.LocaleObject.L_INSERT_OBJECT_DIALOG);dialogJSObj.Helper.bindOpenFileDialog("#object_open_file_button_"+cId,"#object_url_field_"+cId,"object");dialogJSObj.Helper.bindOpenWebdavDialog("#object_open_webdav_button_"+cId,"#object_url_field_"+cId,"get-webdav-object");if(!dialogJSObj.isActionEnabled("get-webdav-object")){jQuery("#object_open_webdav_button_"+cId).hide();}
var values=dialogJSObj.Helper.getUserPreferences("insertobjectdialog");var paramObject={};if(values!==null){jQuery("#object_url_field_"+cId).attr({value:values.url});jQuery("#object_type_"+cId).attr({value:values.type});jQuery("#object_name_"+cId).attr({value:values.name});jQuery("#object_class_"+cId).attr({value:values.classname});jQuery("#object_alignment_"+cId).attr({value:values.alignment});jQuery("#object_width_"+cId).attr({value:values.width});jQuery("#object_height_"+cId).attr({value:values.height});jQuery("#object_althtml_"+cId).attr({value:values.alt});jQuery("#object_codebase_"+cId).attr({value:values.codebase});paramObject=values.param;}
var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CLOSE_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
buttons[dialogJSObj.Helper.LocaleObject.L_INSERT_BUTTON]=function(){objectSource=jQuery("#object_url_field_"+cId).val();objectType=jQuery("#object_type_"+cId).val();objectName=jQuery("#object_name_"+cId).val();objectClass=jQuery("#object_class_"+cId).val();objectAlignment=jQuery("#object_alignment_"+cId).val();objectWidth=jQuery("#object_width_"+cId).val();objectHeight=jQuery("#object_height_"+cId).val();objectAltHTML=jQuery("#object_althtml_"+cId).val();objectCodeBase=jQuery("#object_codebase_"+cId).val();paramJson={};jQuery("#object_parameter_container_"+cId+" tr").each(function(){paramName=jQuery(this).children("td").children("input.paramName").val();paramValue=jQuery(this).children("td").children("input.paramValue").val();if(paramName!==undefined&&paramName!==null&&paramName!==""&&paramValue!==undefined&&paramValue!==null&&paramValue!==""){paramJson[paramName]=paramValue;}});objAttr={};objAttr.objectParams=paramJson;if(objectSource!==undefined&&objectSource!==null&&objectSource!==""){objAttr.objectData=objectSource;if(objectType!==undefined&&objectType!==null&&objectType!==""){objAttr.objectType=objectType;}else{objAttr.objectType=null;}
if(objectName!==undefined&&objectName!==null&&objectName!==""){objAttr.objectName=objectName;}else{objAttr.objectName=null;}
if(objectClass!==undefined&&objectClass!==null&&objectClass!==""){objAttr.objectClass=objectClass;}else{objAttr.objectClass=objectClass;}
if(objectAlignment!==undefined&&objectAlignment!==null&&objectAlignment!==""){objAttr.objectAlignment=objectAlignment;}else{objAttr.objectAlignment=null;}
if(objectWidth!==undefined&&objectWidth!==null&&objectWidth!==""){objAttr.objectWidth=objectWidth;objAttr.objectWidthUnit="px";}else{objAttr.objectWidth=null;objAttr.objectWidthUnit="px";}
if(objectHeight!==undefined&&objectHeight!==null&&objectHeight!==""){objAttr.objectHeight=objectHeight;objAttr.objectHeightUnit="px";}else{objAttr.objectHeight=null;objAttr.objectHeightUnit="px";}
if(objectCodeBase!==undefined&&objectCodeBase!==null&&objectCodeBase!==""){objAttr.objectCodeBase=objectCodeBase;}else{objAttr.objectCodeBase=null;}
if(objectAltHTML!==undefined&&objectAltHTML!==null&&jQuery.trim(objectAltHTML)!==""){objAttr.objectAlt=objectAltHTML;}else{objAttr.objectAlt="";}
dialogJSObj.setEnabled(true);dialogJSObj.invokeAction("insert-object",jQuery.toJSON(objAttr));dialogJSObj.Helper.hideDialog();dialogJSObj.Helper.setUserPreferences({"insertobjectdialog":objAttr});}
else{}}
jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);dialogJSObj.Helper.showDialog();dialogJSObj.Helper.createParameterWidget("#object_parameter_container_"+cId,paramObject);dialogJSObj.Helper.dialogCreateTabs();}};this.objectPropertiesDialog=function(dialogJSObj){var properties=dialogJSObj.Helper.jsWrapperObj.getObjectProperties();if(properties==null||properties==undefined||properties==""){return;}
properties=jQuery.evalJSON(properties);var html=dialogJSObj.Helper.DialogHTMLMap["objectProperties"];cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,dialogJSObj.Helper.LocaleObject.L_OBJECT_PROPERTIES_DIALOG);dialogJSObj.Helper.bindOpenFileDialog("#object_open_file_button_"+cId,"#object_url_field_"+cId,"object");dialogJSObj.Helper.bindOpenWebdavDialog("#object_open_webdav_button_"+cId,"#object_url_field_"+cId,"get-webdav-object");if(!dialogJSObj.isActionEnabled("get-webdav-object")){jQuery("#object_open_webdav_button_"+cId).hide();}
var objectSource=properties["objectData"];var objectType=properties["objectType"];var objectName=properties["objectName"];var objectClass=properties["objectClass"];var objectAlt=properties["objectAlt"];var objectParams=properties["objectParams"];var objectAlignment=properties["objectAlignment"];var objectWidth=properties["objectWidth"];var objectHeight=properties["objectHeight"];var objectCodeBase=properties["objectCodeBase"];if(objectSource!==undefined&&objectSource!==null&&objectSource!==""){jQuery("#object_url_field_"+cId).val(objectSource);}
if(objectType!==undefined&&objectType!==null&&objectType!==""){jQuery("#object_type_"+cId+" option[value='"+objectType+"']").attr("selected","selected");}
if(objectName!==undefined&&objectName!==null&&objectName!==""){jQuery("#object_name_"+cId).val(objectName);}
if(objectClass!==undefined&&objectClass!==null&&objectClass!==""){jQuery("#object_class_"+cId).val(objectClass);}
if(objectAlt!==undefined&&objectAlt!==null&&objectAlt!==""){jQuery("#object_althtml_"+cId).val(objectAlt);}
if(objectAlignment!==undefined&&objectAlignment!==null&&objectAlignment!==""){jQuery("#object_alignment_"+cId+" option[value='"+objectAlignment+"']").attr("selected","selected");}
if(objectWidth!==undefined&&objectWidth!==null&&objectWidth!==""){jQuery("#object_width_"+cId).val(objectWidth);}
if(objectHeight!==undefined&&objectHeight!==null&&objectHeight!==""){jQuery("#object_height_"+cId).val(objectHeight);}
if(objectCodeBase!==undefined&&objectCodeBase!==null&&objectCodeBase!==""){jQuery("#object_codebase_"+cId).val(objectCodeBase);}
var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CLOSE_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
buttons[dialogJSObj.Helper.LocaleObject.L_APPLY_BUTTON]=function(){objectSource=jQuery("#object_url_field_"+cId).val();objectType=jQuery("#object_type_"+cId).val();objectName=jQuery("#object_name_"+cId).val();objectClass=jQuery("#object_class_"+cId).val();objectAlignment=jQuery("#object_alignment_"+cId).val();objectWidth=jQuery("#object_width_"+cId).val();objectHeight=jQuery("#object_height_"+cId).val();objectAltHTML=jQuery("#object_althtml_"+cId).val();objectCodeBase=jQuery("#object_codebase_"+cId).val();paramJson={};jQuery("#object_parameter_container_"+cId+" tr").each(function(){paramName=jQuery(this).children("td").children("input.paramName").val();paramValue=jQuery(this).children("td").children("input.paramValue").val();if(paramName!==undefined&&paramName!==null&&paramName!==""&&paramValue!==undefined&&paramValue!==null&&paramValue!==""){paramJson[paramName]=paramValue;}});objAttr={};objAttr.objectParams=paramJson;if(objectSource!==undefined&&objectSource!==null&&objectSource!==""){objAttr.objectData=objectSource;if(objectType!==undefined&&objectType!==null&&objectType!==""){objAttr.objectType=objectType;}else{objAttr.objectType=null;}
if(objectName!==undefined&&objectName!==null&&objectName!==""){objAttr.objectName=objectName;}else{objAttr.objectName=null;}
if(objectClass!==undefined&&objectClass!==null&&objectClass!==""){objAttr.objectClass=objectClass;}else{objAttr.objectClass=objectClass;}
if(objectAlignment!==undefined&&objectAlignment!==null&&objectAlignment!==""){objAttr.objectAlignment=objectAlignment;}else{objAttr.objectAlignment=null;}
if(objectWidth!==undefined&&objectWidth!==null&&objectWidth!==""){objAttr.objectWidth=objectWidth;objAttr.objectWidthUnit="px";}else{objAttr.objectWidth=null;objAttr.objectWidthUnit="px";}
if(objectHeight!==undefined&&objectHeight!==null&&objectHeight!==""){objAttr.objectHeight=objectHeight;objAttr.objectHeightUnit="px";}else{objAttr.objectHeight=null;objAttr.objectHeightUnit="px";}
if(objectCodeBase!==undefined&&objectCodeBase!==null&&objectCodeBase!==""){objAttr.objectCodeBase=objectCodeBase;}else{objAttr.objectCodeBase=null;}
if(objectAltHTML!==undefined&&objectAltHTML!==null&&objectAltHTML!==""){objAttr.objectAlt=objectAltHTML;}else{objAttr.objectAlt=null;}
dialogJSObj.setEnabled(true);dialogJSObj.invokeAction("object-properties",jQuery.toJSON(objAttr));dialogJSObj.Helper.hideDialog();dialogJSObj.Helper.setUserPreferences({"insertobjectdialog":objAttr});}
else{}}
jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);dialogJSObj.Helper.showDialog();dialogJSObj.Helper.createParameterWidget("#object_parameter_container_"+cId,objectParams);dialogJSObj.Helper.dialogCreateTabs();};this.generalColorDialog=function(dialogJSObj,updateElement,title){var html=dialogJSObj.Helper.DialogHTMLMap["generalColor"];cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,title,"modalDialog2_",false);dialogJSObj.Helper.createColorSelectTable(dialogJSObj.Helper.defaultColors,"generalColor_default_color_table_"+cId);combinedColors=[];addedColors=[];for(i=0;i<dialogJSObj.Helper.config.presetcolors.color.length;i++){combinedColors.push(dialogJSObj.Helper.config.presetcolors.color[i]);}
upcolors=dialogJSObj.Helper.getUserPreferences("colordialog");if(upcolors!==null){for(i=0;i<upcolors.length;i++){combinedColors.push(upcolors[i]);}}
dialogJSObj.Helper.createColorSelectTable(combinedColors,"generalColor_custom_color_table_"+cId);jQuery("#colorPicker_"+cId).ColorPicker({color:'#0000ff',onShow:function(colpkr){jQuery(colpkr).fadeIn(100);return false;},onHide:function(colpkr){jQuery(colpkr).fadeOut(100);return false;},onChange:function(hsb,hex,rgb){jQuery("#colorPicker_"+cId).css('backgroundColor','#'+hex);jQuery("#colorPicker_"+cId).attr('name','#'+hex);jQuery("#hexvalue_"+cId).val("#"+hex);}});jQuery("#generalColor_default_color_table_"+cId+" button").each(function(index,value){jQuery(this).bind('click',this,function(e){jQuery(updateElement).css("backgroundColor",e.data.name);jQuery(updateElement).attr("name",e.data.name);dialogJSObj.Helper.hideDialog("modalDialog2_",false);if(addedColors.length>0){dialogJSObj.Helper.setUserPreferences({"colordialog":addedColors});}
addedColors=[];});});jQuery("#generalColor_custom_color_table_"+cId+" button").each(function(index,value){jQuery(this).bind("click",this,function(e){jQuery(updateElement).css("backgroundColor",e.data.name);jQuery(updateElement).attr("name",e.data.name);dialogJSObj.Helper.hideDialog("modalDialog2_",false);if(addedColors.length>0){dialogJSObj.Helper.setUserPreferences({"colordialog":addedColors});}
addedColors=[];});});jQuery("#colorSelectorSubmit_"+cId).bind("click",function(){color=jQuery("#colorPicker_"+cId).attr('name');jQuery(updateElement).css("backgroundColor",color);jQuery(updateElement).attr("name",color);dialogJSObj.Helper.hideDialog("modalDialog2_",false);if(addedColors.length>0){dialogJSObj.Helper.setUserPreferences({"colordialog":addedColors});}
addedColors=[];});jQuery("#colorSelectorAdd_"+cId).bind("click",function(){color=jQuery("#colorPicker_"+cId).attr('name');colorObject={"rgb":color,"desc":color};addedColors.push(colorObject);combinedColors.push(colorObject);jQuery("#generalColor_custom_color_table_"+cId).html("");dialogJSObj.Helper.createColorSelectTable(combinedColors,"generalColor_custom_color_table_"+cId);if(addedColors.length>0){dialogJSObj.Helper.setUserPreferences({"colordialog":addedColors});}
addedColors=[];jQuery("#generalColor_custom_color_table_"+cId+" button").each(function(index,value){jQuery(this).bind("click",this,function(e){jQuery(updateElement).css("backgroundColor",e.data.name);jQuery(updateElement).attr("name",e.data.name);dialogJSObj.Helper.hideDialog("modalDialog2_",false);});});});var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CANCEL_BUTTON]=function(){dialogJSObj.Helper.hideDialog("modalDialog2_",false);}
buttons[dialogJSObj.Helper.LocaleObject.L_REMOVE_COLOR]=function(){dialogJSObj.Helper.hideDialog("modalDialog2_",false);jQuery(updateElement).css("backgroundColor","");jQuery(updateElement).attr("name","none");}
jQuery("#modalDialog2_"+cId).dialog('option','buttons',buttons);dialogJSObj.Helper.showDialog("modalDialog2_",false);dialogJSObj.Helper.dialogCreateTabs("modalDialog2_");index=0;if(dialogJSObj.Helper.config.allowdefaultcolors!==undefined&&dialogJSObj.Helper.config.allowdefaultcolors!="false"){}
else{jQuery("#generalColor_default_color_table_"+cId).parents("td.ribbonPanel").remove();}
if(dialogJSObj.Helper.config.allowpresetcolors!==undefined&&dialogJSObj.Helper.config.allowpresetcolors!="false"){}
else{jQuery("#generalColor_custom_color_table_"+cId).parents("td.ribbonPanel").remove();}
if(dialogJSObj.Helper.config.allowfreecolors!==undefined&&dialogJSObj.Helper.config.allowfreecolors!="false"){}
else{jQuery("#colorPicker_"+cId).parents("td.ribbonPanel").remove();}};this.changeLanguageDialog=function(dialogJSObj){var html=dialogJSObj.Helper.DialogHTMLMap["changeLanguage"];cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,dialogJSObj.Helper.LocaleObject.L_CHANGE_LANGUAGE_DIALOG);var langNames=dialogJSObj.Helper.jsWrapperObj.getLanguageNames();var langCodes=dialogJSObj.Helper.jsWrapperObj.getLanguageCodes();var fragmentLang=dialogJSObj.getFragmentLanguage();var documentLang=dialogJSObj.getDocumentLanguage();for(i=0;i<langNames.length;i++){if(langCodes[i]===fragmentLang){jQuery("#selectFragmentLanguage_"+cId).append("<option value=\""+langCodes[i]+"\" selected=\"selected\">"+langNames[i]+"</option>");}else{jQuery("#selectFragmentLanguage_"+cId).append("<option value=\""+langCodes[i]+"\">"+langNames[i]+"</option>");}
if(langCodes[i]==documentLang){jQuery("#selectDocumentLanguage_"+cId).append("<option value=\""+langCodes[i]+"\" selected=\"selected\">"+langNames[i]+"</option>");}else{jQuery("#selectDocumentLanguage_"+cId).append("<option value=\""+langCodes[i]+"\">"+langNames[i]+"</option>");}}
var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CLOSE_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
buttons[dialogJSObj.Helper.LocaleObject.L_APPLY_BUTTON]=function(){var fragmentCode=jQuery("#selectFragmentLanguage_"+cId).val();var documentCode=jQuery("#selectDocumentLanguage_"+cId).val();dialogJSObj.setEnabled(true);if(fragmentCode!==fragmentLang){dialogJSObj.invokeAction("live-fragment-language",fragmentCode);}
if(documentCode!==documentLang){dialogJSObj.invokeAction("live-document-language",documentCode);}
dialogJSObj.Helper.hideDialog();}
jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);dialogJSObj.Helper.showDialog();dialogJSObj.Helper.dialogCreateTabs();};this.pagePropertiesDialog=function(dialogJSObj){var html=dialogJSObj.Helper.DialogHTMLMap["pageProperties"];cId=dialogJSObj.Helper.containerId;dialogJSObj.Helper.createDialog(html,dialogJSObj.Helper.LocaleObject.L_PAGE_PROPERTIES_DIALOG);var prop=dialogJSObj.Helper.jsWrapperObj.getPageProperties();if(prop!==""){var pageProperties=jQuery.evalJSON(prop);if(pageProperties.title!==undefined&&pageProperties.title!==""){jQuery("#pageproperties_title_field_"+cId).val(pageProperties.title);}
if(pageProperties.base!==undefined&&pageProperties.base!==""){jQuery("#pageproperties_base_field_"+cId).val(pageProperties.base);}
if(pageProperties.color!==undefined&&pageProperties.color!==""){jQuery("#pageproperties_text_color_"+cId).css({"background-color":pageProperties.color});jQuery("#pageproperties_text_color_"+cId).attr("name",pageProperties.color);}
if(pageProperties.bgcolor!==undefined&&pageProperties.bgcolor!==""){jQuery("#pageproperties_background_color_"+cId).css({"background-color":pageProperties.bgcolor});jQuery("#pageproperties_background_color_"+cId).attr("name",pageProperties.bgcolor);}
if(pageProperties.bgimage!==undefined&&pageProperties.bgimage!==""){pageProperties.bgimage=pageProperties.bgimage.replace(/url\(/g,"");pageProperties.bgimage=pageProperties.bgimage.replace(/\)/g,"");jQuery("#background_image_field_"+cId).val(pageProperties.bgimage);}}
jQuery("#pageproperties_text_color_"+cId).bind("click",function(){dialogJSObj.CustomJSActions.generalColorDialog(dialogJSObj,"#pageproperties_text_color_"+cId,dialogJSObj.Helper.LocaleObject.L_PAGE_PROPERTIES_TEXT_COLOR);});jQuery("#pageproperties_background_color_"+cId).bind("click",function(){dialogJSObj.CustomJSActions.generalColorDialog(dialogJSObj,"#pageproperties_background_color_"+cId,dialogJSObj.Helper.LocaleObject.L_PAGE_PROPERTIES_BACKGROUND_COLOR);});dialogJSObj.Helper.bindOpenFileDialog("#background_image_open_file_button_"+cId,"#background_image_field_"+cId,"image");dialogJSObj.Helper.bindOpenWebdavDialog("#background_image_open_webdav_button_"+cId,"#background_image_field_"+cId,"get-webdav-image");if(!dialogJSObj.isActionEnabled("get-webdav-image")){jQuery("#background_image_open_webdav_button_"+cId).hide();}
var buttons={};buttons[dialogJSObj.Helper.LocaleObject.L_CANCEL_BUTTON]=function(){dialogJSObj.Helper.hideDialog();}
buttons[dialogJSObj.Helper.LocaleObject.L_APPLY_BUTTON]=function(){var pageProperties={};var title=jQuery("#pageproperties_title_field_"+cId).val();var base=jQuery("#pageproperties_base_field_"+cId).val();var textColor=jQuery("#pageproperties_text_color_"+cId).attr("name");var backgroundColor=jQuery("#pageproperties_background_color_"+cId).attr("name");var backgroundImage=jQuery("#background_image_field_"+cId).val();if(title!==undefined&&title!==""){pageProperties.title=title;}
if(base!==undefined&&base!==""){pageProperties.base=base;}
if(textColor!==undefined&&textColor!==""){if(textColor==="none"){pageProperties.color=null;}else{pageProperties.color=textColor;}}
if(backgroundColor!==undefined&&backgroundColor!==""){if(backgroundColor==="none"){pageProperties.bgcolor=null;}else{pageProperties.bgcolor=backgroundColor;}}
if(backgroundImage!==undefined&&backgroundImage!==""){pageProperties.bgimage=backgroundImage;}
dialogJSObj.setEnabled(true);dialogJSObj.getObj().setPageProperties(jQuery.toJSON(pageProperties));dialogJSObj.Helper.hideDialog();}
jQuery("#modalDialog_"+cId).dialog('option','buttons',buttons);dialogJSObj.Helper.showDialog();dialogJSObj.Helper.dialogCreateTabs();};};eongApplication.DOMElements=function(DOMElementsHelper,DOMElementsLogger){this.enableToolbar=function(){jQuery("#"+DOMElementsHelper.containerId+"_toolbar_container").data("disabled.tabs",[]);};this.createToolbar=function(fake){if(this.detachedUI){this.toolbarWidth=DOMElementsHelper.detachableUI.toolbar.options.width;}else{if(!isNaN(DOMElementsHelper.containerWidth)||(DOMElementsHelper.containerWidth.indexOf("%")>0)){if(DOMElementsHelper.isMSIE){this.toolbarWidth=(DOMElementsHelper.containerWidth-7)+"px";}else if(DOMElementsHelper.isWebKit){this.toolbarWidth=(DOMElementsHelper.containerWidth-5)+"px";}else{this.toolbarWidth=(DOMElementsHelper.containerWidth-6)+"px";}}}
if(fake){this.Toolbar.createToolBar(this.toolbarWidth,DOMElementsHelper.containerId,fake);jQuery("#"+DOMElementsHelper.containerId+"_ribbon_tab_container li, #"+DOMElementsHelper.containerId+"_toolbar_container .ui-tabs-panel").css({visibility:"hidden"});if(DOMElementsHelper.isMac||(!DOMElementsHelper.isMac&&DOMElementsHelper.isWebKit)){var toolbarHeight=115;}else{var toolbarHeight=119;}
if(DOMElementsHelper.config.hidesingletabs!==undefined&&DOMElementsHelper.config.hidesingletabs==="true"){if(DOMElementsHelper.uiconfig.toolbar.ribbons.elements!==undefined&&jQuery(DOMElementsHelper.uiconfig.toolbar.ribbons.elements).length===1){jQuery("#"+DOMElementsHelper.containerId+"_ribbon_tab_container").hide();if(DOMElementsHelper.isMac||(!DOMElementsHelper.isMac&&DOMElementsHelper.isWebKit)){toolbarHeight-=23;}else{toolbarHeight-=25;}
jQuery("#iconContainer_"+DOMElementsHelper.containerId).hide();}}
if(DOMElementsHelper.config.hidetoolbarpaneldescription!==undefined&&DOMElementsHelper.config.hidetoolbarpaneldescription==="true"){jQuery(".ribbonPanelDescription").hide();if(DOMElementsHelper.isMac||(!DOMElementsHelper.isMac&&DOMElementsHelper.isWebKit)){toolbarHeight-=15;}else{toolbarHeight-=16;}}
jQuery("#"+DOMElementsHelper.containerId+"_toolbar").css({"min-height":toolbarHeight+"px"});}else{jQuery("#"+DOMElementsHelper.containerId+"_toolbar").html("");this.Toolbar.createToolBar(this.toolbarWidth,DOMElementsHelper.containerId,fake);if(DOMElementsHelper.config.hidesingletabs!==undefined&&DOMElementsHelper.config.hidesingletabs==="true"){if(DOMElementsHelper.uiconfig.toolbar.ribbons.elements!==undefined&&jQuery(DOMElementsHelper.uiconfig.toolbar.ribbons.elements).length===1){jQuery("#"+DOMElementsHelper.containerId+"_ribbon_tab_container").hide();jQuery("#iconContainer_"+DOMElementsHelper.containerId).hide();}}
if(DOMElementsHelper.config.hidetoolbarpaneldescription!==undefined&&DOMElementsHelper.config.hidetoolbarpaneldescription==="true"){jQuery(".ribbonPanelDescription").hide();}
DOMElementsLogger.log("[assembleDOM]: attaching events","FINEST",this);jQuery('.editorAction_'+DOMElementsHelper.containerId).each(function(i){DOMElementsHelper.jsObj.attachEventToElement(this,DOMElementsHelper.jsObj);});}}
this.assembleDOM=function(){DOMElementsLogger.log("[assembleDOM]: setting application container","FINEST",this);if(DOMElementsHelper.config.detachableUI!==undefined){DOMElementsHelper.detachableUI=DOMElementsHelper.config.detachableUI;}else{DOMElementsHelper.detachableUI={};}
this.setApplicationContainer();DOMElementsLogger.log("[assembleDOM]: setting statusbar","FINEST",this);if(DOMElementsHelper.config.enablestatusbar===undefined||DOMElementsHelper.config.enablestatusbar=="true"||DOMElementsHelper.config.enablestatusbar===true){this.setStatusBar();}
DOMElementsLogger.log("[assembleDOM]: creating toolbar object","FINEST",this);this.Toolbar=new eongApplication.Toolbar(DOMElementsHelper,DOMElementsLogger);DOMElementsLogger.log("[assembleDOM]: creating toolbar","FINEST",this);if(DOMElementsHelper.config.saveuistate!==undefined&&DOMElementsHelper.config.saveuistate=="true"){this.createToolbar(true);}else{this.createToolbar(false);}
DOMElementsLogger.log("[assembleDOM]: setting sidebar","FINEST",this);if(DOMElementsHelper.config.enablestyletemplatepanel===undefined||DOMElementsHelper.config.enablestyletemplatepanel=="true"||DOMElementsHelper.config.enablestyletemplatepanel===true){this.setSidebar();}
DOMElementsLogger.log("[assembleDOM]: setting applet container","FINEST",this);this.setAppletContainer();DOMElementsLogger.log("[assembleDOM]: applying layout","FINEST",this);this.applyLayout();var tabBarWidth=15;jQuery("#"+DOMElementsHelper.containerId+"_ribbon_tab_container").children().each(function(){tabBarWidth+=jQuery(this).outerWidth()+2;});tabBarWidth+=jQuery("#iconContainer_"+DOMElementsHelper.containerId).outerWidth();var statusBarWidth=0;jQuery("#"+DOMElementsHelper.containerId+"_statusbar .statusBarCell").each(function(){if(jQuery(this).css("display")!=="none"){statusBarWidth+=jQuery(this).outerWidth();}});statusBarWidth-=jQuery("#"+DOMElementsHelper.containerId+"_statusbar .documentPaletteContainer").outerWidth()+8;var maxPanelWidth=0;jQuery("#"+DOMElementsHelper.containerId+"_toolbar div.dialogPanels").each(function(){var currentPanelWidth=0;jQuery(this).children("div.ribbonPanel").each(function(){currentPanelWidth+=jQuery(this).outerWidth()+2;});if(currentPanelWidth>maxPanelWidth){maxPanelWidth=currentPanelWidth;}});var minResizeWidth=Math.max(tabBarWidth,statusBarWidth,maxPanelWidth);if(!this.detachedUI){if(DOMElementsHelper.config.draggable!==undefined&&DOMElementsHelper.config.draggable=="true"){DOMElementsLogger.log("[assembleDOM]: setting draggable","FINEST",this);this.setDraggable();}
if(DOMElementsHelper.config.resizable!==undefined&&DOMElementsHelper.config.resizable=="true"){DOMElementsLogger.log("[assembleDOM]: setting resizable","FINEST",this);this.setResizable(minResizeWidth);}}
DOMElementsLogger.log("[assembleDOM]: loading applet","FINEST",this);if(jQuery("#modalDialog_"+DOMElementsHelper.containerId).length==0){jQuery("body").append("<div id=\"modalDialog_"+DOMElementsHelper.containerId+"\" class=\"modalDialog ui-tabs ui-widget ui-widget-content ui-corner-all ui-dialog-content\" style=\"height: 1px; display:none;\"></div>");}
this.loadApplet();jQuery("#"+DOMElementsHelper.containerId+"_div").width((DOMElementsHelper.parseNumber(DOMElementsHelper.editorWidth)));var width=jQuery("#"+DOMElementsHelper.id).width();var height=jQuery("#"+DOMElementsHelper.id).height();if(DOMElementsHelper.isMSIE&&DOMElementsHelper.BrowserVersion!=="8.0"){jQuery("#"+DOMElementsHelper.containerId+"_div").append("<div class=\"ui-state-normal\" id=\"replacementImage_"+DOMElementsHelper.containerId+"\" border=\"0\" style=\"position: absolute; top: 0; left: 0; padding: 5px; font-size: 16px; display: none; width: "+width+"px; height: "+height+"px;\"><p>Your browser does not support BASE64 images, which are necessary to display content of the editor while a HTML dialog is open.</p><p>If you are using IE 8 please make sure to deactivate the \"Compatibility Mode\" when using edit-on NG.</p></div>");}else{jQuery("#"+DOMElementsHelper.containerId+"_div").append("<img id=\"replacementImage_"+DOMElementsHelper.containerId+"\" border=\"0\" style=\"position: absolute; top: 0; left: 0; display: none;\" width=\""+width+"\" height=\""+height+"\"src=\"\" />");}
DOMElementsHelper.initialOffset=jQuery("#"+DOMElementsHelper.containerId).offset();if(this.isMac){DOMElementsHelper.resizeUI();}};this.assembleDOMPreload=function(){jQuery("body").append(this.getPreloadAppletElement);};this.setDraggable=function(){jQuery("#"+DOMElementsHelper.containerId).draggable({ghost:true,animate:true,handle:"#dragHandler_"+DOMElementsHelper.containerId,stop:function(ui,e){DOMElementsHelper.resizeUI(true);DOMElementsHelper.jsWrapperObj.requestFocus();}});};this.setResizable=function(minResizeWidth){jQuery("#"+DOMElementsHelper.containerId).resizable({minWidth:minResizeWidth,minHeight:jQuery("#"+DOMElementsHelper.containerId+"_toolbar").height()+jQuery("#"+DOMElementsHelper.containerId+"_statusbar").height()+40,handles:{se:".seHandle"},resize:function(event,ui){DOMElementsHelper.resizeUI();DOMElementsHelper.jsWrapperObj.requestFocus();jQuery("#"+DOMElementsHelper.containerId).offset(DOMElementsHelper.initialOffset);}});};this.getAppletElement=function(){if(window.navigator.javaEnabled()){if(DOMElementsHelper.isMSIE){if(DOMElementsHelper.tagStyle==DOMElementsHelper.OBJECT_TAG){DOMElementsHelper.addAttribute("classid","clsid:8AD9C840-044E-11D1-B3E9-00805F499D93");}
if(DOMElementsHelper.isJREAutoDownloadEnabled){DOMElementsHelper.addAttribute("codebase",DOMElementsHelper.jreAutoDownloadURL+DOMElementsHelper.jreMinVersion);}}else{if(DOMElementsHelper.tagStyle==DOMElementsHelper.OBJECT_TAG){DOMElementsHelper.addAttribute("classid","java:"+DOMElementsHelper.code);}else{DOMElementsHelper.addAttribute("code",DOMElementsHelper.code);}}
if(DOMElementsHelper.enablePack200){DOMElementsHelper.setParam("java_arguments",DOMElementsHelper.maxMemory+" "+DOMElementsHelper.pack200);}else{DOMElementsHelper.setParam("java_arguments",DOMElementsHelper.maxMemory);}
if(!isNaN(DOMElementsHelper.parseNumber(DOMElementsHelper.editorWidth))){DOMElementsHelper.editorWidth--;}
if(!isNaN(DOMElementsHelper.parseNumber(DOMElementsHelper.editorHeight))){DOMElementsHelper.editorHeight--;}
var toolbarHeight=0;var statusBarHeight=0;if(!this.detachedUI){toolbarHeight=jQuery("#"+DOMElementsHelper.containerId+"_toolbar").css("min-height");if(DOMElementsHelper.config.enablestatusbar===undefined||DOMElementsHelper.config.enablestatusbar=="true"){statusBarHeight=jQuery("#"+DOMElementsHelper.containerId+"_statusbar").height();}else{statusBarHeight=0;}}
var reduceHeight=parseInt(toolbarHeight,10)+parseInt(statusBarHeight,10);if(DOMElementsHelper.isMSIE){reduceHeight=reduceHeight-1;}else
if(DOMElementsHelper.isWebKit){reduceHeight=reduceHeight-1;}else{reduceHeight=reduceHeight-1;}
var sideBarWidth=parseInt(jQuery("#"+DOMElementsHelper.containerId+"_sidebar").css("width"),10);var sideBarVisible=jQuery("#"+DOMElementsHelper.containerId+"_sidebar").css("display");if(sideBarVisible=="none"||sideBarVisible===undefined){reduceWidth=0;}else{reduceWidth=sideBarWidth+7;}
if(DOMElementsHelper.config.enablestyletemplatepanel===undefined||DOMElementsHelper.config.enablestyletemplatepanel=="true"||DOMElementsHelper.config.enablestyletemplatepanel===true){DOMElementsHelper.addAttribute("width",DOMElementsHelper.parseNumber(DOMElementsHelper.editorWidth-reduceWidth));}else{DOMElementsHelper.addAttribute("width",DOMElementsHelper.parseNumber(DOMElementsHelper.editorWidth));}
DOMElementsHelper.addAttribute("height",DOMElementsHelper.parseNumber(DOMElementsHelper.editorHeight-reduceHeight));DOMElementsHelper.addAttribute("id",DOMElementsHelper.id);DOMElementsHelper.addAttribute("name",DOMElementsHelper.appletName);DOMElementsHelper.setParam("jsobject",DOMElementsHelper.jsObjName);if(DOMElementsHelper.isMac||DOMElementsHelper.isWebKit){DOMElementsHelper.tagStyle=DOMElementsHelper.APPLET_TAG;DOMElementsHelper.addAttribute("codebase",DOMElementsHelper.codebase);DOMElementsHelper.addAttribute("code",DOMElementsHelper.code);DOMElementsHelper.setParam("type","application/x-java-applet;version=1.5");}else{DOMElementsHelper.setParam("java_codebase",DOMElementsHelper.codebase);DOMElementsHelper.setParam("java_code",DOMElementsHelper.code);DOMElementsHelper.setParam("java_type","application/x-java-applet;version=1.5");}
var elem="";if(DOMElementsHelper.tagStyle==DOMElementsHelper.OBJECT_TAG){DOMElementsHelper.setParam("mayscript","true");DOMElementsHelper.setParam("scriptable","true");elem="object";}else if(DOMElementsHelper.tagStyle==DOMElementsHelper.APPLET_TAG){DOMElementsHelper.addAttribute("mayscript","true");DOMElementsHelper.addAttribute("scriptable","true");elem="applet";}
DOMElementsHelper.setParam("image",DOMElementsHelper.codebase+"/splashscreen.gif");DOMElementsHelper.setParam("centerimage","true");DOMElementsHelper.setParam("boxborder","false");DOMElementsHelper.setParam("codebase_lookup","false");appletElement="<"+elem;appletElement+=DOMElementsHelper.attribs;appletElement+=">";appletElement+=DOMElementsHelper.params;appletElement+="</"+elem+">";return appletElement;}else{var toolbarHeight=0;var statusBarHeight=0;if(!this.detachedUI){toolbarHeight=jQuery("#"+DOMElementsHelper.containerId+"_toolbar").height();statusBarHeight=jQuery("#"+DOMElementsHelper.containerId+"_statusbar").height();}
var reduceHeight=parseInt(toolbarHeight,10)+parseInt(statusBarHeight,10);if(DOMElementsHelper.isMSIE){reduceHeight=reduceHeight-1;}else
if(DOMElementsHelper.isWebKit){reduceHeight=reduceHeight-3;}else{reduceHeight=reduceHeight-1;}
var sideBarWidth=parseInt(jQuery("#"+DOMElementsHelper.containerId+"_sidebar").css("width"),10);var sideBarVisible=jQuery("#"+DOMElementsHelper.containerId+"_sidebar").css("display");if(sideBarVisible=="none"||sideBarVisible===undefined){reduceWidth=0;}else{reduceWidth=sideBarWidth+7;}
if(DOMElementsHelper.config.enablestyletemplatepanel===undefined||DOMElementsHelper.config.enablestyletemplatepanel=="true"||DOMElementsHelper.config.enablestyletemplatepanel===true){var width=DOMElementsHelper.editorWidth-(reduceWidth+13);}else{var width=DOMElementsHelper.editorWidth-13;}
var height=DOMElementsHelper.editorHeight-reduceHeight;var replaceAppletElement="<div class='ui-state-error' style='width: "+width+"px; height:"+height+"px; padding: 5px;'>";replaceAppletElement+="<h2 style='text-align: center; font-size: 12pt !important;'>Error: Java is not enabled</h2>";replaceAppletElement+="<p><a href='#' onclick='deployJava.installLatestJRE();'>Update to latest Java version</a></p>";replaceAppletElement+="</div>";return replaceAppletElement;}};this.getPreloadAppletElement=function(){if(window.navigator.javaEnabled()){if(DOMElementsHelper.isMSIE){if(DOMElementsHelper.tagStyle==DOMElementsHelper.OBJECT_TAG){DOMElementsHelper.addAttribute("classid","clsid:8AD9C840-044E-11D1-B3E9-00805F499D93");}
if(DOMElementsHelper.isJREAutoDownloadEnabled){DOMElementsHelper.addAttribute("codebase",DOMElementsHelper.jreAutoDownloadURL+DOMElementsHelper.jreMinVersion);}}else{if(DOMElementsHelper.tagStyle==DOMElementsHelper.OBJECT_TAG){DOMElementsHelper.addAttribute("classid","java:"+DOMElementsHelper.code);}else{DOMElementsHelper.addAttribute("code",DOMElementsHelper.code);}}
if(DOMElementsHelper.enablePack200){DOMElementsHelper.setParam("java_arguments",DOMElementsHelper.pack200+" "+DOMElementsHelper.maxMemory);}else{DOMElementsHelper.setParam("java_arguments",DOMElementsHelper.maxMemory);}
DOMElementsHelper.addAttribute("width",DOMElementsHelper.parseNumber(DOMElementsHelper.editorWidth));DOMElementsHelper.addAttribute("height",DOMElementsHelper.parseNumber(DOMElementsHelper.editorHeight));DOMElementsHelper.addAttribute("id",DOMElementsHelper.id);DOMElementsHelper.addAttribute("name",DOMElementsHelper.appletName);if(DOMElementsHelper.isMac||DOMElementsHelper.isWebKit){DOMElementsHelper.tagStyle=DOMElementsHelper.APPLET_TAG;DOMElementsHelper.addAttribute("codebase",DOMElementsHelper.codebase);DOMElementsHelper.addAttribute("code",DOMElementsHelper.code);DOMElementsHelper.setParam("type","application/x-java-applet;version=1.5");}else{DOMElementsHelper.setParam("java_codebase",DOMElementsHelper.codebase);DOMElementsHelper.setParam("java_code",DOMElementsHelper.code);DOMElementsHelper.setParam("java_type","application/x-java-applet;version=1.5");}
var elem="";if(DOMElementsHelper.tagStyle==DOMElementsHelper.OBJECT_TAG){DOMElementsHelper.setParam("mayscript","true");DOMElementsHelper.setParam("scriptable","true");elem="object";}else if(DOMElementsHelper.tagStyle==DOMElementsHelper.APPLET_TAG){DOMElementsHelper.addAttribute("mayscript","true");DOMElementsHelper.addAttribute("scriptable","true");elem="applet";}
DOMElementsHelper.setParam("codebase_lookup","false");appletElement="<"+elem;appletElement+=DOMElementsHelper.attribs;appletElement+=">";appletElement+=DOMElementsHelper.params;appletElement+="</"+elem+">";return appletElement;}else{var width=DOMElementsHelper.editorWidth;var height=DOMElementsHelper.editorHeight;var replaceAppletElement="<div class='ui-state-error' style='width: "+width+"px; height:"+height+"px; padding: 5px;'>";replaceAppletElement+="<h2 style='text-align: center; font-size: 12pt !important;'>Error: Java is not enabled</h2>";replaceAppletElement+="<p><a href='#' onclick='deployJava.installLatestJRE();'>Update to latest Java version</a></p>";replaceAppletElement+="</div>";return replaceAppletElement;}};this.setApplicationContainer=function(){this.detachedUI=false;jQuery("#"+DOMElementsHelper.containerId).addClass("eongmainstyles");jQuery("#"+DOMElementsHelper.containerId).css({width:DOMElementsHelper.editorWidth+"px"});if(DOMElementsHelper.detachableUI.enabled!==undefined&&(DOMElementsHelper.detachableUI.enabled==="true"||DOMElementsHelper.detachableUI.enabled===true)){jQuery(""+DOMElementsHelper.detachableUI.toolbar.options.location).append("<div id=\""+DOMElementsHelper.containerId+"_detachedToolBarContainer\" style=\""+DOMElementsHelper.detachableUI.toolbar.options.style+"\"></div>");jQuery("#"+DOMElementsHelper.containerId+"_detachedToolBarContainer").append("<div id=\""+DOMElementsHelper.containerId+"_toolbar\"></div>");jQuery("#"+DOMElementsHelper.containerId+"_detachedToolBarContainer").css({width:DOMElementsHelper.detachableUI.toolbar.options.width});jQuery("#"+DOMElementsHelper.containerId+"_detachedToolBarContainer").addClass("eongmainstyles");this.detachedUI=true;if(jQuery("#"+DOMElementsHelper.containerId+"_virtualCaret").length==0){jQuery("body").append("<div id=\""+DOMElementsHelper.containerId+"_virtualCaret\" class=\"virtualCaret\">&nbsp;</div>");jQuery("#"+DOMElementsHelper.containerId+"_virtualCaret").css({});}}else{jQuery("#"+DOMElementsHelper.containerId).append("<div id=\""+DOMElementsHelper.containerId+"_toolbar\"></div>");}
jQuery("#"+DOMElementsHelper.containerId).append("<div id=\"applicationContainer_"+DOMElementsHelper.containerId+"\"></div>");jQuery("#applicationContainer_"+DOMElementsHelper.containerId).css({width:DOMElementsHelper.editorWidth+"px",height:DOMElementsHelper.editorHeight+"px"});if(!this.detachedUI){jQuery("#"+DOMElementsHelper.containerId+"_toolbar").css({width:DOMElementsHelper.editorWidth+"px"});}else{jQuery("#"+DOMElementsHelper.containerId+"_toolbar").css({width:DOMElementsHelper.detachableUI.toolbar.options.width});}};this.setSidebar=function(){content="<div id=\""+DOMElementsHelper.containerId+"_sidebar\">";content+="<div class=\"sidebar_header ui-widget-header\" id=\""+DOMElementsHelper.containerId+"_sidebar_header\">";content+="<div class=\"headerContent\">Style Templates</div>";content+="</div>";content+="<div class=\"ui-layout-content\" id=\""+DOMElementsHelper.containerId+"_sidebar_content\"></div>";content+="</div>";jQuery("#applicationContainer_"+DOMElementsHelper.containerId).append(content);jQuery("#"+DOMElementsHelper.containerId+"_sidebar").addClass("ui-layout-west");};this.setAppletContainer=function(){DOMElementsLogger.log("[setAppletContainer]: appending applet div","ALL",this);jQuery("#applicationContainer_"+DOMElementsHelper.containerId).append("<div id=\""+DOMElementsHelper.appletName+"_div\"></div>");DOMElementsLogger.log("[setAppletContainer]: setting div atributes","ALL",this);jQuery("#"+DOMElementsHelper.appletName+"_div").attr({name:DOMElementsHelper.appletName+"_div"});DOMElementsLogger.log("[setAppletContainer]: Adjusting the size: getting information","ALL",this);var toolbarHeight=0;var statusBarHeight=0;if(!this.detachedUI){toolbarHeight=jQuery("#"+DOMElementsHelper.containerId+"_toolbar").css("min-height");if(DOMElementsHelper.config.enablestatusbar===undefined||DOMElementsHelper.config.enablestatusbar=="true"){statusBarHeight=jQuery("#"+DOMElementsHelper.containerId+"_statusbar").height();}else{statusBarHeight=0;}}
var reduceHeight=parseInt(toolbarHeight,10)+parseInt(statusBarHeight,10);var reducedHeight=parseInt(DOMElementsHelper.containerHeight,10)-reduceHeight;DOMElementsLogger.log("[setAppletContainer]: New size reducedHeight: "+reducedHeight+", containerWidth: "+DOMElementsHelper.containerWidth,"ALL",this);DOMElementsLogger.log("[setAppletContainer]: Adjusting the size: setting new size","ALL",this);jQuery("#"+DOMElementsHelper.appletName+"_div").addClass("ui-layout-center");jQuery("#"+DOMElementsHelper.appletName+"_div").css({width:(DOMElementsHelper.parseNumber(DOMElementsHelper.editorWidth))+"px",height:reducedHeight+"px",padding:"0",margin:"0"});DOMElementsLogger.log("[setAppletContainer]: Adjusted size","ALL",this);};this.loadApplet=function(){el=this.getAppletElement();jQuery("#"+DOMElementsHelper.appletName+"_div").append(el.toString());};this.applyLayout=function(){var toolbarHeight=0;var statusBarHeight=0;if(!this.detachedUI){toolbarHeight=jQuery("#"+DOMElementsHelper.containerId+"_toolbar").css("min-height");if(DOMElementsHelper.config.enablestatusbar===undefined||DOMElementsHelper.config.enablestatusbar=="true"){statusBarHeight=jQuery("#"+DOMElementsHelper.containerId+"_statusbar").height();}else{statusBarHeight=0;}}
var reduceHeight=parseInt(toolbarHeight,10)+parseInt(statusBarHeight,10);jQuery("#applicationContainer_"+DOMElementsHelper.containerId).css({height:DOMElementsHelper.editorHeight-reduceHeight+"px"});initClosedWest=true;initWidth=145;DOMElementsHelper.editorLayout=jQuery("#applicationContainer_"+DOMElementsHelper.containerId).layout({defaults:{closable:true,spacing_open:5,spacing_closed:5,enableCursorHotkey:false},center:{closable:false,resizable:false},west:{initClosed:initClosedWest,onopen_end:function(name,el,state){DOMElementsHelper.resizeUI(true);if(DOMElementsHelper.config.saveuistate!==undefined&&DOMElementsHelper.config.saveuistate=="true"){var stateObject=DOMElementsHelper.getUserPreferences("sidebarstate");if(stateObject===null){stateObject={};}
if(stateObject[DOMElementsHelper.getLocation()]!==undefined&&stateObject[DOMElementsHelper.getLocation()]!==null&&stateObject[DOMElementsHelper.getLocation()]!==""){if(stateObject[DOMElementsHelper.getLocation()][DOMElementsHelper.containerId]!==undefined&&stateObject[DOMElementsHelper.getLocation()][DOMElementsHelper.containerId]!==null&&stateObject[DOMElementsHelper.getLocation()][DOMElementsHelper.containerId]!==""){}else{stateObject[DOMElementsHelper.getLocation()][DOMElementsHelper.containerId]={};}}else{stateObject[DOMElementsHelper.getLocation()]={};stateObject[DOMElementsHelper.getLocation()][DOMElementsHelper.containerId]={};}
stateObject[DOMElementsHelper.getLocation()][DOMElementsHelper.containerId]["size"]=state.size;stateObject[DOMElementsHelper.getLocation()][DOMElementsHelper.containerId]["initClosed"]="false";DOMElementsHelper.setUserPreferences({"sidebarstate":stateObject});}},onclose_end:function(name,el,state){jQuery(".ui-layout-resizer").removeClass(" ui-state-disabled");DOMElementsHelper.resizeUI(true);if(DOMElementsHelper.config.saveuistate!==undefined&&DOMElementsHelper.config.saveuistate=="true"){var stateObject=DOMElementsHelper.getUserPreferences("sidebarstate");if(stateObject===null){stateObject={};}
if(stateObject[DOMElementsHelper.getLocation()]!==undefined&&stateObject[DOMElementsHelper.getLocation()]!==null&&stateObject[DOMElementsHelper.getLocation()]!==""){if(stateObject[DOMElementsHelper.getLocation()][DOMElementsHelper.containerId]!==undefined&&stateObject[DOMElementsHelper.getLocation()][DOMElementsHelper.containerId]!==null&&stateObject[DOMElementsHelper.getLocation()][DOMElementsHelper.containerId]!==""){}else{stateObject[DOMElementsHelper.getLocation()][DOMElementsHelper.containerId]={};}}else{stateObject[DOMElementsHelper.getLocation()]={};stateObject[DOMElementsHelper.getLocation()][DOMElementsHelper.containerId]={};}
stateObject[DOMElementsHelper.getLocation()][DOMElementsHelper.containerId]["size"]=state.size;stateObject[DOMElementsHelper.getLocation()][DOMElementsHelper.containerId]["initClosed"]="true";DOMElementsHelper.setUserPreferences({"sidebarstate":stateObject});}},onresize_end:function(name,el,state){if(jQuery("#"+DOMElementsHelper.containerId+"_sidebar").css("display")=="none"){}else{DOMElementsHelper.resizeUI(true);if(DOMElementsHelper.config.saveuistate!==undefined&&DOMElementsHelper.config.saveuistate=="true"){var stateObject=DOMElementsHelper.getUserPreferences("sidebarstate");if(stateObject===null){stateObject={};}
if(stateObject[DOMElementsHelper.getLocation()]!==undefined&&stateObject[DOMElementsHelper.getLocation()]!==null&&stateObject[DOMElementsHelper.getLocation()]!==""){if(stateObject[DOMElementsHelper.getLocation()][DOMElementsHelper.containerId]!==undefined&&stateObject[DOMElementsHelper.getLocation()][DOMElementsHelper.containerId]!==null&&stateObject[DOMElementsHelper.getLocation()][DOMElementsHelper.containerId]!==""){}else{stateObject[DOMElementsHelper.getLocation()][DOMElementsHelper.containerId]={};}}else{stateObject[DOMElementsHelper.getLocation()]={};stateObject[DOMElementsHelper.getLocation()][DOMElementsHelper.containerId]={};}
stateObject[DOMElementsHelper.getLocation()][DOMElementsHelper.containerId]["size"]=state.size;stateObject[DOMElementsHelper.getLocation()][DOMElementsHelper.containerId]["initClosed"]="false";DOMElementsHelper.setUserPreferences({"sidebarstate":stateObject});}}},spacing_closed:0,spacing_open:5,slidable:false,minSize:145,size:initWidth}});if(DOMElementsHelper.config.enablestyletemplatepanel===undefined||DOMElementsHelper.config.enablestyletemplatepanel=="true"||DOMElementsHelper.config.enablestyletemplatepanel===true){jQuery(".ui-layout-resizer").addClass("ui-widget-content");if(initClosedWest===false){jQuery("#"+DOMElementsHelper.containerId+"_statusbar .styleTemplateButton > div").addClass("highlight");}}
if(this.detachedUI&&DOMElementsHelper.detachableUI.toolbar.options.draggable.enabled!==undefined&&(DOMElementsHelper.detachableUI.toolbar.options.draggable.enabled==="true"||DOMElementsHelper.detachableUI.toolbar.options.draggable.enabled===true)){DOMElementsHelper.detachableUI.toolbar.options.draggable.options.handle="#"+DOMElementsHelper.containerId+"_ribbon_tab_container";jQuery("#"+DOMElementsHelper.containerId+"_detachedToolBarContainer").draggable(DOMElementsHelper.detachableUI.toolbar.options.draggable.options);}
if(this.detachedUI&&DOMElementsHelper.detachableUI.toolbar.options.transparency.enabled!==undefined&&(DOMElementsHelper.detachableUI.toolbar.options.transparency.enabled==="true"||DOMElementsHelper.detachableUI.toolbar.options.transparency.enabled===true)){jQuery("#"+DOMElementsHelper.containerId+"_detachedToolBarContainer").css({"opacity":DOMElementsHelper.detachableUI.toolbar.options.transparency.options.start});jQuery("#"+DOMElementsHelper.containerId+"_detachedToolBarContainer").bind("mouseenter",function(){jQuery("#"+DOMElementsHelper.containerId+"_detachedToolBarContainer").fadeTo(250,DOMElementsHelper.config.detachableUI.toolbar.options.transparency.options.end);});jQuery("#"+DOMElementsHelper.containerId+"_detachedToolBarContainer").bind("mouseleave",function(){jQuery("#"+DOMElementsHelper.containerId+"_detachedToolBarContainer").fadeTo(250,DOMElementsHelper.config.detachableUI.toolbar.options.transparency.options.start);});}
if(this.detachedUI&&DOMElementsHelper.detachableUI.statusbar.options.draggable.enabled!==undefined&&(DOMElementsHelper.detachableUI.statusbar.options.draggable.enabled==="true"||DOMElementsHelper.detachableUI.statusbar.options.draggable.enabled===true)){DOMElementsHelper.detachableUI.statusbar.options.draggable.options.handle="#"+DOMElementsHelper.containerId+"_statusbar table";jQuery("#"+DOMElementsHelper.containerId+"_detachedStatusBarContainer").draggable(DOMElementsHelper.detachableUI.toolbar.options.draggable.options);}
if(this.detachedUI&&DOMElementsHelper.detachableUI.statusbar.options.transparency.enabled!==undefined&&(DOMElementsHelper.detachableUI.statusbar.options.transparency.enabled==="true"||DOMElementsHelper.detachableUI.statusbar.options.transparency.enabled===true)){jQuery("#"+DOMElementsHelper.containerId+"_detachedStatusBarContainer").css({"opacity":DOMElementsHelper.detachableUI.statusbar.options.transparency.options.start});jQuery("#"+DOMElementsHelper.containerId+"_detachedStatusBarContainer").bind("mouseenter",function(){jQuery("#"+DOMElementsHelper.containerId+"_detachedStatusBarContainer").fadeTo(250,DOMElementsHelper.config.detachableUI.statusbar.options.transparency.options.end);});jQuery("#"+DOMElementsHelper.containerId+"_detachedStatusBarContainer").bind("mouseleave",function(){jQuery("#"+DOMElementsHelper.containerId+"_detachedStatusBarContainer").fadeTo(250,DOMElementsHelper.config.detachableUI.statusbar.options.transparency.options.start);});}};this.setStatusBar=function(){if(this.detachedUI&&DOMElementsHelper.detachableUI.statusbar.options.location!==undefined&&DOMElementsHelper.detachableUI.statusbar.options.location==="attachedToToolBar"){statusBarWidth=DOMElementsHelper.detachableUI.toolbar.options.width-2;jQuery("#"+DOMElementsHelper.containerId+"_detachedToolBarContainer").append("<div id=\""+DOMElementsHelper.containerId+"_statusbar\"></div>");jQuery("#"+DOMElementsHelper.containerId+"_statusbar").css({"border-top":0});jQuery("#"+DOMElementsHelper.containerId+"_statusbar").addClass("ui-widget-header ui-corner-bottom statusBar");}else if(this.detachedUI&&DOMElementsHelper.detachableUI.statusbar.options.location!==undefined){statusBarWidth=DOMElementsHelper.detachableUI.statusbar.options.width;jQuery(""+DOMElementsHelper.detachableUI.statusbar.options.location).append("<div id=\""+DOMElementsHelper.containerId+"_detachedStatusBarContainer\" style=\""+DOMElementsHelper.detachableUI.statusbar.options.style+"\"></div>");jQuery("#"+DOMElementsHelper.containerId+"_detachedStatusBarContainer").append("<div id=\""+DOMElementsHelper.containerId+"_statusbar\"></div>");jQuery("#"+DOMElementsHelper.containerId+"_detachedStatusBarContainer").css({width:DOMElementsHelper.detachableUI.statusbar.options.width});jQuery("#"+DOMElementsHelper.containerId+"_detachedStatusBarContainer").addClass("eongmainstyles");jQuery("#"+DOMElementsHelper.containerId+"_statusbar").css({"border-top":0});jQuery("#"+DOMElementsHelper.containerId+"_statusbar").addClass("ui-widget-header ui-corner-all statusBar");}else{statusBarWidth=DOMElementsHelper.editorWidth-3;jQuery("#"+DOMElementsHelper.containerId).append("<div id=\""+DOMElementsHelper.containerId+"_statusbar\"></div>");jQuery("#"+DOMElementsHelper.containerId+"_statusbar").addClass("ui-widget-header ui-corner-bottom statusBar");}
jQuery("#"+DOMElementsHelper.containerId+"_statusbar").css({"min-height":"34px","height":"34px",width:statusBarWidth});jQuery.ajax({url:DOMElementsHelper.codebase+"/../dialog/statusbar.html",cache:true,async:false,success:function(html){jQuery("#"+DOMElementsHelper.containerId+"_statusbar").append(html);jQuery("#"+DOMElementsHelper.containerId+"_statusbar td").css({"min-height":"30px","height":"30px"});if(DOMElementsHelper.config.charactercounter!==undefined&&DOMElementsHelper.config.charactercounter.enabled!==undefined&&DOMElementsHelper.config.charactercounter.enabled==="true"){var counterStr="";if(DOMElementsHelper.config.charactercounter!==undefined&&DOMElementsHelper.config.charactercounter.limit!==undefined){counterStr="0 / "+DOMElementsHelper.config.charactercounter.limit;}else{counterStr="0";}
jQuery("#"+DOMElementsHelper.containerId+"_statusbar .documentCounterDisplay").html(counterStr);}else{jQuery("#"+DOMElementsHelper.containerId+"_statusbar .documentCounterArea").parent("td").css({display:"none"});}
if(DOMElementsHelper.config.enablezoomarea!==undefined&&DOMElementsHelper.config.enablezoomarea=="false"){jQuery("#"+DOMElementsHelper.containerId+"_statusbar .zoomArea").parent("td").css({display:"none"});jQuery("#"+DOMElementsHelper.containerId+"_statusbar .zoomArea").parent("td").html("");}else if(DOMElementsHelper.config.enablezoomarea===undefined||DOMElementsHelper.config.enablezoomarea=="true"){jQuery("#"+DOMElementsHelper.containerId+"_statusbar .zoomSlider").slider({value:500,min:50,max:1000,step:1,animate:true,start:function(event,ui){noSlide=true;},slide:function(event,ui){noSlide=false;if(ui.value>=500){valuePercentage=(ui.value-500)/500;newZoom=Math.round(100+((500-100)*valuePercentage));}
else{valuePercentage=ui.value/500;newZoom=Math.round(100*valuePercentage);}
DOMElementsHelper.jsObj.invokeAction("zoom",newZoom+"%|noFocus");},stop:function(event,ui){if(!noSlide){if(ui.value>=500){valuePercentage=(ui.value-500)/500;newZoom=Math.round(100+((500-100)*valuePercentage));}
else{valuePercentage=ui.value/500;newZoom=Math.round(100*valuePercentage);}
DOMElementsHelper.jsObj.invokeAction("zoom",newZoom+"%");}}});jQuery("#"+DOMElementsHelper.containerId+"_statusbar .ui-slider-handle").attr("title",DOMElementsHelper.LocaleObject.L_ZOOM_100_DBL_CLICK_INFO);jQuery("#"+DOMElementsHelper.containerId+"_statusbar .zoomSliderDecreaseButton").append('<div class="enabled ui-widget-header transparent-border"><button class="buttonImage editorAction_'+DOMElementsHelper.containerId+' enabled" style="background-image: url('+DOMElementsHelper.resolveURL("../icons/decrease-zoom-small.png")+');" title="'+DOMElementsHelper.LocaleObject.L_DECREASE_ZOOM+'" name="decrease-zoom" type="button"/></div>');jQuery("#"+DOMElementsHelper.containerId+"_statusbar .zoomSliderIncreaseButton").append('<div class="enabled ui-widget-header transparent-border"><button class="buttonImage editorAction_'+DOMElementsHelper.containerId+' enabled" style="background-image: url('+DOMElementsHelper.resolveURL("../icons/increase-zoom-small.png")+');" title="'+DOMElementsHelper.LocaleObject.L_INCREASE_ZOOM+'" name="increase-zoom" type="button"/></div>');var dropdownArray=["ww","wh","10%","25%","50%","75%","100%","125%","150%","175%","200%","300%","400%","500%"];jQuery("#"+DOMElementsHelper.containerId).append("<div class=\"hidden\" id=\"zoomDropDownList_"+DOMElementsHelper.containerId+"\"><ul></ul></div>")
var list=jQuery("#zoomDropDownList_"+DOMElementsHelper.containerId+" ul");jQuery.each(dropdownArray,function(index,value){var displayValue=value;var useValue=value;if(value==="ww"){useValue=-1;displayValue=DOMElementsHelper.LocaleObject.L_ZOOM_MODE_WINDOW_WIDTH;}
if(value==="wh"){useValue=-2;displayValue=DOMElementsHelper.LocaleObject.L_ZOOM_MODE_WINDOW_HEIGHT;}
list.append("<li name=\""+value+"\" alt=\""+value+"\"><a href=\"#\">"+displayValue+"</a></li>");});jQuery("#"+DOMElementsHelper.containerId+"_statusbar .zoomValues").append("<div style=\"margin-right: 5px; float: left;\" id=\"zoomDropDownContainer_"+DOMElementsHelper.containerId+"\"></div>");jQuery("#zoomDropDownContainer_"+DOMElementsHelper.containerId).menu({content:jQuery("#zoomDropDownList_"+DOMElementsHelper.containerId).html(),showSpeed:200,height:300,directionV:"up",iconDirection:"up",onSelect:function(){var newZoom=jQuery(this).attr("alt");if(newZoom.indexOf("%")===-1&&newZoom!=="wh"&&newZoom!=="ww"){newZoom=newZoom+"%";}
if(newZoom==="ww"){DOMElementsHelper.jsObj.invokeAction("zoom-mode-window-width");}else if(newZoom==="wh"){DOMElementsHelper.jsObj.invokeAction("zoom-mode-window-height");}else{DOMElementsHelper.jsObj.invokeAction("zoom",newZoom);}},onComboChange:function(){var newZoom=jQuery(this).val();if(newZoom.indexOf("%")===-1&&newZoom!=="wh"&&newZoom!=="ww"){newZoom=newZoom+"%";}
if(newZoom==="ww"||newZoom.toLowerCase()==="window width"){DOMElementsHelper.jsObj.invokeAction("zoom-mode-window-width");jQuery(this).attr("alt","ww");}else if(newZoom==="wh"||newZoom.toLowerCase()==="window height"){DOMElementsHelper.jsObj.invokeAction("zoom-mode-window-height");jQuery(this).attr("alt","wh");}else{DOMElementsHelper.jsObj.invokeAction("zoom",newZoom);jQuery(this).attr("alt",newZoom);}},onShowDropDown:function(){DOMElementsHelper.replaceEditor(true);},onCloseDropDown:function(){DOMElementsHelper.replaceEditor(false);},combobox:true,comboboxName:"zoom",comboboxClass:"editorAction_"+DOMElementsHelper.containerId+" enabled",comboSize:4,comboMaxLength:4,comboWidth:42,dropdownWidth:100,comboAlign:"right"});jQuery("#"+DOMElementsHelper.containerId+"_statusbar .ui-slider-handle").bind("dblclick",function(){DOMElementsHelper.jsObj.invokeAction("zoom",100+"%");});}
if(DOMElementsHelper.config.resizable!==undefined&&DOMElementsHelper.config.resizable=="true"){jQuery("#"+DOMElementsHelper.containerId+"_statusbar .resizerContainer").append("<div class=\"seHandle ui-resizable-handle ui-resizable-handle-se ui-icon ui-icon-gripsmall-diagonal-se\"></div>");}else{jQuery("#"+DOMElementsHelper.containerId+"_statusbar .resizerContainer").parent("td").css({"display":"none"});}
if(DOMElementsHelper.config.sourceview===undefined||DOMElementsHelper.config.sourceview.enabled===undefined||DOMElementsHelper.config.sourceview.enabled===true||DOMElementsHelper.config.sourceview.enabled==="true"){jQuery("#"+DOMElementsHelper.containerId+"_statusbar .sourceViewButton").append('<div class="enabled ui-widget-header"><button class="buttonImage editorAction_'+DOMElementsHelper.containerId+' enabled" style="background-image: url('+DOMElementsHelper.resolveURL("../icons/toggle-source-view-status-bar.png")+');" title="'+DOMElementsHelper.LocaleObject.L_TOGGLE_SOURCE_VIEW+'" name="toggle-source-view" type="button"/></div>');}else{jQuery("#"+DOMElementsHelper.containerId+"_statusbar .sourceViewButton").css({"display":"none"});}
if(DOMElementsHelper.config.enablestyletemplatepanel===undefined||DOMElementsHelper.config.enablestyletemplatepanel=="true"||DOMElementsHelper.config.enablestyletemplatepanel===true){jQuery("#"+DOMElementsHelper.containerId+"_statusbar .styleTemplateButton").append('<div class="enabled ui-widget-header"><button class="buttonImage enabled" style="background-image: url('+DOMElementsHelper.resolveURL("../icons/style-templates-status-bar.png")+');" title="'+DOMElementsHelper.LocaleObject.L_TOGGLE_STYLE_TEMPLATE_PANEL+'" name="toggle-style-template-panel" type="button"/></div>');jQuery("#"+DOMElementsHelper.containerId+"_statusbar .styleTemplateButton button").bind("click",function(){DOMElementsHelper.editorLayout.toggle("west");if(!DOMElementsHelper.editorLayout.state.west.isClosed){jQuery(this).parent("div").addClass("ui-state-active");}else{jQuery(this).parent("div").removeClass("ui-state-active");}
DOMElementsHelper.jsWrapperObj.requestFocus();});}else{jQuery("#"+DOMElementsHelper.containerId+"_statusbar .styleTemplateButton").css({"display":"none"});}
var buttonContainerElements=jQuery("#"+DOMElementsHelper.containerId+"_statusbar .buttonContainer tr").children("td");var hideContainer=true;jQuery.each(buttonContainerElements,function(index,value){if(jQuery(value).css("display")!=="none"){hideContainer=false;}});if(hideContainer){jQuery("#"+DOMElementsHelper.containerId+"_statusbar .buttonContainer").parent("td").css({"display":"none"});}
var statusBarReduceWidth=jQuery("#"+DOMElementsHelper.containerId+"_statusbar .buttonContainer").outerWidth(true)+6;statusBarReduceWidth+=((jQuery("#"+DOMElementsHelper.containerId+"_statusbar .buttonContainer td").length+1)*2)+2;if(DOMElementsHelper.config.enablezoomarea===undefined||DOMElementsHelper.config.enablezoomarea=="true"){statusBarReduceWidth+=246;}
if(DOMElementsHelper.config.charactercounter!==undefined&&DOMElementsHelper.config.charactercounter.enabled!==undefined&&DOMElementsHelper.config.charactercounter.enabled==="true"){statusBarReduceWidth+=jQuery("#"+DOMElementsHelper.containerId+"_statusbar .documentCounterArea").outerWidth(true)+6;}
if(DOMElementsHelper.config.resizable!==undefined&&DOMElementsHelper.config.resizable=="true"){statusBarReduceWidth+=jQuery("#"+DOMElementsHelper.containerId+"_statusbar .resizerContainer").outerWidth(true)+6;}
statusBarReduceWidth+=40;jQuery("#"+DOMElementsHelper.containerId+"_statusbar .documentPaletteContainer").width(statusBarWidth-statusBarReduceWidth);},error:function(request,error,arg){DOMElementsLogger.log("Failed to load status bar: "+error,"SEVERE",this);}});};};eongApplication.dialogMap=function(){this.dialogMap={"backgroundColor":"../dialog/backgroundColor.html","cellProperties":"../dialog/cellProperties.html","changeCase":"../dialog/changeCase.html","changeLanguage":"../dialog/changeLanguage.html","columnProperties":"../dialog/columnProperties.html","documentStatistics":"../dialog/documentStatistics.html","editAnnotation":"../dialog/editAnnotation.html","generalColor":"../dialog/generalColor.html","hrProperties":"../dialog/hrProperties.html","imageProperties":"../dialog/imageProperties.html","insertAnnotation":"../dialog/insertAnnotation.html","insertHyperlink":"../dialog/insertHyperlink.html","insertImage":"../dialog/insertImage.html","insertObject":"../dialog/insertObject.html","insertSpecialChar":"../dialog/insertSpecialChar.html","insertTable":"../dialog/insertTable.html","linkProperties":"../dialog/linkProperties.html","loadURL":"../dialog/loadURL.html","objectProperties":"../dialog/objectProperties.html","rowProperties":"../dialog/rowProperties.html","splitCell":"../dialog/splitCell.html","tableProperties":"../dialog/tableProperties.html","textColor":"../dialog/textColor.html","pageProperties":"../dialog/pageProperties.html","insertCrossreference":"../dialog/insertCrossreference.html","editCrossreference":"../dialog/editCrossreference.html","insertBookmark":"../dialog/insertBookmark.html","insertStructureTemplate":"../dialog/insertStructureTemplate.html"};this.getDialogMap=function(){return this.dialogMap;}}
eongApplication.Helper=function(width,height,appletName,id,jsObjName,jsObj){this.initialized=false;this.containerId=id;this.actions={};this.id=this.containerId+"_eong";this.editorWidth=width;this.editorHeight=height;this.appletName=appletName;this.jsObjName=jsObjName;this.jsObj=jsObj;this.testValue=appletName;this.isJREAutoDownloadEnabled=true;this.jreAutoDownloadURL="http://java.sun.com/update/1.6.0/jinstall-6-windows-i586.cab";this.jreMinVersion="#Version=1,6,0,0";this.OBJECT_TAG=0;this.APPLET_TAG=1;this.tagStyle=this.OBJECT_TAG;this.archive="eong.jar";this.codebase="";this.code="com.realobjects.eong.Main";this.params="";this.attribs="";this.isMac=false;this.isWindows=false;this.isLinux=false;this.isMSIE=false;this.isSafari=false;this.isOpera=false;this.isFirefox=false;this.isChrome=false;this.BrowserVersion=-1;this.obj=null;this.actions={};this.uiconfig="";this.config="";this.iconRepositoryURL="";this.BrowserVersion=jQuery.browser.version;if(this.isMSIE){language=navigator.browserLanguage;}else{language=navigator.language;}
switch(language){case"de":this.browserLocale="de-DE";break;case"fr":this.browserLocale="fr-FR";break;case"es":this.browserLocale="es-ES";break;default:this.browserLocale="en-US";}
this.localeCode=this.browserLocale;this.localeURL="";this.LocaleObject=null;this.ActionMap=null;this.DialogMap=null;this.DialogHTMLMap={};this.JSActionMap={};this.enablePack200=true;this.pack200="-Djnlp.packEnabled=true ";this.maxMemory="-Xmx256m";this.currentPaletteScrollValue=0;this.maxScrollValue=0;this.scrollSpeed=1;this.defaultColors={"COLOR_WHITE":{"value":"#ffffff","locale":"L_COLOR_WHITE"},"COLOR_SILVER":{"value":"#c0c0c0","locale":"L_COLOR_SILVER"},"COLOR_GRAY":{"value":"#808080","locale":"L_COLOR_GRAY"},"COLOR_BLACK":{"value":"#000000","locale":"L_COLOR_BLACK"},"COLOR_NAVY":{"value":"#000080","locale":"L_COLOR_NAVY"},"COLOR_BLUE":{"value":"#0000ff","locale":"L_COLOR_BLUE"},"COLOR_AQUA":{"value":"#00ffff","locale":"L_COLOR_AQUA"},"COLOR_TEAL":{"value":"#008080","locale":"L_COLOR_TEAL"},"COLOR_PURPLE":{"value":"#800080","locale":"L_COLOR_PURPLE"},"COLOR_FUCHSIA":{"value":"#ff00ff","locale":"L_COLOR_FUCHSIA"},"COLOR_LIME":{"value":"#00ff00","locale":"L_COLOR_LIME"},"COLOR_GREEN":{"value":"#008000","locale":"L_COLOR_GREEN"},"COLOR_MAROON":{"value":"#800000","locale":"L_COLOR_MAROON"},"COLOR_RED":{"value":"#ff0000","locale":"L_COLOR_RED"},"COLOR_ORANGE":{"value":"#ffA500","locale":"L_COLOR_ORANGE"},"COLOR_YELLOW":{"value":"#ffff00","locale":"L_COLOR_YELLOW"},"COLOR_OLIVE":{"value":"#808000","locale":"L_COLOR_OLIVE"}};this.template="";this.templateURL="";this.extensionDirectoryURL="";this.fontNamesTemp=null;this.intrusiveJSLogging=false;this.jsWrapperObj=null;this.annotationUserAttributes={"author":""};this.parseNumber=function(num){var ret=Number(num);if(ret!=isNaN(ret)){return num;}else{return ret;}};this.cancelBackspace=function(event){if(event.target.nodeName!=="INPUT"&&event.target.nodeName!=="TEXTAREA"){if(event.keyCode==8){return false;}}
return event;};this.containerHeight=this.parseNumber(this.editorHeight);this.containerWidth=this.parseNumber(this.editorWidth);if(!isNaN(this.containerHeight)){this.containerHeight+="px";}
this.generateKey=function(prefix){prefix+=this.appletName;return prefix;};this.addAttribute=function(sName,sVal){this.attribs+=' '+sName+'="'+sVal+'"';};this.setParam=function(name,value){this.params+="<param name='"+name+"' value='"+value+"' />";};this.formatString=function(str){var str=str.replace(/\'/g,'\\\'');str=str.replace(/\n/g,'');return str;};this.getOSInfo=function(){var platform=navigator.platform;this.isWindows=/Win/.test(platform);this.isMac=/Mac/.test(platform);this.isLinux=/Linux/.test(platform);var ua=navigator.userAgent;var ve=navigator.vendor;this.isWebKit=/WebKit/.test(ua);this.isOpera=window.opera!==undefined;this.isMSIE=/MSIE/.test(ua);this.isFirefox=/Firefox/.test(ua);};this.toggleButtonHover=function(element,classname){jQuery(element).bind('mouseover',function(e){jQuery(this).addClass(classname);});jQuery(element).bind('mouseout',function(e){jQuery(this).removeClass(classname);});};this.processTemplate=function(input){var parsedHTML=input.replace(/\{containerId\}/g,this.containerId);var matchLocales=parsedHTML.match(/\[.*\]/g);var matchLocalesInQuotes=parsedHTML.match(/\"\{.*\}\"/g);var localeStr=null;var localeString=null;var replaceSearch=null;var testMatch=null;var processTemplateHelper=this;if(matchLocales!==undefined&&matchLocales!==null){jQuery.each(matchLocales,function(index,value){localeStr=value.replace(/\[/,"");localeStr=localeStr.replace(/\]/,"");localeString=processTemplateHelper.LocaleObject[localeStr];replaceSearch=eval("/\\["+localeStr+"\\]/");testMatch=parsedHTML.match(replaceSearch);parsedHTML=parsedHTML.replace(replaceSearch,localeString);});}
if(matchLocalesInQuotes!==undefined&&matchLocalesInQuotes!==null){jQuery.each(matchLocalesInQuotes,function(index,value){localeStr=value.replace(/\"\{/,"");localeStr=localeStr.replace(/\}\"/,"");localeString=processTemplateHelper.LocaleObject[localeStr];replaceSearch=eval("/\\{"+localeStr+"\\}/");testMatch=parsedHTML.match(replaceSearch);parsedHTML=parsedHTML.replace(replaceSearch,localeString);});}
return parsedHTML;};this.resolveURL=function(url){if(url.indexOf("://")<0){url=this.codebase+"/"+url;}
return this.flattenPath(url);};this.resolveURLAgainstDocBase=function(url,forceBaseHost){if(url.indexOf("://")>-1){if(forceBaseHost===undefined||!forceBaseHost){return this.flattenPath(url);}
url=url.substring(url.indexOf("/",url.indexOf("://")+3));}
baseurl=document.URL;baseurl=baseurl.substring(0,baseurl.lastIndexOf("/")+1);if(url.indexOf("/")==0){baseurl=baseurl.substring(0,(baseurl.indexOf("/",baseurl.indexOf("://")+3)));}
url=baseurl+url;return this.flattenPath(url);}
this.flattenPath=function(path){while((p=path.indexOf("/../"))>-1){path=path.substring(0,path.substring(0,p).lastIndexOf("/"))+path.substring(p+3);}
return path}
this.escapeSingleQuotes=function(string){var replaced=string.replace(/\'/g,"&#39;");return replaced;};this.setLocaleObject=function(){var setLocaleHelper=this;if(this.localeURL!==""){localeURLHelper=this.resolveURL(this.localeURL);jQuery.ajax({dataType:"text",async:false,url:localeURLHelper,success:function(json){setLocaleHelper.LocaleObject=jQuery.secureEvalJSON(json);},error:function(errormsg){jQuery.ajax({dataType:"text",async:false,url:setLocaleHelper.codebase+"/../locale/"+setLocaleHelper.localeCode+".json",success:function(json){setLocaleHelper.LocaleObject=jQuery.secureEvalJSON(json);setLocaleHelper.extendLocaleObject(setLocaleHelper.localeCode);},error:function(errormsg){jQuery.ajax({dataType:"text",async:false,url:setLocaleHelper.codebase+"/../locale/en-US.json",success:function(json){setLocaleHelper.LocaleObject=jQuery.secureEvalJSON(json);setLocaleHelper.extendLocaleObject("en-US");},error:function(errormsg){}});}});}});}else{jQuery.ajax({dataType:"text",async:false,url:setLocaleHelper.codebase+"/../locale/"+setLocaleHelper.localeCode+".json",success:function(json){setLocaleHelper.LocaleObject=jQuery.secureEvalJSON(json);setLocaleHelper.extendLocaleObject(setLocaleHelper.localeCode);},error:function(errormsg){jQuery.ajax({dataType:"text",async:false,url:setLocaleHelper.codebase+"/../locale/en-US.json",success:function(json){setLocaleHelper.LocaleObject=jQuery.secureEvalJSON(json);setLocaleHelper.extendLocaleObject("en-US");},error:function(errormsg){}});}});}};this.extendLocaleObject=function(localeCode){if(this.extensionDirectoryURL!==""){extDir=this.resolveURL(this.extensionDirectoryURL);var extendLocaleHelper=this;jQuery.ajax({dataType:"text",async:false,url:extDir+"/"+localeCode+".ext.json",success:function(json){json=jQuery.secureEvalJSON(extendLocaleHelper.escapeSingleQuotes(json));jQuery.each(json,function(key,value){extendLocaleHelper.LocaleObject[key]=value;});},error:function(errormsg){}});}};this.setActionMap=function(){var setActionMapHelper=this;this.ActionMap=jsObj.ActionMap.getActionMap();this.extendActionMap();var tmpJson=jQuery.toJSON(setActionMapHelper.ActionMap);tmpJson=tmpJson.replace(/\r/g,'');tmpJson=tmpJson.replace(/\n/g,'');tmpJson=tmpJson.replace(/\t/g,'');this.setParam("ACTIONMAP",tmpJson);};this.extendActionMap=function(){if(this.extensionDirectoryURL!==""){extDir=this.resolveURL(this.extensionDirectoryURL);var extendActionHelper=this;jQuery.ajax({dataType:"text",async:false,url:extDir+"/actionmap.ext.json",success:function(json){json=jQuery.secureEvalJSON(json);jQuery.each(json,function(key,value){extendActionHelper.ActionMap[key]={};jQuery.each(value,function(key2,value2){extendActionHelper.ActionMap[key][key2]=value2;});});},error:function(errormsg){}});}};this.setDialogMap=function(){var setDialogMapHelper=this;this.DialogMap=jsObj.DialogMap.getDialogMap();this.extendDialogMap();};this.inArray=function(array,value){if(!(array instanceof Array)){array=[];}
value=value||0;for(var i=0,len=array.length;i<len;++i){if(array[i]==value){return true;}}
return false;};this.extendDialogMap=function(){if(this.extensionDirectoryURL!==""){extDir=this.resolveURL(this.extensionDirectoryURL);var extendDialogHelper=this;jQuery.ajax({dataType:"text",async:false,url:extDir+"/dialogmap.ext.json",success:function(json){json=jQuery.secureEvalJSON(json);jQuery.each(json,function(key,value){extendDialogHelper.DialogMap[key]={};jQuery.each(value,function(key2,value2){extendDialogHelper.DialogMap[key][key2]=value2;});});},error:function(errormsg){}});}};this.parseStructureTemplates=function(){var tree="";var currentContext=this.jsObj.getObj().getContextNames();if(currentContext===""){currentContext=[];}else{currentContext=jQuery.evalJSON(currentContext);}
if(this.structureTemplateConfig!==undefined&&this.structureTemplateConfig!==""){tree="<ul class=\"filetree\"><li>"+this.parseRecursiveST(this.structureTemplateConfig,currentContext)+"</li></ul>";}
return tree;};this.parseRecursiveST=function(json,currentContext){var parseStructureTemplatesHelper=this;var tree="";jQuery.each(json,function(index,value){if(index==="templateArray"){tree+="<ul class=\"fileList\">"
jQuery.each(value,function(arrayIndex,arrayValue){jQuery.each(arrayValue,function(templateObjectIndex,templateObjectValue){var uid=templateObjectIndex.replace(/ /g,"_");var toolTip="<div id=\"templateTooltip_"+uid+"_"+parseStructureTemplatesHelper.containerId+"\" class=\"tooltip ui-widget-content\">";toolTip+="<table width=\"100%\" cellspacing=\"0\" cellspacing=\"0\" border=\"0\"><tr><td colspan=\"2\" class=\"tooltipHead\">"+templateObjectIndex+"</td></tr>";toolTip+="<tr><td class=\"tooltipImage\">";if(templateObjectValue.previewimage!==undefined){toolTip+="<img alt=\""+templateObjectIndex+"\" src=\""+parseStructureTemplatesHelper.resolveURL(templateObjectValue.previewimage)+"\" />";}
toolTip+="</td><td class=\"tooltipDescription\">";if(templateObjectValue.description!==undefined){toolTip+=templateObjectValue.description}
toolTip+="</td></tr></table></div>";if(templateObjectValue.context!==undefined&&(templateObjectValue.context.length>0)&&templateObjectValue.context!==""){var inContext=false;jQuery.each(templateObjectValue.context,function(index,value){if(parseStructureTemplatesHelper.inArray(currentContext,value)){inContext=true;}});if(inContext){tree+="<li name=\""+templateObjectValue.URL+"\" class=\"templateFile\"><span class=\"file\">"+templateObjectIndex+"</span>"+toolTip+"</li>";}else{tree+="";}}else{tree+="<li name=\""+templateObjectValue.URL+"\" class=\"templateFile\"><span class=\"file\">"+templateObjectIndex+"</span>"+toolTip+"</li>";}});});tree+="</ul>";}else{tree+="<li><span class=\"folder\">"+index+"</span><ul class=\"\subList\">"+parseStructureTemplatesHelper.parseRecursiveST(value,currentContext);tree+="</ul></li>";}});return tree;};this.loadDialogHTML=function(){var extendDialogHTMLHelper=this;jQuery.each(this.DialogMap,function(index,value){jQuery.ajax({url:extendDialogHTMLHelper.resolveURL(value),async:true,cache:true,success:function(html){extendDialogHTMLHelper.DialogHTMLMap[index]=extendDialogHTMLHelper.processTemplate(html);},error:function(request,error,arg){extendDialogHTMLHelper.jsObj.Logger.log("[loadDialogHTML] Could not load dialog content for "+index+" dialog: "+error,"SEVERE",this);}});});};this.createDialog=function(html,dialogTitle,dialogContainerPrefix,replace){var createDialogHelper=this;this.disableVirtualCaret=true;if(dialogContainerPrefix===undefined||dialogContainerPrefix===""){dialogContainerPrefix="modalDialog_";}
if(replace===undefined||replace===null||replace===""){replace=true;}
var parsedHTML=html;if(jQuery("#"+dialogContainerPrefix+this.containerId).length>0){jQuery("#"+dialogContainerPrefix+this.containerId).html(parsedHTML);jQuery("#"+dialogContainerPrefix+this.containerId).show();}else{jQuery("#"+this.containerId).append("<div id=\""+dialogContainerPrefix+this.containerId+"\" class=\"modalDialog ui-tabs ui-widget ui-widget-content ui-corner-all ui-dialog-content\" style=\"height: 1px; display:none;\"></div>");jQuery("#"+dialogContainerPrefix+this.containerId).html(parsedHTML);jQuery("#"+dialogContainerPrefix+this.containerId).show();}
if(dialogTitle===undefined||dialogTitle===""){dialogTitle="No title defined";}
jQuery("#"+dialogContainerPrefix+this.containerId).dialog({title:dialogTitle,autoOpen:false,resizable:false,close:function(event,ui){createDialogHelper.hideDialog(dialogContainerPrefix,replace);}});};this.showDialog=function(dialogContainerPrefix,replace){var showDialogHelper=this;if(dialogContainerPrefix===undefined||dialogContainerPrefix===""){dialogContainerPrefix="modalDialog_";}
if(replace===undefined||replace===null||replace===""){replace=true;}
if(replace){this.replaceEditor(true);}
jQuery("#"+dialogContainerPrefix+this.containerId).dialog('open');jQuery(document).bind("keypress.backSpaceHandler",function(event){return showDialogHelper.cancelBackspace(event)});jQuery(document).bind("keydown.backSpaceHandler",function(event){return showDialogHelper.cancelBackspace(event)});};this.dialogCreateTabs=function(dialogContainerPrefix){if(dialogContainerPrefix===undefined||dialogContainerPrefix===""){dialogContainerPrefix="modalDialog_";}
var noTabs=false;var tabSize=jQuery("#"+dialogContainerPrefix+this.containerId+" .dialogPanelContainer").size();if(tabSize>1){jQuery("#"+dialogContainerPrefix+this.containerId).tabs();}else{jQuery("#"+dialogContainerPrefix+this.containerId+" > ul").hide();noTabs=true;}
this.sizeDialog(dialogContainerPrefix);};this.sizeDialog=function(dialogContainerPrefix){var contentWidth=0;jQuery("#"+dialogContainerPrefix+this.containerId+" .dialogPanelContainer").find("div, table, td").each(function(){if(contentWidth<jQuery(this).outerWidth()){contentWidth=jQuery(this).outerWidth();}});var dialogWidth=contentWidth+10;jQuery("#"+dialogContainerPrefix+this.containerId).dialog('option','width',dialogWidth);jQuery("#"+dialogContainerPrefix+this.containerId).dialog('option','minWidth',dialogWidth);var tabWidth=7;if(jQuery("#"+dialogContainerPrefix+this.containerId+" > ul").css('display')!=='none'){jQuery("#"+dialogContainerPrefix+this.containerId+" > ul li").each(function(){tabWidth+=jQuery(this).width()+5;});}
if(this.isMSIE&&this.BrowserVersion!=="8.0"){jQuery("#"+dialogContainerPrefix+this.containerId+" > ul").width(tabWidth-10);}
if(tabWidth>contentWidth){jQuery("#"+dialogContainerPrefix+this.containerId).dialog('option','width',tabWidth);jQuery("#"+dialogContainerPrefix+this.containerId).dialog('option','minWidth',tabWidth);}
var dialogWidth=jQuery("#"+dialogContainerPrefix+this.containerId).dialog('option','width');jQuery("#"+dialogContainerPrefix+this.containerId+" .dialogPanelContainer").width(dialogWidth-10);contentHeight=0;jQuery("#"+dialogContainerPrefix+this.containerId).find(".dialogPanels").each(function(){if(contentHeight<jQuery(this).outerHeight()){contentHeight=jQuery(this).outerHeight();}});jQuery("#"+dialogContainerPrefix+this.containerId).find(".dialogPanels").height(contentHeight);this.centerDialog(dialogContainerPrefix);};this.centerDialog=function(dialogContainerPrefix){var offset=jQuery("#"+this.containerId).offset();var dialogPositionX=0;var dialogPositionY=0;if(jQuery("#"+this.containerId).height()>jQuery(window).height()){dialogPositionY=(jQuery(window).scrollTop()-offset.top)+((jQuery(window).height()/2)-(jQuery("#"+dialogContainerPrefix+this.containerId).parent(".ui-dialog").height()/2));}else{dialogPositionY=offset.top+((jQuery("#"+this.containerId).height()/2)-(jQuery("#"+dialogContainerPrefix+this.containerId).parent(".ui-dialog").height()/2));}
dialogPositionX=offset.left+((jQuery("#"+this.containerId).width()/2)-(jQuery("#"+dialogContainerPrefix+this.containerId).parent(".ui-dialog").width()/2));if(dialogPositionY<0){dialogPositionY=0;}
if(dialogPositionX<0){dialogPositionX=0;}
jQuery("#"+dialogContainerPrefix+this.containerId).parent(".ui-dialog").css({top:dialogPositionY,left:dialogPositionX});jQuery("#"+dialogContainerPrefix+this.containerId).find("input, textarea, select, button").first().focus();};this.hideDialog=function(dialogContainerPrefix,replace){var hideDialogHelper=this;if(dialogContainerPrefix===undefined||dialogContainerPrefix===""){dialogContainerPrefix="modalDialog_";}
if(replace===undefined||replace===null||replace===""){replace=true;}
jQuery("#"+dialogContainerPrefix+this.containerId).dialog('destroy');jQuery("#"+dialogContainerPrefix+this.containerId).tabs('destroy');jQuery("#"+dialogContainerPrefix+this.containerId).html("");if(replace){this.replaceEditor(false);}
this.disableVirtualCaret=false;this.jsWrapperObj.requestFocus();jQuery(document).unbind("keypress.backSpaceHandler");jQuery(document).unbind("keydown.backSpaceHandler");};this.replaceEditorNoOverlay=function(state){var replaceEditorHelper=this;if(!state){this.jsObj.setEnabled(true);jQuery("#"+this.id).css({visibility:"visible"});jQuery("#replacementImage_"+this.containerId).css({display:"none"});this.jsWrapperObj.replaceEditor(state);}else{this.jsObj.setEnabled(false);this.jsWrapperObj.replaceEditor(state);if(this.isMSIE){jQuery("#"+this.containerId+" button:first").focus();}
jQuery("#"+this.id).css({visibility:"hidden"});jQuery("#replacementImage_"+this.containerId).css({display:"block"});if(this.isMSIE&&this.BrowserVersion!=="8.0"){}else{jQuery("#replacementImage_"+this.containerId).attr("src","");}}};this.replaceEditor=function(state){var replaceEditorHelper=this;if(!state){this.jsObj.setEnabled(true);jQuery("#dialogOverlay_"+this.containerId).remove();jQuery("#"+this.id).css({visibility:"visible"});jQuery("#replacementImage_"+this.containerId).css({display:"none"});this.jsWrapperObj.replaceEditor(state);}else{this.jsObj.setEnabled(false);this.jsWrapperObj.replaceEditor(state);if(this.isMSIE){jQuery("#"+this.containerId+" button:first").focus();}
jQuery("#"+this.id).css({visibility:"hidden"});jQuery("#replacementImage_"+this.containerId).css({display:"block"});if(this.isMSIE&&this.BrowserVersion!=="8.0"){}else{jQuery("#replacementImage_"+this.containerId).attr("src","");}
jQuery("#"+this.containerId).append("<div id=\"dialogOverlay_"+this.containerId+"\" class=\"dialogOverlay ui-corner-all\"></div>");jQuery("#dialogOverlay_"+this.containerId).width(jQuery("#"+this.containerId).width());jQuery("#dialogOverlay_"+this.containerId).height(jQuery("#"+this.containerId).height());}};this.createFontFamilyDropdown=function(){var fontFamilyDDHelper=this;jQuery(".ui-dialog-buttonpane").append("<div style=\"padding-top: 4px; margin-right: 5px; float: left;\" id=\"fontDropDownContainer_"+this.containerId+"\"></div>");jQuery("#fontDropDownContainer_"+this.containerId).menu({content:jQuery("#fontDropDownList_"+fontFamilyDDHelper.containerId).html(),showSpeed:200,height:300,comboWidth:80,directionV:'down',iconDirection:'down',onSelect:function(){jQuery(".view_char_field_"+fontFamilyDDHelper.containerId+" td").css({"font-family":jQuery(this).attr("alt")});jQuery(".specialCharDiv div td").css({"font-family":jQuery(this).attr("alt")});jQuery("#fontDropDownContainer_"+fontFamilyDDHelper.containerId+"_comboBox").css({"font-family":jQuery(this).attr("alt")});},onComboChange:function(){jQuery(".view_char_field_"+fontFamilyDDHelper.containerId+" td").css({"font-family":jQuery(this).val()});jQuery(".specialCharDiv div td").css({"font-family":jQuery(this).val()});jQuery("#fontDropDownContainer_"+fontFamilyDDHelper.containerId+"_comboBox").css({"font-family":jQuery(this).val()});},combobox:true});var currentFontFamily=this.jsWrapperObj.getCurrentFontFamily();if(currentFontFamily==="default"){currentFontFamilyDisplay=this.LocaleObject.L_DEFAULT_VALUE_TEXT;}else{currentFontFamilyDisplay=currentFontFamily;}
jQuery("#fontDropDownContainer_"+fontFamilyDDHelper.containerId+"_comboBox").css({"font-family":currentFontFamily});jQuery("#fontDropDownContainer_"+fontFamilyDDHelper.containerId+"_comboBox").val(currentFontFamilyDisplay);jQuery("#fontDropDownContainer_"+fontFamilyDDHelper.containerId+"_comboBox").attr("alt",currentFontFamily);jQuery(".ui-dialog-buttonpane").append("<table cellspacing=\"0\" cellpadding=\"0\" class=\"view_char_field_"+this.containerId+" viewCharField\"><tr><td>&nbsp;</td></tr></table>");jQuery(".ui-dialog-buttonpane .view_char_field_"+this.containerId).css({"float":"left"});};this.assembleFontDropDownList=function(){var fontNames="";if(this.fontNamesTemp===null){fontNames=this.jsWrapperObj.getAvailableFonts();if(fontNames!==""){eval("fontNamesNew = "+fontNames);this.fontNamesTemp=fontNamesNew;}}else{fontNames=this.fontNamesTemp;}
jQuery("#"+this.containerId).append("<div class=\"hidden\" id=\"fontDropDownList_"+this.containerId+"\"><ul></ul></div>")
var list=jQuery("#fontDropDownList_"+this.containerId+" ul");list.append("<li alt=\"default\"><a href=\"#\">"+this.LocaleObject.L_DEFAULT_VALUE_TEXT+"</a></li>");jQuery.each(fontNamesNew,function(index,value){list.append("<li name=\""+value+"\" alt=\""+value+"\"><a style=\"font-family: "+value+" !important; font-size: 1em;\" href=\"#\">"+value+"</a></li>");});}
this.createDefaultCharTable=function(elemId,fontElement){var font=jQuery(fontElement).val();if(font==="default"){font="sans-serif";}
jQuery(".specialCharPane").parents(".dialogPanelInnerContainer").css({"margin-top":0});if(this.sessionDefaultCharTable===undefined||this.sessionDefaultCharTable===""){var k=0;var table="";for(var i=32;i<=0x7e;i++,k++){table+="<div class=\"specialCharDiv\"><div style=\"font-family: "+font+"; font-size: 1.0em;\"><table cellspacing=\"0\" cellpadding=\"0\"><tr><td class=\"charInnerTD\">"+unescape(String.fromCharCode(i))+"</td></tr></table></div></div>";}
i=8364;k++;table+="<div class=\"specialCharDiv\"><div style=\"font-family: "+font+"; font-size: 1.0em;\"><table cellspacing=\"0\" cellpadding=\"0\"><tr><td class=\"charInnerTD\">"+unescape(String.fromCharCode(i))+"</td></tr></table></div></div>";i=8482;k++;table+="<div class=\"specialCharDiv\"><div style=\"font-family: "+font+"; font-size: 1.0em;\"><table cellspacing=\"0\" cellpadding=\"0\"><tr><td class=\"charInnerTD\">"+unescape(String.fromCharCode(i))+"</td></tr></table></div></div>";for(i=0xa1;i<=0xff;i++,k++){table+="<div class=\"specialCharDiv\"><div style=\"font-family: "+font+"; font-size: 1.0em;\"><table cellspacing=\"0\" cellpadding=\"0\"><tr><td class=\"charInnerTD\">"+unescape(String.fromCharCode(i))+"</td></tr></table></div></div>";}
table+="<div style=\"clear: both\"></div>";this.sessionDefaultCharTable=table;}
jQuery("#"+elemId+" div").html(this.sessionDefaultCharTable);jQuery(".specialCharDiv").bind("mouseover",function(e){jQuery(this).css({"background-color":"#ffffbd"});});jQuery(".specialCharDiv").bind("mouseout",function(e){jQuery(this).css({"background-color":""});});jQuery(".specialCharDiv div").css({"font-family":font});jQuery(".viewCharField td").css({"font-family":font});};this.createCustomCharTable=function(elemId,fontElement){var font=jQuery(fontElement).val();if(font==="default"){font="sans-serif";}
jQuery(".specialCharPane").parents(".dialogPanelInnerContainer").css({"margin-top":0});if(this.config.presetsymbols!==undefined){if(this.sessionCustomCharTable===undefined||this.sessionCustomCharTable===""){k=0;i=0;var table="";jQuery.each(this.config.presetsymbols,function(index,value){table+="<div class=\"specialCharDiv\"><div style=\"font-family: "+font+"; font-size: 1.0em;\"><table cellspacing=\"0\" cellpadding=\"0\"><tr><td class=\"charInnerTD\">&#"+value+";</td></tr></table></div></div>";k=index;i++;});table+="<div style=\"clear: both\"></div>";this.sessionCustomCharTable=table;}
jQuery("#"+elemId+" div").html(this.sessionCustomCharTable);jQuery(".specialCharDiv").bind("mouseover",function(e){jQuery(this).css({"background-color":"#ffffbd"});});jQuery(".specialCharDiv").bind("mouseout",function(e){jQuery(this).css({"background-color":""});});jQuery(".specialCharDiv div").css({"font-family":font});jQuery(".viewCharField td").css({"font-family":font});}else{}};this.createSpinner=function(id,min,max){jQuery(id).spinner({max:max,min:min});};this.bindOpenFileDialog=function(bindToElemId,updateElem,filter){var bindOpenFileHelper=this;jQuery(bindToElemId).bind("click",function(e){bindOpenFileHelper.jsObj.invokeAction("open-file-dialog","['"+updateElem+"', '"+filter+"']");});};this.bindOpenWebdavDialog=function(bindToElemId,updateElem,actionID){var bindOpenWebDavHelper=this;jQuery(bindToElemId).bind("click",function(e){bindOpenWebDavHelper.jsObj.invokeAction(actionID,"['"+updateElem+"']");});};this.openFileDialog=function(updateElem,filter){var bindOpenFileHelper=this;bindOpenFileHelper.jsObj.invokeAction("open-file-dialog","['"+updateElem+"', '"+filter+"']");};this.openWebdavDialog=function(updateElem,actionID){var bindOpenWebDavHelper=this;bindOpenWebDavHelper.jsObj.invokeAction(actionID,"['"+updateElem+"']");};this.createDrawTableElement=function(tableId,rowResultId,columnResultId,rows,columns){var createDrawTableHelper=this;var tableStr="";for(var i=0;i<rows;i++){tableStr+="<tr>";for(var j=0;j<columns;j++){tableStr+="<td>&nbsp;</td>";}
tableStr+="</tr>";}
jQuery("#"+tableId).append(tableStr);var currentTd=null;var col,row=0;this.bindTableEvents=function(){btE=this;jQuery("#"+tableId+" td").each(function(i,elem){jQuery(this).bind('mouseover',elem,function(e){if(currentTd!=e.data){currentTd=e.data;col=jQuery(currentTd).prevAll().length;row=currentTd.parentNode.rowIndex;jQuery("#"+tableId+" td").each(function(i,elem){(jQuery(elem).prevAll().length<=col&&elem.parentNode.rowIndex<=row?jQuery(elem).addClass("hover"):jQuery(elem).removeClass("hover"));});}});jQuery(this).bind('click',elem,function(e){jQuery("#"+tableId+" td").each(function(i,elem){jQuery(this).unbind("mouseover");jQuery(this).unbind("click");jQuery("#"+tableId).unbind("click");});col=jQuery(e.data).prevAll().length;row=e.data.parentNode.rowIndex;jQuery("#"+rowResultId).val(row+1);jQuery("#"+columnResultId).val(col+1);jQuery("#"+rowResultId).effect("highlight");jQuery("#"+columnResultId).effect("highlight");window.setTimeout("jQuery(\"#"+tableId+"\").bind(\"click\", function(){eval(btE).bindTableEvents();});",300);});});};this.bindTableEvents();};this.createColorSelectTable=function(colorObject,attachId){var createColorSelectTableHelper=this;var cols=4;var i=0;var html="";var colorValue=null;var localeValue=null;jQuery.each(colorObject,function(index,value){if(value.value===undefined){colorValue=value.rgb;localeValue=value.desc;}else{colorValue=value.value;localeValue=createColorSelectTableHelper.LocaleObject[value.locale];}
if(i===0){html+="<tr>\n<td><button name='"+colorValue+"' id='textColor_"+localeValue+"_"+createColorSelectTableHelper.containerId+"' style='background-color: "+colorValue+"' title='"+localeValue+"' /></td>";}
else if(i%cols===0&&i!==0){html+="</tr><tr>\n<td><button name='"+colorValue+"' id='textColor_"+localeValue+"_"+createColorSelectTableHelper.containerId+"' style='background-color: "+colorValue+"' title='"+localeValue+"' /></td>";}else{html+="\n<td><button name='"+colorValue+"' id='textColor_"+localeValue+"_"+createColorSelectTableHelper.containerId+"' style='background-color: "+colorValue+"' title='"+localeValue+"' /></td>";}
i++;});var difference=0;if(i%cols===0){difference=0;}
else{difference=cols-(i%cols);}
for(var k=0;k<difference;k++){html+="<td>&nbsp;</td>";}
jQuery("#"+attachId).append(html+"</tr>");};this.toggleFullscreenMode=function(){var toggleFullscreenModeHelper=this;var toolbarHeight="";var statusBarHeight="";var reduceHeight="";var sideBarWidth="";var sideBarVisible="";var width="";if(jQuery("#toggleFullscreenMode_"+this.containerId+" span").hasClass("ui-icon-extlink")){jQuery("#toggleFullscreenMode_"+this.containerId+" span").removeClass("ui-icon-extlink");jQuery("#toggleFullscreenMode_"+this.containerId+" span").addClass("ui-icon-newwin");jQuery("#toggleFullscreenMode_"+this.containerId+" span").attr("title",toggleFullscreenModeHelper.LocaleObject.L_RESTORE_DOWN);var windowWidth=jQuery(window).width();var windowHeight=jQuery(window).height();var reduceWindowWidth=18;var reduceWindowHeight=0;if(this.isMSIE){reduceWindowWidth=18;reduceWindowHeight=1;}
jQuery("#"+this.containerId).css({width:windowWidth-reduceWindowWidth,height:windowHeight-reduceWindowHeight});jQuery("#"+this.containerId).offset({top:0,left:0});this.resizeUI();jQuery("#"+this.containerId).offset({top:0,left:0});this.jsWrapperObj.requestFocus();jQuery("#"+this.containerId).offset({top:0,left:0});}else{jQuery("#toggleFullscreenMode_"+this.containerId+" span").removeClass("ui-icon-newwin");jQuery("#toggleFullscreenMode_"+this.containerId+" span").addClass("ui-icon-extlink");jQuery("#toggleFullscreenMode_"+this.containerId+" span").attr("title",toggleFullscreenModeHelper.LocaleObject.L_MAXIMIZE);jQuery("#"+this.containerId).offset(this.initialOffset);jQuery("#"+this.containerId).css({width:toggleFullscreenModeHelper.editorWidth,height:toggleFullscreenModeHelper.editorHeight});this.resizeUI();this.jsWrapperObj.requestFocus();}};this.serializeJSON=function(json){var arrayStr="";var entries=0;var serializeJSONHelper=this;jQuery.each(json,function(key,val){key=""+key;while(key.length<4){key="0"+key;}
if(typeof val=="object"){if(entries!==0){arrayStr+=",";}
arrayStr+="\""+entries+"\": ";arrayStr+="{\n";arrayStr+="\""+key+"\": {\n";arrayStr+=serializeJSONHelper.serializeJSON(val);arrayStr+="}";arrayStr+="}\n";}else{if(entries!==0){arrayStr+=",";}
arrayStr+="\""+key+"\": ";arrayStr+="\""+val+"\"\n";}
entries++;});return arrayStr;};this.resizeUI=function(widthOnly){if(widthOnly===undefined){widthOnly=false;}
var toolbarHeight=0;var statusBarHeight=0;var reduceWidth=0;if(this.detachableUI.enabled!==undefined&&(this.detachableUI.enabled==="true"||this.detachableUI.enabled===true)){}else{toolbarHeight=jQuery("#"+this.containerId+"_toolbar").height();statusBarHeight=jQuery("#"+this.containerId+"_statusbar").height();}
if(statusBarHeight===null){statusBarHeight=0;}
var reduceHeight=parseInt(toolbarHeight,10)+parseInt(statusBarHeight,10);var sideBarWidth=parseInt(jQuery("#"+this.containerId+"_sidebar").width(),10);var sideBarVisible=jQuery("#"+this.containerId+"_sidebar").css("display");var width=jQuery("#"+this.containerId).width();var reducedWidth="";if(sideBarVisible=="none"||sideBarVisible===undefined){reduceWidth=0;}
else{reduceWidth=sideBarWidth+7;}
var height=jQuery("#"+this.containerId).height();var reducedHeight=this.parseNumber(height-(reduceHeight));if(this.isMSIE){reducedHeight=reducedHeight-1;}else if(this.isWebKit){reducedHeight=reducedHeight-3;}else{reducedHeight=reducedHeight-1;}
if(this.config.enablestyletemplatepanel===undefined||this.config.enablestyletemplatepanel=="true"||this.config.enablestyletemplatepanel===true){reducedWidth=this.parseNumber(width-reduceWidth);}
else{reducedWidth=this.parseNumber(width);}
if(this.detachableUI.enabled!==undefined&&(this.detachableUI.enabled==="true"||this.detachableUI.enabled===true)){jQuery("#applicationContainer_"+this.containerId+" .ui-layout-resizer").height(reducedHeight-2);jQuery("#"+this.containerId+"_sidebar").height(reducedHeight-2);jQuery("#"+this.containerId+"_sidebar #"+this.containerId+"_sidebar_content").height(reducedHeight-(37));}
else{jQuery("#"+this.containerId+"_toolbar").width(width);if(this.isMSIE){jQuery("#"+this.containerId+"_toolbar_container").width(width-7);}else if(this.isWebKit){jQuery("#"+this.containerId+"_toolbar_container").width(width-5);}else{jQuery("#"+this.containerId+"_toolbar_container").width(width-6);}
jQuery("#"+this.containerId+"_statusbar").width(width-3);jQuery("#applicationContainer_"+this.containerId+" .ui-layout-resizer").height(reducedHeight);jQuery("#"+this.containerId+"_sidebar").height(reducedHeight-1);jQuery("#"+this.containerId+"_sidebar #"+this.containerId+"_sidebar_content").height(reducedHeight-(37));}
if(!widthOnly){jQuery("#applicationContainer_"+this.containerId).height(reducedHeight);}
jQuery("#applicationContainer_"+this.containerId).width(width);if(this.jsWrapperObj!==undefined&&this.jsWrapperObj!==null){this.jsWrapperObj.setMinCanvasWidth(reducedWidth);}
jQuery("#"+this.containerId+"_div").css({"width":reducedWidth,"height":reducedHeight});jQuery("#"+this.id).css({"width":reducedWidth-1,"height":reducedHeight});jQuery("#"+this.id).attr({"width":reducedWidth-1,"height":reducedHeight});jQuery("#replacementImage_"+this.containerId).css({width:reducedWidth,height:reducedHeight});var statusBarReduceWidth=jQuery("#"+this.containerId+"_statusbar .buttonContainer").outerWidth(true)+6;statusBarReduceWidth+=((jQuery("#"+this.containerId+"_statusbar .buttonContainer td").length+1)*2)+2;if(this.config.enablezoomarea===undefined||this.config.enablezoomarea=="true"){statusBarReduceWidth+=246;}
if(this.config.charactercounter!==undefined&&this.config.charactercounter.enabled!==undefined&&this.config.charactercounter.enabled==="true"){statusBarReduceWidth+=jQuery("#"+this.containerId+"_statusbar .documentCounterArea").outerWidth(true)+6;}
if(this.config.resizable!==undefined&&this.config.resizable=="true"){statusBarReduceWidth+=jQuery("#"+this.containerId+"_statusbar .resizerContainer").outerWidth(true)+6;}
statusBarReduceWidth+=40;jQuery("#"+this.containerId+"_statusbar .documentPaletteContainer").width(width-statusBarReduceWidth);this.jsObj.toggleNav();};this.createParameterWidget=function(paramContainerId,paramObject){var createParameterWidgetHelper=this;var height=jQuery(paramContainerId).parents(".dialogPanels").height();jQuery(paramContainerId).append("<table cellspacing='0' class='parameterWidgetHeader ui-widget-content ui-corner-top' width='100%'><tr class='ui-widget-header'><td style='border-right: 1px solid grey;'>"+this.LocaleObject.L_PARAM_WIDGET_NAME+"</td><td>"+this.LocaleObject.L_PARAM_WIDGET_VALUE+"</td></tr></table>");jQuery(paramContainerId).parents(".dialogPanelInnerContainer").append("<button id='parameterWidgetAddButton_"+this.containerId+"'>"+this.LocaleObject.L_ADD_BUTTON+"</button>"
+"<button disabled='disabled' id='parameterWidgetRemoveButton_"+this.containerId+"'>"+this.LocaleObject.L_REMOVE_BUTTON+"</button>");if(paramObject!==undefined&&paramObject!==null){jQuery.each(paramObject,function(index,value){createParameterWidgetHelper.addParamWidgetBindEvents(paramContainerId,index,value);});}else{this.addParamWidgetBindEvents(paramContainerId,"","");}
jQuery("#parameterWidgetAddButton_"+this.containerId).bind("click",function(e){createParameterWidgetHelper.addParamWidgetBindEvents(paramContainerId,"","");if(jQuery(paramContainerId+" tr").length>2){jQuery("#parameterWidgetRemoveButton_"+createParameterWidgetHelper.containerId).attr("disabled","");}});jQuery("#parameterWidgetRemoveButton_"+this.containerId).bind("click",function(e){var beforeEmpty=jQuery(".selectedRow").prev("tr:not(.ui-widget-header)").length===0;var afterEmpty=jQuery(".selectedRow").next().length===0;var current=jQuery(".selectedRow");if(!beforeEmpty){current.prev().addClass("selectedRow");}else if(!afterEmpty){current.next().addClass("selectedRow");}else{jQuery("#parameterWidgetRemoveButton_"+createParameterWidgetHelper.containerId).attr("disabled","true");}
current.remove();if(jQuery(paramContainerId+" tr").length<3){jQuery("#parameterWidgetRemoveButton_"+createParameterWidgetHelper.containerId).attr("disabled","disabled");}
var height=jQuery(paramContainerId).height();var innerHeight=jQuery(paramContainerId+" table").height();if(innerHeight<=height){jQuery(paramContainerId).css({"padding-right":0});}});if(jQuery(paramContainerId+" tr").length>2){jQuery("#parameterWidgetRemoveButton_"+createParameterWidgetHelper.containerId).attr("disabled","");}};this.addParamWidgetBindEvents=function(paramContainerId,name,value){var createParameterWidgetHelperHelper=this;jQuery(paramContainerId+" table").append("<tr><td><input class='paramName' value='"+name+"' type='text' size='14'/></td><td><input class='paramValue' type='text' value='"+value+"' size='14'/></td></tr>");var height=jQuery(paramContainerId).height();var innerHeight=jQuery(paramContainerId+" table").height();if(innerHeight>height){jQuery(paramContainerId).css({"padding-right":14});}
jQuery("#parameterWidgetInnerContainer_"+this.containerId+" input").bind("blur",function(e){jQuery(this).css({"background-color":"#FFFFFF","cursor":"default"});jQuery(this).parent("td").css({"background-color":"#FFFFFF"});});jQuery(paramContainerId+" input").bind("focus",function(e){jQuery(paramContainerId+" table tr").each(function(){jQuery(this).removeClass("selectedRow");});jQuery(this).parent("td").parent("tr").addClass("selectedRow");jQuery(this).parent("td").parent("tr").focus();});};this.scrollToViewPort=function(element){var viewPortY=jQuery(document).scrollTop()||jQuery(window).scrollTop();var viewPortX=jQuery(document).scrollLeft()||jQuery(window).scrollLeft();var windowHeight=jQuery(window).height();var windowWidth=jQuery(window).width();var elementTop=jQuery(element).offset().top;var elementLeft=jQuery(element).offset().left;var elementHeight=jQuery(element).outerHeight();var elementWidth=jQuery(element).outerWidth();if(viewPortY>elementTop){scrollY=elementTop-5;}else if(viewPortY<elementTop&&!((elementTop+elementHeight)>(viewPortY+windowHeight))){scrollY=0}else{scrollY=elementTop+Math.min(elementHeight-windowHeight,0)+5;}
if(viewPortX>elementLeft){scrollX=elementLeft;}else if(viewPortX<elementLeft&&!((elementLeft+elementWidth)>(viewPortX+windowWidth))){scrollX=0;}else{scrollX=elementLeft+Math.min(elementWidth-windowWidth,0);}
if(scrollY!==0){jQuery("html,body").scrollTop(scrollY);}
if(scrollX!==0){jQuery("html,body").scrollLeft(scrollX);}};this.getUserPreferences=function(entry){json=this.jsWrapperObj.getUserPreferences();setting=null;try{json=jQuery.evalJSON(json);jQuery.each(json,function(key,value){if(entry==key){setting=value;return false;}});}catch(err){}
return setting;};this.getInitialUserPreferences=function(entry){userPreferences=this.initialUserPreferences;setting=null;try{userPreferences=jQuery.evalJSON(userPreferences);jQuery.each(userPreferences,function(key,value){if(entry==key){setting=value;return false;}});}catch(err){}
return setting;};this.setUserPreferences=function(setting){this.jsWrapperObj.setUserPreferences(jQuery.toJSON(setting));};this.clearUserPreferences=function(){this.jsWrapperObj.clearUserPreferences();};this.getLocation=function(){var locationString=window.location.href;locationString=locationString.substr(0,locationString.lastIndexOf("/")+1);return locationString;}
this.htmlspecialchars=function(str,typ){if(typeof str==="undefined"){str="";}
if(typeof typ!=="number"){typ=2;}
typ=Math.max(0,Math.min(3,parseInt(typ)));var from=[/&/g,/</g,/>/g];var to=["&amp;","&lt;","&gt;"];if(typ==1||typ==3){from.push(/'/g);to.push("&#039;");}
if(typ==2||typ==3){from.push(/"/g);to.push("&quot;");}
for(var i in from){str=str.replace(from[i],to[i]);}
return str;}
this.createToolbarObjectFromDOM=function(){stateObject=this.getUserPreferences("toolbarstate");if(stateObject===null){stateObject={};}
if(stateObject[this.getLocation()]!==undefined&&stateObject[this.getLocation()]!==null&&stateObject[this.getLocation()]!==""){}else{stateObject[this.getLocation()]={};}
if(stateObject[this.getLocation()][this.containerId]!==undefined&&stateObject[this.getLocation()][this.containerId]!==null&&stateObject[this.getLocation()][this.containerId]!==""){}else{stateObject[this.getLocation()][this.containerId]={};}
var uiObject={};var createFromDOMHelper=this;var tabs=jQuery("#"+this.containerId+"_ribbon_tab_container li");jQuery.each(tabs,function(i,value){tabId=value.id;str="/"+createFromDOMHelper.containerId+"_tab_li_/g";tabId=tabId.replace(eval(str),"");uiObject[tabId]={};panes=jQuery("#"+createFromDOMHelper.containerId+"_ribbonPanelHolder_"+tabId).children();jQuery.each(panes,function(i,value){var paneSize="";if(jQuery(value).hasClass("ribbonPanelsmallPanel")){paneSize="smallPanel";}
if(jQuery(value).hasClass("ribbonPanelmediumPanel")){paneSize="mediumPanel";}
if(jQuery(value).hasClass("ribbonPanellargePanel")){paneSize="largePanel";}
if(jQuery(value).hasClass("ribbonPaneldropdownPanel")){paneSize="dropdownPanel";}
var paneName=jQuery(value).children("table").attr("id");var expr="/"+tabId+"_ribbonPanel_inner_div_/g";var expr2="/_"+createFromDOMHelper.containerId+"/g";paneName=paneName.replace(eval(expr),"");paneName=paneName.replace(eval(expr2),"");if(paneSize==="dropdownPanel"){uiObject[tabId][paneName]=createFromDOMHelper.uiconfig['toolbar']['ribbons']['elements'][tabId][paneName];}else{uiObject[tabId][paneName]={};uiObject[tabId][paneName]["options"]={};uiObject[tabId][paneName]["options"]["size"]=paneSize;uiObject[tabId][paneName]["actions"]=[];var actions=jQuery("#"+tabId+"_ribbonPanel_inner_div_"+paneName+"_"+createFromDOMHelper.containerId+" button");jQuery.each(actions,function(i,value){uiObject[tabId][paneName]["actions"].push(value.name);});}});});stateObject[this.getLocation()][this.containerId]=escape(jQuery.toJSON(uiObject));this.setUserPreferences({"toolbarstate":stateObject});};this.getUserDefinedToolbar=function(){var uistate=this.getInitialUserPreferences("toolbarstate");if(uistate!==null){if(uistate[this.getLocation()]!==undefined&&uistate[this.getLocation()]!==null&&uistate[this.getLocation()]!==""){if(uistate[this.getLocation()][this.containerId]!==undefined&&uistate[this.getLocation()][this.containerId]!==null&&uistate[this.getLocation()][this.containerId]!==""){return unescape(uistate[this.getLocation()][this.containerId]);}}}
return"";};};eongApplication.Logger=function(Helper){var LOG_LEVEL_SEVERE=0;var LOG_LEVEL_WARNING=1;var LOG_LEVEL_INFO=2;var LOG_LEVEL_CONFIG=3;var LOG_LEVEL_FINE=4;var LOG_LEVEL_FINER=5;var LOG_LEVEL_FINEST=6;var LOG_LEVEL_ALL=7;this.logLevel=LOG_LEVEL_CONFIG;this.Helper=Helper;if(window.console&&console.firebug){window.konsole=window.console;konsole.info("konsole detected Firebug.");}else{window.konsole=function(){var messages=[];if(window.console){messages.push("<i>Check the built-in console for other messages.</i>")}
var alertTimeout=null;function pushMsg(theMsg){messages.push(theMsg);clearTimeout(alertTimeout);alertTimeout=setTimeout('konsole.doAlert('+Helper.intrusiveJSLogging+')',800);}
return{doAlert:function(intrusive){alertTimeout=null;if(intrusive){var comboMsg="";try{var logDiv=document.createElement("div");logDiv.style.border="2px dotted red";logDiv.style.padding="4px";logDiv.style.backgroundColor="#e0e0e0";logDiv.innerHTML="<tt>"+messages.join("<br /><br />")+"</tt>";document.body.appendChild(logDiv);}catch(e){alert(messages.join("\n"));}
window.status+=messages.length+" messages written ";messages=[];}},log:function(msg){if(window.console&&window.console.log){window.console.log(msg);}else{pushMsg("(log)... "+msg);}},debug:function(msg){if(window.console&&window.console.debug){window.console.debug(msg);}else if(window.console){window.console.log(msg);}else{pushMsg("(dbg)... "+msg);}},info:function(msg){if(window.console&&window.console.info){window.console.info(msg);}else{pushMsg("(info).. "+msg);}},warn:function(msg){if(window.console&&window.console.warn){window.console.warn(msg);}else{pushMsg("<b>[warn! ] </b>"+msg);}},error:function(msg){if(window.console&&window.console.error){window.console.error(msg);}else{pushMsg("<b style='color:red'>ERROR: "+msg+"</b>");}},group:function(msg){msg=msg||"";if(window.console&&window.console.group){window.console.group(msg);}else{pushMsg("<p style='border-left:1px solid black'>"+msg);}},groupEnd:function(){if(window.console&&window.console.groupEnd){window.console.groupEnd();}else{pushMsg("</p>");}},dir:function(obj){if(window.console&&window.console.dir){window.console.dir(obj);}else{try{pushMsg(YAHOO.lang.JSON.stringify(obj,null,20));}catch(yahooErr){try{pushMsg(JSON.stringify(obj));}catch(jsonErr){pushMsg("<i>JSON stringify failed or is disabled.</i><br />--"+yahooErr.message+"<br />--"+jsonErr.message);}}}},time:function(name){name=name||"anonymous";if(window.console&&window.console.time){window.console.time();}else{pushMsg(name+" timer started @ "+new Date().getTime());}},timeEnd:function(name){name=name||"anonymous";if(window.console&&window.console.timeEnd){window.console.timeEnd();}else{pushMsg(name+" timer stopped @ "+new Date().getTime());}}}}();konsole.info("Created konsole");}
this.log=function(msg,level,reference){switch(level.toUpperCase()){case"SEVERE":levelNo=0;break;case"WARNING":levelNo=1;break;case"INFO":levelNo=2;break;case"CONFIG":levelNo=3;break;case"FINE":levelNo=4;break;case"FINER":levelNo=5;break;case"FINEST":levelNo=6;break;case"ALL":levelNo=7;break;}
try{if(levelNo<=this.logLevel){switch(level.toUpperCase()){case"SEVERE":konsole.error("["+this.Helper.jsObjName+"]["+level.toUpperCase()+"] "+msg);break;case"WARNING":konsole.warn("["+this.Helper.jsObjName+"]["+level.toUpperCase()+"] "+msg);break;case"INFO":konsole.info("["+this.Helper.jsObjName+"]["+level.toUpperCase()+"] "+msg);break;case"CONFIG":konsole.info("["+this.Helper.jsObjName+"]["+level.toUpperCase()+"] "+msg);break;case"FINE":konsole.info("["+this.Helper.jsObjName+"]["+level.toUpperCase()+"] "+msg);break;case"FINER":konsole.info("["+this.Helper.jsObjName+"]["+level.toUpperCase()+"] "+msg);break;case"FINEST":konsole.info("["+this.Helper.jsObjName+"]["+level.toUpperCase()+"] "+msg);break;case"ALL":konsole.info("["+this.Helper.jsObjName+"]["+level.toUpperCase()+"] "+msg);break;}}}catch(err){}};this.setJSLogLevel=function(logLevel){if(logLevel.toUpperCase()=="ALL"){this.logLevel=LOG_LEVEL_ALL;}else if(logLevel.toUpperCase()=="FINEST"){this.logLevel=LOG_LEVEL_FINEST;}else if(logLevel.toUpperCase()=="FINER"){this.logLevel=LOG_LEVEL_FINER;}else if(logLevel.toUpperCase()=="FINE"){this.logLevel=LOG_LEVEL_FINE;}else if(logLevel.toUpperCase()=="CONFIG"){this.logLevel=LOG_LEVEL_CONFIG;}else if(logLevel.toUpperCase()=="INFO"){this.logLevel=LOG_LEVEL_INFO;}else if(logLevel.toUpperCase()=="WARNING"){this.logLevel=LOG_LEVEL_WARNING;}else if(logLevel.toUpperCase()=="SEVERE"){this.logLevel=LOG_LEVEL_SEVERE;}else{this.logLevel=LOG_LEVEL_CONFIG;}};};eongApplication.Toolbar=function(toolbarHelper,toolbarLogger){this.uiconfig=toolbarHelper.uiconfig;this.config=toolbarHelper.config;var toolbar=this;this.createToolBar=function(toolbarwidth,editorcontainerid,fake){this.appendContainers(toolbarwidth,editorcontainerid);this.appendTabHTML(editorcontainerid)
this.appendQuickIcons(editorcontainerid);if((toolbarHelper.config.resizable!==undefined&&toolbarHelper.config.resizable=="true")||(toolbarHelper.config.draggable!==undefined&&toolbarHelper.config.draggable=="true")){this.appendIconContainer(editorcontainerid);}
if(toolbarHelper.config.draggable!==undefined&&toolbarHelper.config.draggable=="true"){this.appendDragHandle(editorcontainerid);}
if(toolbarHelper.config.resizable!==undefined&&toolbarHelper.config.resizable=="true"){this.appendFullScreenButton(editorcontainerid);}
this.appenTabContentContainer(editorcontainerid);this.createTabs(editorcontainerid,fake);jQuery("#"+editorcontainerid+"_toolbar_container").removeClass("ui-corner-all");jQuery.each(this.uiconfig.toolbar.ribbons.elements,function(i,val){var paneLocaleName="";if(val!==undefined&&val!==null){jQuery.each(val,function(j,valj){var actionCount=0;var row=0;var counter=0;if(toolbarHelper.LocaleObject[j]!==undefined){paneLocaleName=toolbarHelper.LocaleObject[j];}else{paneLocaleName=j;}
if(valj.options!==undefined&&valj.options!==null){var buttonSetSize=valj.options.size;if(buttonSetSize==="dropdownPanel"){actionCount=toolbar.getActionCount(valj);iconsPerRow=toolbar.getIconsPerRow(buttonSetSize,actionCount);toolbar.appendRowContainer(editorcontainerid,i,j,buttonSetSize);toolbar.appendNewRow(editorcontainerid,row,i,j,buttonSetSize);jQuery.each(valj.comboactions,function(comboactionIndex,comboactionValue){if(iconsPerRow===-1||(counter%iconsPerRow)!==0||counter===0){}else{row++;toolbar.appendNewRow(editorcontainerid,row,i,j,buttonSetSize);}
counter++;var dropDownContent=[];var actionProperties="";var cType="json";if(comboactionValue.dropdownactions==="systemFonts"){dropDownContent="#fontDropDownList_"+toolbarHelper.containerId;cType="selector";}else{jQuery.each(comboactionValue.dropdownactions,function(dropdownIndex,dropdownValue){var itemValues=[];actionProperties=toolbar.getActionProperties(dropdownIndex);itemValues.push(dropdownIndex);if(actionProperties!==null){itemValues.push(actionProperties.actionTitle);}else{itemValues.push(dropdownValue);}
dropDownContent.push(itemValues);});}
var cWidth=100;var dWidth=100
if(comboactionValue.options.dropdownWidth!==undefined){dWidth=comboactionValue.options.dropdownWidth;}
if(comboactionValue.options.comboWidth!==undefined){cWidth=comboactionValue.options.comboWidth;}
var comboProperties=toolbar.getActionProperties(comboactionIndex);var comboactionTitle=comboProperties.actionTitle;jQuery("#"+editorcontainerid+"_"+i+"_ribbonPanel_"+j+"_row"+row).append("<td class=\"eongbutton\"><div class=\"enabled toolbarDropdown\" id=\"toolbarDropdown_"+i+"_"+toolbarHelper.containerId+"_"+comboactionIndex+"\"></div></td>");jQuery("#toolbarDropdown_"+i+"_"+toolbarHelper.containerId+"_"+comboactionIndex).menu({content:dropDownContent,contentType:cType,showSpeed:200,combobox:true,comboboxClass:"editorAction_"+editorcontainerid+" enabled",comboboxName:comboactionIndex,comboboxTitle:comboactionTitle,comboAlign:"right",directionV:"down",iconDirection:"down",comboWidth:cWidth,dropdownWidth:dWidth,onSelect:function(){var action=jQuery(this).attr("alt");var actionProperties=toolbar.getActionProperties(action);if(actionProperties!==null){toolbarHelper.jsObj.invokeAction(action);}else{var actionCommand=jQuery(this).attr("name");if(actionCommand===toolbarHelper.LocaleObject["L_DEFAULT_TEXT"]){actionCommand="[Default]";}
toolbarHelper.jsObj.invokeAction(comboactionIndex,actionCommand);}},onComboChange:function(){var actionCommand=jQuery(this).val()
if(actionCommand===toolbarHelper.LocaleObject["L_DEFAULT_TEXT"]){actionCommand="[Default]";}
toolbarHelper.jsObj.invokeAction(comboactionIndex,actionCommand);},onShowDropDown:function(){toolbarHelper.replaceEditor(true);},onCloseDropDown:function(){toolbarHelper.replaceEditor(false);}});});toolbar.appendDescription(editorcontainerid,paneLocaleName,i,j);}else{actionCount=toolbar.getActionCount(valj);iconsPerRow=toolbar.getIconsPerRow(buttonSetSize,actionCount);panelWidth=toolbar.getPanelWidth(buttonSetSize,iconsPerRow,actionCount);toolbar.appendRowContainer(editorcontainerid,i,j,buttonSetSize);toolbar.appendNewRow(editorcontainerid,row,i,j,buttonSetSize);jQuery.each(valj.actions,function(k,valk){actionProperties=toolbar.getActionProperties(valk);if(iconsPerRow===-1||(counter%iconsPerRow)!==0||counter===0){toolbar.createToolbarButton(editorcontainerid,actionProperties,row,i,j);}else{row++;toolbar.appendNewRow(editorcontainerid,row,i,j,buttonSetSize);toolbar.createToolbarButton(editorcontainerid,actionProperties,row,i,j);}
counter++;});toolbar.appendDescription(editorcontainerid,paneLocaleName,i,j);}}});}
if(toolbarHelper.config.toolbarsortablepanes!==undefined&&toolbarHelper.config.toolbarsortablepanes=="true"){toolbar.addSortable(editorcontainerid,i);}});if(toolbarHelper.isMSIE&&toolbarHelper.BrowserVersion=="6.0"){toolbarHelper.toggleButtonHover(".eongbutton div:not(.zoomSliderDecreaseButton div, .zoomSliderIncreaseButton div, .toolbarDropdown)","hover");}
toolbarHelper.toggleButtonHover(".eongbutton div:not(.zoomSliderDecreaseButton div, .zoomSliderIncreaseButton div, .toolbarDropdown), #dragHandler_"+editorcontainerid+", #toggleFullscreenMode_"+editorcontainerid,"ui-state-hover");};this.getPanelWidth=function(buttonSetSize,iconsPerRow,actionCount){var panelButtonWidth="";if(buttonSetSize=="mediumPanel"){panelButtonWidth=32;if(iconsPerRow!=-1){if(iconsPerRow==1){panelWidth=(iconsPerRow*panelButtonWidth);}else{panelWidth=(iconsPerRow*panelButtonWidth);}}else{if(actionCount==1){panelWidth=(actionCount*panelButtonWidth);}else{panelWidth=(actionCount*panelButtonWidth);}}}else if(buttonSetSize=="largePanel"){panelButtonWidth=64;if(iconsPerRow!=-1){if(iconsPerRow==1){panelWidth=(iconsPerRow*panelButtonWidth);}else{panelWidth=(iconsPerRow*panelButtonWidth);}}else{if(actionCount==1){panelWidth=(actionCount*panelButtonWidth);}else{panelWidth=(actionCount*panelButtonWidth);}}}else{panelButtonWidth=24;if(iconsPerRow!=-1){if(iconsPerRow==1){panelWidth=(iconsPerRow*panelButtonWidth);}else{panelWidth=(iconsPerRow*panelButtonWidth);}}else{if(actionCount==1){panelWidth=(actionCount*panelButtonWidth);}else{panelWidth=(actionCount*panelButtonWidth);}}}};this.appendContainers=function(toolbarwidth,editorcontainerid){jQuery("#"+editorcontainerid+"_toolbar").append("<div style=\"width:"+toolbarwidth+";\" id=\""+editorcontainerid+"_toolbar_container\" class=\"ui-corner-top\"></div>");jQuery("#"+editorcontainerid+"_toolbar_container").append("<ul id=\""+editorcontainerid+"_ribbon_tab_container\"></ul>");};this.appendTabHTML=function(editorcontainerid){var tabLocaleName="";tabCounter=0;jQuery.each(this.uiconfig.toolbar.ribbons.elements,function(i,val){if(toolbarHelper.LocaleObject[i]!==undefined){tabLocaleName=toolbarHelper.LocaleObject[i];}else{tabLocaleName=i;}
jQuery("#"+editorcontainerid+"_ribbon_tab_container").append("<li id=\""+editorcontainerid+"_tab_li_"+i+"\"><a href=\"#"+editorcontainerid+"_tab_panel_"+i+"\">"+tabLocaleName+"</a></li>");tabCounter++;});};this.appendIconContainer=function(editorcontainerid){jQuery("#"+editorcontainerid+"_toolbar_container").append("<div id=\"iconContainer_"+editorcontainerid+"\" style=\"float: right; position: relative; margin-top: -21px; margin-right: 3px;\"></div>");}
this.appendFullScreenButton=function(editorcontainerid){jQuery("#iconContainer_"+editorcontainerid).append("<div id=\"toggleFullscreenMode_"+editorcontainerid+"\" style=\"float: left;\" class=\"ui-state-default ui-corner-all\"><span unselectable=\"on\" class=\"ui-icon ui-icon-extlink\" title=\""+toolbarHelper.LocaleObject.L_MAXIMIZE+"\">&nbsp;</span></div>");jQuery("#toggleFullscreenMode_"+editorcontainerid).bind('click',function(e){toolbarHelper.toggleFullscreenMode();});};this.appendDragHandle=function(editorcontainerid){jQuery("#iconContainer_"+editorcontainerid).append("<div id=\"dragHandler_"+editorcontainerid+"\" style=\"float: left;\" class=\"ui-state-default ui-corner-all\"><span unselectable=\"on\" class=\"ui-icon ui-icon-arrow-4-diag\" title=\""+toolbarHelper.LocaleObject.L_DRAG+"\"></span></div>");};this.appendQuickIcons=function(editorcontainerid){if(this.uiconfig.toolbar.quickactions!==undefined){jQuery("#"+editorcontainerid+"_toolbar_container ul").prepend("<div id=\"quickIcons_"+editorcontainerid+"\" class=\"quickIcons ribbonPanelquickPanel\"></div>");var tableString="<table class=\"ribbonPanel\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr class=\"quickPanel\">";jQuery.each(this.uiconfig.toolbar.quickactions,function(index,value){actionProperties=toolbar.getActionProperties(value,true);tableString+="<td class=\"eongbutton\">"+"<div class=\"disabled ui-widget-header\">"+"<button class=\"buttonImage editorAction_"+editorcontainerid+" disabled\" name=\""+actionProperties.actionId+"\""+"style=\"background-image: url("+actionProperties.iconURL+");"+"title=\""+actionProperties.actionTitle+"\" type=\"button\"/>"+"</div>"+"</td>";});tableString+="</tr></table>";jQuery("#quickIcons_"+editorcontainerid).append(tableString);}};this.appenTabContentContainer=function(editorcontainerid){jQuery.each(this.uiconfig.toolbar.ribbons.elements,function(i,val){jQuery("#"+editorcontainerid+"_toolbar_container").append("<div style=\"padding-bottom: 0 !important;\" id=\""+editorcontainerid+"_tab_panel_"+i+"\"><div id=\""+editorcontainerid+"_ribbonPanelHolder_"+i+"\" class=\"dialogPanels\"></div><div style=\"clear: both\"></div></div>");});};this.createTabs=function(editorcontainerid,fake){if(this.config.saveuistate!==undefined&&this.config.saveuistate=="true"){var selectedTab=0;if(!fake){upTab=toolbarHelper.getInitialUserPreferences("selectedtab");if(upTab!==null){if(upTab[toolbarHelper.getLocation()]!==undefined&&upTab[toolbarHelper.getLocation()]!==null&&upTab[toolbarHelper.getLocation()]!==""){if(upTab[toolbarHelper.getLocation()][toolbarHelper.containerId]!==undefined&&upTab[toolbarHelper.getLocation()][toolbarHelper.containerId]!==null&&upTab[toolbarHelper.getLocation()][toolbarHelper.containerId]!==""){selectedTabId=upTab[toolbarHelper.getLocation()][toolbarHelper.containerId];tabs=jQuery("#"+toolbarHelper.containerId+"_ribbon_tab_container").children("li");jQuery.each(tabs,function(index,value){if(value.id===selectedTabId){selectedTab=index;}});}}}}
disabledArray=[];for(var i=0;i<tabCounter;i++){if(i!==selectedTab){disabledArray.push(i);}}
if(this.uiconfig.toolbar.ribbons.options!==undefined){if(this.uiconfig.toolbar.ribbons.options.sortabletabs!==undefined&&this.uiconfig.toolbar.ribbons.options.sortabletabs=="true"){jQuery("#"+editorcontainerid+"_toolbar_container").tabs({selected:selectedTab,disabled:disabledArray,select:function(event,ui){var tab_id=ui.tab.offsetParent.id;if(toolbarHelper.initialized){var tabObject=toolbarHelper.getUserPreferences("selectedtab");if(tabObject!==null){}else{tabObject={};}
if(tabObject[toolbarHelper.getLocation()]!==undefined){}else{tabObject[toolbarHelper.getLocation()]={};}
tabObject[toolbarHelper.getLocation()][toolbarHelper.containerId]=tab_id;toolbarHelper.setUserPreferences({"selectedtab":tabObject});}}}).find(".ui-tabs-nav").sortable({axis:'x',containment:'parent',items:'li',stop:function(event,ui){toolbarHelper.createToolbarObjectFromDOM();}});}else{jQuery("#"+editorcontainerid+"_toolbar_container").tabs({selected:selectedTab,select:function(event,ui){var tab_id=ui.tab.offsetParent.id;if(toolbarHelper.initialized){var tabObject=toolbarHelper.getUserPreferences("selectedtab");if(tabObject!==null){}else{tabObject={};}
if(tabObject[toolbarHelper.getLocation()]!==undefined){}else{tabObject[toolbarHelper.getLocation()]={};}
tabObject[toolbarHelper.getLocation()][toolbarHelper.containerId]=tab_id;toolbarHelper.setUserPreferences({"selectedtab":tabObject});}}});}}else{jQuery("#"+editorcontainerid+"_toolbar_container").tabs({selected:selectedTab,select:function(event,ui){var tab_id=ui.tab.offsetParent.id;if(toolbarHelper.initialized){var tabObject=toolbarHelper.getUserPreferences("selectedtab");if(tabObject!==null){}else{tabObject={};}
if(tabObject[toolbarHelper.getLocation()]!==undefined){}else{tabObject[toolbarHelper.getLocation()]={};}
tabObject[toolbarHelper.getLocation()][toolbarHelper.containerId]=tab_id;toolbarHelper.setUserPreferences({"selectedtab":tabObject});}}});}}else{disabledArray=[];for(var i=0;i<tabCounter;i++){if(i!==1){disabledArray.push(i);}}
if(this.uiconfig.toolbar.ribbons.options.sortabletabs!==undefined&&this.uiconfig.toolbar.ribbons.options.sortabletabs=="true"){jQuery("#"+editorcontainerid+"_toolbar_container").tabs({selected:1,disabled:disabledArray}).find(".ui-tabs-nav").sortable({axis:'x',items:'li',containment:'parent',stop:function(event,ui){toolbarHelper.createToolbarObjectFromDOM();}});}else{jQuery("#"+editorcontainerid+"_toolbar_container").tabs({selected:1,disabled:disabledArray});}}};this.appendDescription=function(editorcontainerid,paneLocaleName,i,j){jQuery("#"+i+"_ribbonPanel_inner_div_"+j+"_"+editorcontainerid).parent().append("<p class=\"ribbonPanelDescription ui-widget-header\">"+paneLocaleName+"</p>");};this.getActionProperties=function(valk,quickaction){var properties={};if(toolbarHelper.ActionMap[valk]!==undefined){if(quickaction===undefined){quickaction=false;}
var actionTitle="";try{if(toolbarHelper.LocaleObject[toolbarHelper.ActionMap[valk].title]===null||toolbarHelper.LocaleObject[toolbarHelper.ActionMap[valk].title]===undefined){actionTitle=toolbarHelper.htmlspecialchars(toolbarHelper.ActionMap[valk].title);}
else{actionTitle=toolbarHelper.htmlspecialchars(toolbarHelper.LocaleObject[toolbarHelper.ActionMap[valk].title]);}}
catch(err1){actionTitle="Not available";}
var actionId="";try{actionId=valk;}
catch(err3){actionId="actionContextMissing";}
if(quickaction){try{var iconURL=toolbarHelper.ActionMap[valk].smallIconURL;}
catch(err4){}}
else{try{var iconURL=toolbarHelper.ActionMap[valk].iconURL;}
catch(err4){}}
if(iconURL===undefined){if(toolbarHelper.iconRepositoryURL===""||toolbarHelper.iconRepositoryURL===null){iconRepositoryURL=toolbarHelper.codebase+"/../icons";}
else{iconRepositoryURL=toolbarHelper.iconRepositoryURL;}
if(quickaction){iconURL=iconRepositoryURL+"/"+valk.toLowerCase()+"-small.png";}
else{iconURL=iconRepositoryURL+"/"+valk.toLowerCase()+".png";}}
else{iconURL=toolbarHelper.resolveURL(iconURL);}
var actionStatus="disabled";properties.actionId=actionId;properties.iconURL=iconURL;properties.actionTitle=actionTitle;properties.actionStatus=actionStatus;return properties;}else{properties.actionId="undefined";properties.iconURL="none";properties.actionTitle="Action not available";properties.actionStatus="disabled";return properties;}};this.createToolbarButton=function(editorcontainerid,actionProperties,row,i,j){tmpContent="<td class=\"eongbutton\">";tmpContent+="<div class=\""+actionProperties.actionStatus+" ui-widget-header\">";tmpContent+="<button type=\"button\" name=\""+actionProperties.actionId+"\" title=\""+actionProperties.actionTitle+"\" style=\"background-image: url("+actionProperties.iconURL+");\" class=\"buttonImage editorAction_"+editorcontainerid+" "+actionProperties.actionStatus+"\" />";tmpContent+="</div>";tmpContent+="</td>";jQuery("#"+editorcontainerid+"_"+i+"_ribbonPanel_"+j+"_row"+row).append(tmpContent);};this.appendNewRow=function(editorcontainerid,row,i,j,buttonSetSize){jQuery("#"+i+"_ribbonPanel_inner_div_"+j+"_"+editorcontainerid).append("<tr id=\""+editorcontainerid+"_"+i+"_ribbonPanel_"+j+"_row"+row+"\" class=\""+buttonSetSize+"\"></tr>");};this.addSortable=function(editorcontainerid,i){jQuery("#"+editorcontainerid+"_ribbonPanelHolder_"+i).sortable({items:".sortablePanel",containment:"#"+editorcontainerid+"_tab_panel_"+i,axis:"x",handle:"p",stop:function(event,ui){toolbarHelper.createToolbarObjectFromDOM();}});};this.appendRowContainer=function(editorcontainerid,i,j,buttonSetSize){var tmpContent="<div class=\"ui-widget-content sortablePanel ribbonPanel ribbonPanel"+buttonSetSize+"\">";tmpContent+="<table width=\"100%\" id=\""+i+"_ribbonPanel_inner_div_"+j+"_"+editorcontainerid+"\" class=\"ribbonPanel\">";tmpContent+="</table>";tmpContent+="</div>";jQuery("#"+editorcontainerid+"_ribbonPanelHolder_"+i).append(tmpContent);};this.getIconsPerRow=function(buttonSetSize,actionCount){if(buttonSetSize=="smallPanel"||buttonSetSize=="mediumPanel"||buttonSetSize=="dropdownPanel"){iconsPerRow=Math.ceil(actionCount/2);}else{iconsPerRow=actionCount;}
return iconsPerRow;};this.getActionCount=function(valj){var actionCount=0;if(valj.actions!==undefined){jQuery.each(valj.actions,function(c,cval){actionCount++;});}else{jQuery.each(valj.comboactions,function(c,cval){actionCount++;});}
return actionCount;};};